webpackJsonp([0],[function(t,e,n){"use strict";function r(t,e){var n=t.size;if(n!==e.size)return!1;for(var r=t.values(),o=r.next();!o.done;o=r.next())if(!e.has(o.value))return!1;return!0}function o(t,e){var n=new Set;return t.forEach(function(t){e.has(t)&&n.add(t)}),n}function i(t,e){var n=t.indexOf(e);n<0||(t[n]=t[t.length-1],t.pop())}function a(t){var e=t.toString();console.log(e);for(var n=e.length%3,r=n>0?[e.slice(0,n)]:[],o=e.length%3;o<e.length;o+=3)r.push(e.substr(o,3));return console.log(r),r.join("'")}function s(t,e){return T.point(+t.x.toFixed(e),+t.y.toFixed(e))}function u(t,e){return void 0===e&&(e=10),t.toString(e).split(".")[1]||"0"}function c(t){var e=Math.random().toString(36).slice(2);return t&&t(e)?c(t):e}function l(t,e){var n=t.getContainer().getBoundingClientRect(),r=T.point(e.clientX-n.left,e.clientY-n.top);return t.containerPointToLatLng(r)}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t?t.apply(void 0,e):void 0}function p(t,e,n){t.addEventListener(e,function r(o){t.removeEventListener(e,r),n(o)})}function d(t){function e(){removeEventListener("keydown",n),removeEventListener("backbutton",r)}var n=function(n){27===n.keyCode&&(e(),t(n))},r=function(n){e(),t(n)};addEventListener("keydown",n),addEventListener("backbutton",r)}function h(){for(var t=document.querySelectorAll(G),e=0;e<t.length;++e){var n=t[e];n.style.opacity=null,"t"!==n.id[1]&&(n.style.filter=null)}}function m(t,e){var n=document.createEvent("MouseEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}function v(t){var e=t.name,n=t.altNames,r=M(),o=[e];return r&&n[r]&&o.push(n[r]),n.en&&o.push(n.en),o}function g(t){var e=t.map(v);return[0,1,2].map(function(n){return t.map(function(t,r){return e[r][n]})}).map(C.uniq).map(function(t){return t.reduce(function(t,e){return t+" / "+e})}).filter(function(t){return void 0!==t})}function y(t,e){var n=e.map(function(e){return t.distanceTo(e)}),r=e[1].subtract(e[0]).multiplyBy(n[0]/(n[0]+n[1])).add(e[0]),o=t.subtract(r);return e.map(function(t){return s(t.add(o),2)})}function b(t){var e=t.style,n=e.transform;n&&(e.transform=n.replace(/translate3d\s*\((.+?,\s*.+?),\s*.+?\s*\)/i,"translate($1)"))}function _(t,e){var n=0;setInterval(function(){return document.title=t[++n%t.length]},e)}function w(t,e,n){var r=t.getBoundingClientRect();if(!n){var o=document.documentElement;n=T.point(o.clientWidth/2,o.clientHeight/2)}var i=T.point(n.x-r.left,n.y-r.top),a=T.point(i.x/r.width,i.y/r.height),s=t.style;s.transformOrigin=100*a.x+"% "+100*a.y+"%",s.transform="scale("+e+")"}function x(t,e,n,r){return void 0===n&&(n=100),void 0===r&&(r=100),new Promise(function(o,i){return setTimeout(function a(){console.log(r),--r<=0&&(console.error("rejected",a),i());var s=t();return e(s)?o(s):void setTimeout(a,n)})})}function k(t,e,n){void 0===e&&(e=100),void 0===n&&(n=100);var r=t.slice(1),o="#"===t[0]?function(){return document.getElementById(r)}:function(){return document.querySelector(t)};return x(o,function(t){return null!==t},e,n)}function S(t){for(var e;e=t.firstChild;)t.removeChild(e)}function L(t){void 0===t&&(t=document);var e=t.querySelectorAll('[style*="translate3d"]');console.log("fixing font",t,e);for(var n=0;n<e.length;++n)b(e[n])}function M(){var t=window.location.search.match(/city=(\w+)/),e=t?t[1]:"spb";return"spb"===e?"fi":"helsinki"===e?"se":void 0}function E(t,e){var n=t.get(e);if(void 0===n)throw console.error("in map",t,":",e,"->",n),new Error("key or val is undefined");return n}function O(t){var e=document.getElementById(t);if(!e)throw new Error("no element with id="+t+" exists");return e}var T=n(1),C=n(9),A=n(49);e.algorithm=A;var P=n(51);e.decorators=P;var j=n(13);e.geo=j;var B=n(14);e.math=B;var N=n(48);e.Mediator=N.default;var I=n(23);e.polyfills=I;var R=n(53);e.sfx=R;var F=n(15);e.svg=F;var z=n(52);e.file=z;var D=n(50);e.color=D;var G=["paths-inner","paths-outer","transfers-inner","transfers-outer","station-circles"].map(function(t){return"#"+t+" > *"}).join(", ");e.setsEqual=r,e.intersection=o,e.deleteFromArray=i,e.formatInteger=a,e.roundPoint=s,e.getFraction=u,e.generateId=c,e.mouseToLatLng=l,e.callMeMaybe=f,e.once=p,e.onceEscapePress=d,e.resetStyle=h,e.triggerMouseEvent=m,e.getPlatformNames=v,e.getPlatformNamesZipped=g,e.midPointsToEnds=y,e.trim3d=b,e.flashTitle=_,e.scaleOverlay=w,e.tryGet=x,e.tryGetElement=k,e.removeAllChildren=S,e.fixFontRendering=L,e.getSecondLanguage=M,e.tryGetFromMap=E,e.byId=O},,function(t,e,n){"use strict";t.exports=function(t){if(null==t)throw new TypeError("Cannot use null or undefined");return t}},function(t,e,n){"use strict";var r,o=n(18),i=n(79),a=n(73),s=n(19);r=t.exports=function(t,e){var n,r,a,u,c;return arguments.length<2||"string"!=typeof t?(u=e,e=t,t=null):u=arguments[2],null==t?(n=a=!0,r=!1):(n=s.call(t,"c"),r=s.call(t,"e"),a=s.call(t,"w")),c={value:e,configurable:n,enumerable:r,writable:a},u?o(i(u),c):c},r.gs=function(t,e,n){var r,u,c,l;return"string"!=typeof t?(c=n,n=e,e=t,t=null):c=arguments[3],null==e?e=void 0:a(e)?null==n?n=void 0:a(n)||(c=n,n=void 0):(c=e,e=n=void 0),null==t?(r=!0,u=!1):(r=s.call(t,"c"),u=s.call(t,"e")),l={get:e,set:n,configurable:r,enumerable:u},c?o(i(c),l):l}},function(t,e,n){"use strict";t.exports=function(t){if("function"!=typeof t)throw new TypeError(t+" is not a function");return t}},function(t,e,n){"use strict";function r(t){return u(this,void 0,void 0,function(){var n,r,o,i,a,s;return c(this,function(u){switch(u.label){case 0:return[4,l.getJSON(t)];case 1:for(n=u.sent(),r=Object.keys(n),o=0,i=r;o<i.length;o++)a=i[o],s=n[a],f.set(a.toLowerCase(),e.userLanguage in s?s[e.userLanguage]:a);return p=new RegExp(r.join("|"),"ig"),[2]}})})}function o(t){var e=f.get(t.toLowerCase());return void 0===e?t:t.toUpperCase()===t?e.toUpperCase():e}function i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.map(function(t){return t.replace(p,o)}).map(function(t,n){return t+(e[n]||"")}).join("")}function a(t,n){return 0===t?"":""+t+(t>1&&"en"===e.userLanguage?n+"s":n)}function s(t){if(void 0===t)return"";if(t<60)return Math.round(t)+" seconds";if(t<3570){var e=Math.round(t/60);return a(e,"min")}var n=Math.floor(t/3600),r=Math.floor((t-3600*n)/60);return(n>0?n+(o=["%hour%"],o.raw=["%hour%"],i(o)):"")+" "+a(r,"min");var o}var u=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e)).next())})},c=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},l=n(8);e.userLanguage=navigator.language.slice(0,2).toLowerCase();var f=new Map,p=new RegExp(Object.keys(f).join("|"),"ig");e.updateDictionary=r,e.translate=o,e.tr=i,e.formatTime=s},function(t,e,n){"use strict";t.exports=n(93)()?Symbol:n(95)},,function(t,e,n){"use strict";function r(){for(var t=document.styleSheets,e="",n=0,r=t.length;n<r;++n){var o=t[n];console.log(o.cssText);var i=o.cssRules;if(i)for(var a=0;a<i.length;++a)e+=i[a].cssText;else console.log(o)}return console.log("css text ready"),e}function o(){return i(this,void 0,void 0,function(){var t,e,n,r,o,i,u;return a(this,function(a){switch(a.label){case 0:return t=document.getElementById("scheme"),[4,s.tryGet(function(){return t.sheet},function(t){return null!==t})];case 1:for(e=a.sent(),n=new Map,r=0,o=e.cssRules;r<o.length;r++)i=o[r],i instanceof CSSStyleRule&&(u=i.selectorText.match(/^.(M\d+|L|E)$/),u&&u[1]?n.set(u[1],i.style):"#paths-outer > .L"===i.selectorText&&n.set("light-rail-path",i.style));return console.log(n),[2,n]}})})}var i=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e)).next())})},a=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},s=n(0);e.getJSON=function(t){return fetch(t).then(function(t){return t.json()})},e.getContent=function(t){return fetch(t).then(function(t){return t.text()})},e.getConfig=function(){return fetch("res/mapconfig.json").then(function(t){return t.json()})},e.getStyleRulesAsText=r,e.getLineRules=o},,function(t,e,n){"use strict";t.exports=n(28)()?Object.setPrototypeOf:n(29)},function(t,e,n){"use strict";var r=function(){function t(t,e){if(t===e)throw new Error("source is the same as target: "+t);this._source=t,this._target=e}return Object.defineProperty(t.prototype,"source",{get:function(){return this._source},set:function(t){this._source=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),t.prototype.isOf=function(t,e){return this._source===t&&this._target===e||this._source===e&&this._target===t},t.prototype.has=function(t){return this._source===t||this._target===t},t.prototype.other=function(t){if(this._source===t)return this._target;if(this._target===t)return this._source;throw new Error("span does not have vertex")},t.prototype.isAdjacent=function(t){return this.has(t._source)||this.has(t._target)},t.prototype.invert=function(){t=[this._target,this._source],this._source=t[0],this._target=t[1];var t},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function r(t){var e=t.name,n=t.altNames,r=n.fi,o=n.en,i=o?[e,r,o]:r?[e,r]:[e],a=i.join("|"),s=window.location.search.match(/city=(\w+)/),u=s?s[1]:"spb",l="spb"===u?"fi":"helsinki"===u?"se":"defaultForeign";c.prompt((p=["New name"],p.raw=["New name"],f.tr(p)),a,function(n,r){var o=r.split("|");if(t.name=o[0],t.altNames[l]=o[1],t.altNames.en=o[2],r===a)return c.warning((d=["Name was not changed"],d.raw=["Name was not changed"],f.tr(d)));var s=i.slice(1).join(", "),u=o.slice(1).join(", ");c.success((h=[""," (",") renamed to "," (",")"],h.raw=[""," (",") renamed to "," (",")"],f.tr(h,e,s,o[0],u)));var p=t.station;if(!(p.platforms.length<2)){c.confirm((m=["Rename the entire station?"],m.raw=["Rename the entire station?"],f.tr(m)),function(){for(var t=0,e=p.platforms;t<e.length;t++){var n=e[t];n.name=o[0],n.altNames.fi=o[1],n.altNames.en=o[2]}c.success((i=["The entire station was renamed to ",""],i.raw=["The entire station was renamed to ",""],f.tr(i,r)));var i});var d,h,m}},function(){return c.warning((t=["Name change cancelled"],t.raw=["Name change cancelled"],f.tr(t)));var t});var p}function o(t,e){for(var n=void 0===e?void 0:Array.from(e).map(function(t){return t.line+t.branch}).join("|"),r=new Set,o=prompt("routes",n)||"",i=0,a=o.split("|");i<a.length;i++){var s=a[i],u="M"===s[0]?s.match(/(M\d{0,2})(\w?)/):s.match(/([EL])(.{0,2})/);if(u){var c=u[1],l=u[2],f=t.routes.find(function(t){return t.line===c&&t.branch===l});void 0===f&&(console.log("creating new route"),f={line:c,branch:l},t.routes.push(f)),r.add(f)}else console.error("incorrect route",s)}return r}function i(t,e){var n=0;console.log(e.length),addEventListener("keydown",function(r){r.shiftKey&&r.ctrlKey&&76===r.keyCode&&(r.preventDefault(),t.removeLayer(e[n]),++n===e.length&&(n=0),t.addLayer(e[n]),t.invalidateSize(!1))})}function a(t,e){var n=e.filter(function(t){return t.spans[0].routes[0].line.startsWith("M")}).map(function(t){return t.location}),r=function(t){return n.reduce(function(e,n){return e+t.distanceTo(n)},0)},o=u.polyline([],{color:"red"}),i=l.calculateGeoMean(n,r,1,function(t){return o.addLatLng(t)});t.addLayer(o);for(var a=5e3;a<2e4;a+=5e3)u.circle(i,a-250,{weight:1}).addTo(t),u.circle(i,a+250,{weight:1}).addTo(t);var s=(e.filter(function(t){return t.spans[0].routes[0].line.startsWith("E")}).map(function(t){return t.location}),e.find(function(t){return"Glavnyj voxal"===t.name&&t.spans[0].routes[0].line.startsWith("E")}));if(s){var c=s.location;u.circle(c,3e4).addTo(t),u.circle(c,45e3).addTo(t)}}function s(t,e){for(var n=0,r=e;n<r.length;n++){var o=r[n];t.addLayer(o).removeLayer(o)}}var u=n(1),c=n(7),l=n(13),f=n(5),p=n(42);e.MapEditor=p.default;var d=n(40);e.FAQ=d.default;var h=n(45);e.TextPlate=h.default;var m=n(43);e.RoutePlanner=m.default;var v=n(38);e.ContextMenu=v.default;var g=n(39);e.DistanceMeasure=g.default;var y=n(44);e.SvgOverlay=y.default;var b=n(41);e.Icons=b,e.platformRenameDialog=r,e.askRoutes=o,e.addLayerSwitcher=i,e.drawZones=a,e.cacheIcons=s},function(t,e,n){"use strict";function r(t,e){if(e.length<1)throw new Error("an objects array must contain at least 1 object");for(var n=e[0],r=t.distanceTo(n.location||n),o=1,i=e.length;o<i;++o){var a=e[o],s=t.distanceTo(a.location||a);s<r&&(n=e[o],r=s)}return n}function o(t,e,n,r){void 0===r&&(r=!1);var o=e.map(function(e){return{item:e,distance:t.distanceTo(e.location)}}).filter(function(t){return t.distance<=n});return(r?o.sort(function(t,e){return t.distance-e.distance}):o).map(function(t){return t.item})}function i(t){for(var e=0,n=0,r=0,o=t;r<o.length;r++){var i=o[r],a=i.lat,u=i.lng;e+=a,n+=u}return s.latLng(e/t.length,n/t.length)}function a(t,e,n,r){void 0===n&&(n=1e-5);var o=i(t),a=e(o);u.callMeMaybe(r,o);for(var c=10;c>n;c*=.61803398875)for(var l=c,f=-l;f<=l;f+=c)for(var p=-l;p<=l;p+=c){var d=s.latLng(o.lat+f,o.lng+p),h=e(d);h<a&&(o=d,a=h,u.callMeMaybe(r,o))}return o}var s=n(1),u=n(0);e.findClosestObject=r,e.findObjectsWithinRadius=o,e.getCenter=i,e.calculateGeoMean=a},function(t,e,n){"use strict";function r(t,e){return t.x*e.x+t.y*e.y}function o(t,e){return r(t,e)/t.distanceTo(e)}function i(t){return t.reduce(function(t,e){return t.add(e)}).divideBy(t.length)}function a(t){if(3!==t.length)throw new Error("must have 3 vertices");var e=t[0],n=t[1].subtract(e),o=t[2].subtract(e),i=r(n,n),a=r(o,o);return l.point(o.y*i-n.y*a,n.x*a-o.x*i).divideBy(2*(n.x*o.y-n.y*o.x)).add(e)}function s(t,e,n){return l.point(t.x+e*Math.cos(n),t.y+e*Math.sin(n))}function u(t){var e=Math.abs(t.x),n=Math.abs(t.y);return t.divideBy(e<n?n:e)}function c(t,e,n){var r=e*e/n;return r<t?e/n*2+(t-r)/e:2*Math.sqrt(t/n)}var l=n(1);e.dot=r,e.angle=o,e.getCenter=i,e.getCircumcenter=a,e.polarToCartesian=s,e.vectorToGradCoordinates=u,e.timeToTravel=c},function(t,e,n){"use strict";function r(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function o(t,e){var n=r("circle");return n.setAttribute("r",e.toString()),n.setAttribute("cy",t.y.toString()),n.setAttribute("cx",t.x.toString()),n}function i(t,e){var n=r("line");return n.setAttribute("x1",t.x.toString()),n.setAttribute("y1",t.y.toString()),n.setAttribute("x2",e.x.toString()),n.setAttribute("y2",e.y.toString()),n}function a(t,e,n){var o=r("path");return l(o,t,e,n),o}function s(t){var e=[],n=/\D([\d\.]+).*?,.*?([\d\.]+)/g,r=t.getAttribute("d");if(r){for(var o;null!==(o=n.exec(r));)e.push(v.point(Number(o[1]),Number(o[2])));return e}}function u(t,e){if(4!==e.length)throw new Error("there should be 4 points");var n=(r("path"),["M"].concat(e.map(function(t){return t.x+","+t.y})));n.splice(2,0,"C"),t.setAttribute("d",n.join(" "))}function c(t){var e=[],n=/\D([\d\.]+)/g,r=t.getAttribute("d");if(r){for(var o;null!==(o=n.exec(r));)e.push(Number(o[1]));return e}}function l(t,e,n,r){var o=g.getCircumcenter([e,n,r]),i=Math.atan2(e.y-o.y,e.x-o.x),a=Math.atan2(n.y-o.y,n.x-o.x),s=a-i,u=s<=Math.PI||s>-Math.PI?0:1,c=e.subtract(o),l=n.subtract(o),f=c.x*l.y-l.x*c.y<0?0:1,p=g.dot(r.subtract(e),r.subtract(n));p<0&&(f=1-f,u=1-u);var d=o.distanceTo(e),h=["M",e.x,e.y,"A",d,d,0,u,f,n.x,n.y].join(" ");t.setAttribute("d",h)}function f(t){var e=r("path");return u(e,t),e}function p(t,e){var n=o(t,e),r=n.cloneNode(!0);return[n,r]}function d(t,e,n){var r=a(t,e,n),o=r.cloneNode(!0);return[r,o]}function h(t,e){var n=e.clone();return t.x===e.x?n.x+=.01:t.y===e.y&&(n.y+=.01),[i(t,n),i(t,n)]}function m(t){var e=v.point(+t.getAttribute("cx"),+t.getAttribute("cy")),n=~~t.getAttribute("r"),r=v.point(0+n,4+n);return e.subtract(r)}var v=n(1),g=n(14);e.createSVGElement=r,e.makeCircle=o,e.makeLine=i,e.makeArc=a,e.getBezierPathPoints=s,e.setBezierPath=u,e.getCircularPath=c,e.setCircularPath=l,e.makeCubicBezier=f,e.makeTransferRing=p,e.makeTransferArc=d,e.makeTransferLine=h,e.circleOffset=m;var y;!function(t){function e(){var t=r("filter");return t.id="shadow",t.setAttribute("width","200%"),t.setAttribute("height","200%"),t.innerHTML='\n            <feOffset result="offOut" in="SourceAlpha" dx="0" dy="4" />\n            <feColorMatrix result="matrixOut" in="offOut" type="matrix" values=\n                "0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0.5 0"/>\n            <feGaussianBlur result="blurOut" in="matrixOut" stdDeviation="2" />\n\n            <feBlend in="SourceGraphic" in2="blurOut" mode="normal" />\n        ',t}function n(){var t=r("filter");return t.id="black-glow",t.innerHTML='<feColorMatrix type="matrix" values=\n                "0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0.3 0"/>\n            <feGaussianBlur stdDeviation="2.5" result="coloredBlur"/>\n            <feMerge>\n                <feMergeNode in="coloredBlur"/>\n                <feMergeNode in="SourceGraphic"/>\n            </feMerge>',t}function o(){var t=r("filter");return t.id="opacity",t.innerHTML='<feComponentTransfer>\n            <feFuncA type="table" tableValues="0 0.5">\n        </feComponentTransfer>',t}function i(){var t=r("filter");return t.id="gray",t.innerHTML='<feColorMatrix type="matrix"\n               values="0.2126 0.7152 0.0722 0 0\n                       0.2126 0.7152 0.0722 0 0\n                       0.2126 0.7152 0.0722 0 0\n                       0 0 0 1 0"/>',t}function a(t){t.appendChild(e()),t.appendChild(n()),t.appendChild(o()),t.appendChild(i())}function s(t){var e=t.getBoundingClientRect(),n=getComputedStyle(t),r=2*parseFloat(n.strokeWidth||t.style.strokeWidth||"0");e.height>=r&&e.width>=r&&(t.style.filter="url(#black-glow)")}t.makeDrop=e,t.makeGlow=n,t.makeOpacity=o,t.makeGray=i,t.appendAll=a,t.applyDrop=s}(y=e.Filters||(e.Filters={}));var b;!function(t){function e(t){var e=r("linearGradient");if("innerHTML"in e)return e.innerHTML='<stop style="stop-color:'+t[0]+'" /><stop style="stop-color:'+t[1]+'" />',e;var n=r("stop");n.style.stopColor=t[0];var o=r("stop");return o.style.stopColor=t[1],e.appendChild(n),e.appendChild(o),e}function n(t,n,r){void 0===r&&(r=0);var a=e(n);return i(a,r),o(a,t),a}function o(t,e){var n="rotate("+180*Math.atan2(e.y,e.x)/Math.PI+", 0.5, 0.5)";t.setAttribute("gradientTransform",n)}function i(t,e){t.firstChild.setAttribute("offset",e.toString()),t.lastChild.setAttribute("offset",(1-e).toString())}t.makeUndirectedLinear=e,t.makeLinear=n,t.setDirection=o,t.setOffset=i}(b=e.Gradients||(e.Gradients={}))},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(t,e,n){"use strict";var r=Object.prototype.toString,o=r.call(function(){return arguments}());t.exports=function(t){return r.call(t)===o}},function(t,e,n){"use strict";t.exports=n(68)()?Object.assign:n(69)},function(t,e,n){"use strict";t.exports=n(80)()?String.prototype.contains:n(81)},function(t,e,n){"use strict";var r=Object.prototype.toString,o=r.call("");t.exports=function(t){return"string"==typeof t||t&&"object"==typeof t&&(t instanceof String||r.call(t)===o)||!1}},function(t,e,n){"use strict";var r,o=n(27),i=n(18),a=n(4),s=n(2),u=n(3),c=n(59),l=n(6),f=Object.defineProperty,p=Object.defineProperties;t.exports=r=function(t,e){return this instanceof r?(p(this,{__list__:u("w",s(t)),__context__:u("w",e),__nextIndex__:u("w",0)}),void(e&&(a(e.on),e.on("_add",this._onAdd),e.on("_delete",this._onDelete),e.on("_clear",this._onClear)))):new r(t,e)},p(r.prototype,i({constructor:u(r),_next:u(function(){var t;if(this.__list__)return this.__redo__&&(t=this.__redo__.shift(),void 0!==t)?t:this.__nextIndex__<this.__list__.length?this.__nextIndex__++:void this._unBind()}),next:u(function(){return this._createResult(this._next())}),_createResult:u(function(t){return void 0===t?{done:!0,value:void 0}:{done:!1,value:this._resolve(t)}}),_resolve:u(function(t){return this.__list__[t]}),_unBind:u(function(){this.__list__=null,delete this.__redo__,this.__context__&&(this.__context__.off("_add",this._onAdd),this.__context__.off("_delete",this._onDelete),this.__context__.off("_clear",this._onClear),this.__context__=null)}),toString:u(function(){return"[object Iterator]"})},c({_onAdd:u(function(t){if(!(t>=this.__nextIndex__)){if(++this.__nextIndex__,!this.__redo__)return void f(this,"__redo__",u("c",[t]));this.__redo__.forEach(function(e,n){e>=t&&(this.__redo__[n]=++e)},this),this.__redo__.push(t)}}),_onDelete:u(function(t){var e;t>=this.__nextIndex__||(--this.__nextIndex__,this.__redo__&&(e=this.__redo__.indexOf(t),e!==-1&&this.__redo__.splice(e,1),this.__redo__.forEach(function(e,n){e>t&&(this.__redo__[n]=--e)},this)))}),_onClear:u(function(){this.__redo__&&o.call(this.__redo__),this.__nextIndex__=0})}))),f(r.prototype,l.iterator,u(function(){return this})),f(r.prototype,l.toStringTag,u("","Iterator"))},function(t,e){function n(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=p[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(u(r.parts[i],e))}else{for(var a=[],i=0;i<r.parts.length;i++)a.push(u(r.parts[i],e));p[r.id]={id:r.id,refs:1,parts:a}}}}function r(t){for(var e=[],n={},r=0;r<t.length;r++){var o=t[r],i=o[0],a=o[1],s=o[2],u=o[3],c={css:a,media:s,sourceMap:u};n[i]?n[i].parts.push(c):e.push(n[i]={id:i,parts:[c]})}return e}function o(t,e){var n=m(),r=y[y.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function i(t){t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function a(t){var e=document.createElement("style");return e.type="text/css",o(t,e),e}function s(t){var e=document.createElement("link");return e.rel="stylesheet",o(t,e),e}function u(t,e){var n,r,o;if(e.singleton){var u=g++;n=v||(v=a(e)),r=c.bind(null,n,u,!1),o=c.bind(null,n,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(e),r=f.bind(null,n),o=function(){i(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(e),r=l.bind(null,n),o=function(){i(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}function c(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=b(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function l(t,e){var n=e.css,r=e.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function f(t,e){var n=e.css,r=e.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=t.href;t.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var p={},d=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},h=d(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),m=d(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,g=0,y=[];t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");e=e||{},"undefined"==typeof e.singleton&&(e.singleton=h()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var o=r(t);return n(o,e),function(t){for(var i=[],a=0;a<o.length;a++){var s=o[a],u=p[s.id];u.refs--,i.push(u)}if(t){var c=r(t);n(c,e)}for(var a=0;a<i.length;a++){var u=i[a];if(0===u.refs){for(var l=0;l<u.parts.length;l++)u.parts[l]();delete p[u.id]}}}};var b=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){"Promise"in window&&"then"in Promise.prototype&&"catch"in Promise.prototype||(console.log("promises not present, using a polyfill"),n(87).polyfill()),"Set"in window&&"add"in Set.prototype&&"has"in Set.prototype||(console.log("set not present, using a polyfill"),n(88)),"classList"in HTMLElement.prototype||(console.log("classlist not present, using a polyfill"),n(55)),Array.prototype.find||(Array.prototype.find=function(t){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var e,n=Object(this),r=n.length>>>0,o=arguments[1],i=0;i<r;i++)if(e=n[i],t.call(o,e,i,n))return e}),Array.prototype.includes||(Array.prototype.includes=function(t){var e=Object(this),n=parseInt(e.length,10)||0;if(0===n)return!1;var r,o=parseInt(arguments[1],10)||0;o>=0?r=o:(r=n+o,r<0&&(r=0));for(var i;r<n;){if(i=e[r],t===i||t!==t&&i!==i)return!0;r++}return!1})}},,function(t,e,n){"use strict";var r=n(54),o={platformBindings:new WeakMap,dummyBindings:new r.WeakBiMap,outerEdgeBindings:new r.WeakBiMap,innerEdgeBindings:new r.WeakBiMap,gradientBindings:new WeakMap};Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";var r=n(1),o=n(0),i=n(33);e.Platform=i.default;var a=n(35);e.Station=a.default;var s=n(11);e.Edge=s.default;var u=n(34);e.Span=u.default;var c=n(36);e.Transfer=c.default;var l=function(){function t(t){var e=this,n=function(t){return r.latLng(t.lat,t.lng)};this.platforms=t.platforms.map(function(t){return new i.default(t.name,n(t.location),t.altNames)}),this.stations=[],this.routes=t.routes,this.lines=t.lines,this.transfers=t.transfers.map(function(t){return new c.default(e.platforms[t.source],e.platforms[t.target])});var o=function(t){return t.routes.map(function(t){return e.routes[t]})};this.spans=t.spans.map(function(t){return new u.default(e.platforms[t.source],e.platforms[t.target],o(t))}),console.time("restore");for(var s=new Set(this.transfers),l=new Set(this.platforms);s.size>0;){var f=s.values().next().value,p=(new Set).add(f.source).add(f.target);s.delete(f);for(var d=p.values(),h=d.next().value;void 0!==h;h=d.next().value){for(var m=new Set,v=s.values(),g=v.next().value;void 0!==g;g=v.next().value)g.source===h?(p.add(g.target),m.add(g)):g.target===h&&(p.add(g.source),m.add(g));m.forEach(function(t){return s.delete(t)}),l.delete(h)}var y=new a.default(Array.from(p));this.stations.push(y)}l.forEach(function(t){return e.stations.push(new a.default([t]))}),console.timeEnd("restore")}return t.prototype.toJSON=function(){var t=this;return JSON.stringify({platforms:this.platforms.map(function(t){return{name:t.name,altNames:t.altNames,location:t.location}}),transfers:this.transfers.map(function(e){return{source:t.platforms.indexOf(e.source),target:t.platforms.indexOf(e.target)}}),lines:this.lines,spans:this.spans.map(function(e){return{source:t.platforms.indexOf(e.source),target:t.platforms.indexOf(e.target),routes:e.routes.map(function(e){return t.routes.indexOf(e)})}}),routes:this.routes},function(t,e){return t.startsWith("_")?void 0:e})},t.prototype.deletePlatform=function(t){console.log("removing platform",t);for(var e=0,n=t.transfers;e<n.length;e++){var r=n[e];o.deleteFromArray(this.transfers,r)}if(t.transfers=[],1===t.spans.length){var i=t.spans[0],a=i.other(t);o.deleteFromArray(a.spans,i),o.deleteFromArray(this.spans,i)}else if(2===t.spans.length){var s=t.spans,u=s[0],c=s[1],l=c.other(t);if(!l)throw new Error("span does not have other end");if(2===t.passingRoutes().size){var f=u.other(t);o.deleteFromArray(f.spans,u),o.deleteFromArray(this.spans,u)}else u.source===t?u.source=l:u.target=l;o.deleteFromArray(l.spans,c),o.deleteFromArray(this.spans,c)}else for(var p=0,d=t.spans;p<d.length;p++){var i=d[p],a=i.other(t);o.deleteFromArray(a.spans,i),o.deleteFromArray(this.spans,i)}var h=t.station;1===h.platforms.length?o.deleteFromArray(this.stations,h):o.deleteFromArray(h.platforms,t),o.deleteFromArray(this.platforms,t)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=l},function(t,e,n){"use strict";var r=n(2);t.exports=function(){return r(this).length=0,this}},function(t,e,n){"use strict";var r=Object.create,o=Object.getPrototypeOf,i={};t.exports=function(){var t=Object.setPrototypeOf,e=arguments[0]||r;return"function"==typeof t&&o(t(e(null),i))===i}},function(t,e,n){"use strict";var r,o=n(74),i=n(2),a=Object.prototype.isPrototypeOf,s=Object.defineProperty,u={configurable:!0,enumerable:!1,writable:!0,value:void 0};r=function(t,e){if(i(t),null===e||o(e))return t;throw new TypeError("Prototype must be null or an object")},t.exports=function(t){var e,n;return t?(2===t.level?t.set?(n=t.set,e=function(t,e){return n.call(r(t,e),e),t}):e=function(t,e){return r(t,e).__proto__=e,t}:e=function t(e,n){var o;return r(e,n),o=a.call(t.nullPolyfill,e),o&&delete t.nullPolyfill.__proto__,null===n&&(n=t.nullPolyfill),e.__proto__=n,o&&s(t.nullPolyfill,"__proto__",u),e},Object.defineProperty(e,"level",{configurable:!1,enumerable:!1,writable:!1,value:t.level})):null}(function(){var t,e=Object.create(null),n={},r=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__");if(r){try{t=r.set,t.call(e,n)}catch(t){}if(Object.getPrototypeOf(e)===n)return{set:t,level:2}}return e.__proto__=n,Object.getPrototypeOf(e)===n?{level:2}:(e={},e.__proto__=n,Object.getPrototypeOf(e)===n&&{level:1})}()),n(71)},function(t,e,n){"use strict";var r=n(85);t.exports=function(t){
if(!r(t))throw new TypeError(t+" is not iterable");return t}},,function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e)).next())})},i=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},a=n(1),s=n(9),u=n(26),c=n(12),l=n(0),f=n(8),p=n(25),d=n(37),h=n(5),m=l.geo,v=l.sfx,g=l.svg,y=l.math,b=l.algorithm,_=l.Mediator,w=l.color,x=l.file,k=l.tryGetFromMap,S=v.Scale,L=y.getCenter,M=b.findCircle,E=[{event:"routefrom",text:"Route from here"},{event:"routeto",text:"Route to here"},{event:"clearroute",text:"Clear route"},{event:"showheatmap",text:"Show heatmap",extra:{disabled:!0}}],O=function(t){function e(e){var n=t.call(this)||this;return n.whiskers=new WeakMap,n.platformsOnSVG=new WeakMap,n.config=e,n.makeMap(),n}return r(e,t),e.prototype.getMap=function(){return this.map},e.prototype.getNetwork=function(){return this.network},e.prototype.makeMap=function(){return o(this,void 0,void 0,function(){var t,e,n,r,o,s,p,v,y,b,_,w,x,k,S=this;return i(this,function(i){switch(i.label){case 0:return t=this.config,document.getElementById("scheme").href=t.url.scheme,e=this.getGraph(),n=f.getLineRules(),r=new Promise(function(t){return d.mapbox.once("load",t)}),o=new c.FAQ(t.url.data),this.config.center=[0,0],s=Object.assign({},t),"1"===a.version[0]&&(s.wheelPxPerZoomLevel=75,s.inertiaMaxSpeed=1500,s.fadeAnimation=!1),this.map=a.map(t.containerId,s).addControl(a.control.scale({imperial:!1})),p=this.map.getPanes().mapPane.style,p.visibility="hidden",c.addLayerSwitcher(this.map,[d.mapbox,d.mapnik,d.osmFrance,d.openMapSurfer,d.cartoDBNoLabels,d.wikimapia]),addEventListener("keydown",function(t){t.shiftKey&&t.ctrlKey&&82===t.keyCode&&S.getGraph().then(function(t){return S.resetNetwork(t)})}),this.addContextMenu(),[4,e];case 1:return v=i.sent(),this.network=new u.default(v),y=m.getCenter(this.network.platforms.map(function(t){return t.location})),this.config.center=[y.lat,y.lng],b=a.latLngBounds(this.network.platforms.map(function(t){return t.location})),this.overlay=new c.SvgOverlay(b).addTo(this.map),_=this.overlay.defs,g.Filters.appendAll(_),w=_.textContent,0===(w||"").length&&alert((k=["Your browser doesn't seem to have capabilities to display some features of the map. Consider using Chrome or Firefox for the best experience."],k.raw=["Your browser doesn't seem to have capabilities to display some features of the map. Consider using Chrome or Firefox for the best experience."],h.tr(k))),[4,n];case 2:return x=i.sent(),this.lineRules=x,this.resetMapView(),this.map.addLayer(d.mapbox),this.map.on("overlayupdate",function(t){S.redrawNetwork()}),this.initNetwork(),this.map.invalidateSize(!1),this.addMapListeners(),(new c.RoutePlanner).addTo(this),(new c.DistanceMeasure).addTo(this.map),a.Browser.mobile||new c.MapEditor(this.config.detailedZoom).addTo(this),[4,o.whenAvailable];case 3:return i.sent(),o.addTo(this.map),[4,r];case 4:return i.sent(),l.fixFontRendering(),this.map.on("layeradd layerremove",function(t){return l.fixFontRendering()}),p.visibility="",[2]}})})},e.prototype.subscribe=function(e,n){var r=this;t.prototype.subscribe.call(this,e,n),this.map.on(e,function(t){return r.publish(t)})},e.prototype.addContextMenu=function(){var t=this;this.contextMenu=new c.ContextMenu(E);for(var e=0,n=E;e<n.length;e++){var r=n[e];this.map.on(r.event,function(e){console.log(e),t.publish(e)})}this.contextMenu.addTo(this.map)},e.prototype.addMapListeners=function(){var t=this,e=function(t){var e=t;return p.default.outerEdgeBindings.getKey(e)||p.default.innerEdgeBindings.getKey(e)},n=function(t){return p.default.dummyBindings.getKey(t)},r=this,o=r.map,i=r.contextMenu;o.on("distancemeasureinit",function(t){i.insertItem("measuredistance","Measure distance")}),o.on("clearmeasurements",function(t){i.removeItem("clearmeasurements"),i.insertItem("measuredistance","Measure distance")}),o.on("zoomstart",function(e){t.plate.hide()}),this.subscribe("measuredistance",function(t){i.removeItem("measuredistance"),i.insertItem("clearmeasurements","Clear measurements")}),this.subscribe("platformrename",function(e){var r=n(e.relatedTarget);t.plate.show(g.circleOffset(e.relatedTarget),l.getPlatformNames(r)),c.platformRenameDialog(r)}),this.subscribe("platformmovestart",function(e){t.plate.disabled=!0}),this.subscribe("platformmove",function(t){var e=n(t.relatedTarget);e.location=l.mouseToLatLng(o,t)}),this.subscribe("platformmoveend",function(e){var r=n(e.relatedTarget);t.plate.disabled=!1,t.plate.show(g.circleOffset(e.relatedTarget),l.getPlatformNames(r))}),this.subscribe("platformadd",function(n){console.log(n);var r=n.detail,i=l.mouseToLatLng(o,r),a=new u.Platform((p=["New station"],p.raw=["New station"],h.tr(p)),i,{});if(t.network.platforms.push(a),void 0!==r.relatedTarget){var s=e(r.relatedTarget),c=s.source===a?"target":"source",f=new u.Span(a,s[c],s.routes);s[c]=a,t.network.spans.push(f)}t.overlay.extendBounds(i),t.resetNetwork(JSON.parse(t.network.toJSON()));var p}),this.subscribe("platformdelete",function(e){var r=n(e.relatedTarget);t.network.deletePlatform(r),t.redrawNetwork()}),this.subscribe("spanroutechange",function(n){if(void 0!==n.relatedTarget){var r=e(n.relatedTarget),o=c.askRoutes(t.network,new Set(r.routes));r.routes=Array.from(o),t.resetNetwork(JSON.parse(t.network.toJSON()))}}),this.subscribe("spaninvert",function(n){if(void 0!==n.relatedTarget){var r=e(n.relatedTarget);r.invert(),t.resetNetwork(JSON.parse(t.network.toJSON()))}}),this.subscribe("spanend",function(e){var n=p.default.dummyBindings.getKey(e.detail.source),r=p.default.dummyBindings.getKey(e.detail.target);console.log(n,r),i.removeItem("spanend");var o=n.passingRoutes(),a=r.passingRoutes(),s=o.size,f=a.size,d=s>0&&0===f?1===s?o:c.askRoutes(t.network,o):f>0&&0===s?1===f?a:c.askRoutes(t.network,a):c.askRoutes(t.network,l.intersection(o,a));t.network.spans.push(new u.Span(n,r,Array.from(d))),t.resetNetwork(JSON.parse(t.network.toJSON()))}),this.subscribe("spandelete",function(n){if(void 0!==n.relatedTarget){var r=e(n.relatedTarget);l.deleteFromArray(t.network.spans,r),t.resetNetwork(JSON.parse(t.network.toJSON()))}}),this.subscribe("transferend",function(e){var n=p.default.dummyBindings.getKey(e.detail.source),r=p.default.dummyBindings.getKey(e.detail.target);console.log(n,r),i.removeItem("transferend"),t.network.transfers.push(new u.Transfer(n,r)),t.resetNetwork(JSON.parse(t.network.toJSON()))}),this.subscribe("transferdelete",function(e){if(void 0!==e.relatedTarget){var n=e.relatedTarget,r=p.default.outerEdgeBindings.getKey(n)||p.default.innerEdgeBindings.getKey(n);l.deleteFromArray(t.network.transfers,r),t.resetNetwork(JSON.parse(t.network.toJSON()))}}),this.subscribe("editmapstart",function(e){o.getZoom()<t.config.detailedZoom&&o.setZoom(t.config.detailedZoom);var n=function(t){var e=t.parentElement;if(!e)return!1;var n=e.id;return"paths-outer"===n||"paths-inner"===n};i.insertItem("platformaddclick","New station",function(t){return!n(t)});var r=function(t){var e=t.parentElement;return!!e&&("dummy-circles"===e.id,!0)};i.insertItem("platformrename","Rename station",r),i.insertItem("platformdelete","Delete station",r),i.insertItem("spanstart","Span from here",r),i.insertItem("transferstart","Transfer from here",r),i.insertItem("spanroutechange","Change route",n),i.insertItem("spaninvert","Invert span",n),i.insertItem("platformaddtolineclick","Add station to line",n),i.insertItem("spandelete","Delete span",n),i.insertItem("transferdelete","Delete transfer",function(t){var e=t.parentElement;if(!e)return!1;var n=e.id;return"transfers-outer"===n||"transfers-inner"===n})}),this.subscribe("editmapend",function(t){i.removeItem("platformaddclick"),i.removeItem("platformrename"),i.removeItem("platformdelete"),i.removeItem("spanstart"),i.removeItem("transferstart"),i.removeItem("platformaddtolineclick"),i.removeItem("spanroutechange"),i.removeItem("spandelete"),i.removeItem("transferdelete")}),this.subscribe("mapsave",function(e){x.downloadText("graph.json",t.network.toJSON())})},e.prototype.initNetwork=function(){for(var t=this.overlay.origin,e=["paths-outer","paths-inner","transfers-outer","station-circles","transfers-inner","dummy-circles"],n=0,r=e;n<r.length;n++){var o=r[n],i=g.createSVGElement("g");i.id=o,t.appendChild(i)}this.plate=new c.TextPlate,t.insertBefore(this.plate.element,document.getElementById("dummy-circles")),this.redrawNetwork(),this.addStationListeners()},e.prototype.resetMapView=function(){var t=this.config,e=t.center,n=t.zoom,r={pan:{animate:!1},zoom:{animate:!1}};return e?(this.map.setView(e,n+1,r),void this.map.setView(e,n,r)):void console.error("cannot set map to center")},e.prototype.getGraph=function(){return f.getJSON(this.config.url.graph)},e.prototype.resetNetwork=function(t){this.network=new u.default(t),this.redrawNetwork()},e.prototype.cleanElements=function(){for(var t=0,e=this.overlay.origin.childNodes;t<e.length;t++){var n=e[t];n!==this.plate.element&&l.removeAllChildren(n)}},e.prototype.addBindings=function(){for(var t=this.network.platforms,e=p.default.platformBindings,n=p.default.dummyBindings,r=0,o=t;r<o.length;r++){var i=o[r];this.platformToModel(i,[k(e,i),k(n,i)])}},e.prototype.redrawNetwork=function(){var t=this;console.time("pre"),this.cleanElements(),this.updatePlatformsPositionOnOverlay(),console.timeEnd("pre"),console.time("preparation");for(var e=this.config.detailedZoom,n=this.map.getZoom(),r=n>9?n:n>8?9.5:9,o=.5*(r-7),i=.75*o,a=r<e?1.25*o:o,u=r<e?.4*a:.6*a,c=2*a,f=.9*o,d=1.25*u,h={"station-circles":u,"dummy-circles":0,"transfers-outer":f+d/2,"transfers-inner":f-d/2,"paths-outer":o,"paths-inner":o/2},m=a+u/2,v=new Map,y=0,b=Object.keys(h);y<b.length;y++){var _=b[y];v.set(_,document.createDocumentFragment()),l.byId(_).style.strokeWidth=h[_]+"px"}var w=k(this.lineRules,"light-rail-path");w.strokeWidth=i+"px";var x=Math.max(.5*(n+10),11),S=s.get(this.plate,"element.firstChild.firstChild.style");S&&(S.fontSize=x+"px");var L=new Map;console.timeEnd("preparation"),console.time("circle preparation");for(var E=k(v,"station-circles"),O=k(v,"dummy-circles"),T=0,C=this.network.stations;T<C.length;T++){for(var A=C[T],P=[],j=0,B=A.platforms;j<B.length;j++){var N=B[j],I=k(this.platformsOnSVG,N);if(n>9){var R=g.makeCircle(I,a);n>=e&&this.colorizePlatformCircle(R,N.passingLines());var F=g.makeCircle(I,c);E.appendChild(R),p.default.platformBindings.set(N,R),O.appendChild(F),p.default.dummyBindings.set(N,F)}this.whiskers.set(N,this.makeWhiskers(N))}var z=M(this.network,A);if(z.length>0){for(var D=0,G=A.platforms;D<G.length;D++){var N=G[D];if(z.includes(N)){var W=k(this.platformsOnSVG,N);P.push(W)}}L.set(A,z)}}if(console.timeEnd("circle preparation"),console.time("transfer preparation"),n>=e)for(var V=k(v,"transfers-outer"),U=k(v,"transfers-inner"),q=this.overlay.defs,Z=0,J=this.network.transfers;Z<J.length;Z++){var K=J[Z],H=K.source,Y=K.target,Q=k(this.platformsOnSVG,K.source),X=k(this.platformsOnSVG,K.target),$=L.get(H.station),tt=void 0!==$&&$.includes(H)&&$.includes(Y)?this.makeTransferArc(K,$):g.makeTransferLine(Q,X);p.default.outerEdgeBindings.set(K,tt[0]),p.default.innerEdgeBindings.set(K,tt[1]);var et=[H,Y].map(function(e){return t.getPlatformColor(e)}),nt=m/Q.distanceTo(X),rt=X.subtract(Q),ot=p.default.gradientBindings.get(K);void 0===ot?(ot=g.Gradients.makeLinear(rt,et,nt),ot.id=l.generateId(function(t){return null!==document.getElementById(t)}),p.default.gradientBindings.set(K,ot),q.appendChild(ot)):(g.Gradients.setDirection(ot,rt),g.Gradients.setOffset(ot,nt)),tt[0].style.stroke="url(#"+ot.id+")",V.appendChild(tt[0]),U.appendChild(tt[1])}console.timeEnd("transfer preparation"),console.time("span preparation");for(var it=k(v,"paths-outer"),at=k(v,"paths-inner"),st=0,ut=this.network.spans;st<ut.length;st++){var ct=ut[st],lt=this.makePath(ct),ft=lt[0],pt=lt[1];it.appendChild(ft),pt&&at.appendChild(pt)}console.timeEnd("span preparation"),console.time("appending"),v.forEach(function(t,e){return l.byId(e).appendChild(t)}),this.addBindings(),console.timeEnd("appending")},e.prototype.updatePlatformsPositionOnOverlay=function(t){void 0===t&&(t=this.map.getZoom());for(var e=t<this.config.detailedZoom,n=0,r=this.network.stations;n<r.length;n++)for(var o=r[n],i=e?this.overlay.latLngToSvgPoint(o.getCenter()):void 0,a=0,s=o.platforms;a<s.length;a++){var u=s[a],c=i||this.overlay.latLngToSvgPoint(u.location);this.platformsOnSVG.set(u,c)}},e.prototype.getPlatformColor=function(t){return w.mean(this.linesToColors(t.passingLines()))},e.prototype.linesToColors=function(t){var e=this,n=[];return t.forEach(function(t){var r=k(e.lineRules,"M"===t[0]?t:t[0]).stroke;r&&n.push(r)}),n},e.prototype.colorizePlatformCircle=function(t,e){if(0!==e.size){if(1===e.size){var n=e.values().next().value;return void t.classList.add("M"===n[0]?n:n[0])}t.style.stroke=w.mean(this.linesToColors(e))}},e.prototype.makeWhiskers=function(t){var e=this,n=k(this.platformsOnSVG,t),r=new Map;if(0===t.spans.length)return r;if(1===t.spans.length)return r.set(t.spans[0],n);if(2===t.spans.length){if(2===t.passingLines().size)return r.set(t.spans[0],n).set(t.spans[1],n);var o=function(n){return k(e.platformsOnSVG,n.other(t))},i=t.spans.map(function(t){return o(t).add(n).divideBy(2)}),a=l.midPointsToEnds(n,i);return r.set(t.spans[0],a[0]).set(t.spans[1],a[1])}for(var s=[[],[]],u=[[],[]],c=0,f=t.spans;c<f.length;c++){var p=f[c],d=p.other(t),h=k(this.platformsOnSVG,d),m=p.source===t?0:1;s[m].push(h),u[m].push(p)}var v=function(t){return 1===t.length?t[0]:0===t.length?n:L(t)},g=s.map(function(t){return v(t).add(n).divideBy(2)}),y=l.midPointsToEnds(n,g);return u[0].forEach(function(t){return r.set(t,y[0])}),u[1].forEach(function(t){return r.set(t,y[1])}),r},e.prototype.makeTransferArc=function(t,e){var n=this,r=t.source,o=t.target,i=k(this.platformsOnSVG,t.source),a=k(this.platformsOnSVG,t.target),u=function(t){return g.makeTransferArc(i,a,k(n.platformsOnSVG,t))};if(3===e.length){var c=s.difference(e,[r,o])[0];return u(c)}if(r===e[2]&&o===e[3]||r===e[3]&&o===e[2])return g.makeTransferLine(i,a);for(var l=[],f=0,p=this.network.transfers;f<p.length;f++){var d=p[f];d!==t&&(t.has(d.source)?l.push(d.target):t.has(d.target)&&l.push(d.source))}var h;if(2===l.length){if(l[0]!==l[1])throw Error("FFFFUC");h=l[0]}else{if(3!==l.length)throw new Error("111FUUFF");h=l[0]===l[1]?l[2]:l[0]===l[2]?l[1]:l[0]}return u(h)},e.prototype.makePath=function(t){var e=t.routes,n="",r="",o="";if(e.length>0){var i=t.routes[0].line.match(/([MEL])(\d{0,2})/);if(!i)throw new Error("match failed for "+t.source.name+"-"+t.target.name);n=i[0],r=i[1],o=i[2]}else console.error(t,"span has no routes!");var a=[k(this.platformsOnSVG,t.source),k(k(this.whiskers,t.source),t),k(k(this.whiskers,t.target),t),k(this.platformsOnSVG,t.target)],s=g.makeCubicBezier(a);if("E"===r){s.classList.add("E");var u=s.cloneNode(!0);return p.default.outerEdgeBindings.set(t,s),p.default.innerEdgeBindings.set(t,u),[s,u]}return void 0!==n&&s.classList.add(n),void 0!==r?s.classList.add(r):s.style.stroke="black",p.default.outerEdgeBindings.set(t,s),[s]},e.prototype.addStationListeners=function(){var t=this,e=function(e){t.plate.hide(),S.unscaleAll()},n=l.byId("dummy-circles");n.addEventListener("mouseover",function(e){var n=e.target,r=p.default.dummyBindings.getKey(n),o=r.station,i=t.map.getZoom()<t.config.detailedZoom&&o.platforms.length>1?o.getNames():l.getPlatformNames(r);t.highlightStation(o,i)}),n.addEventListener("mouseout",e);var r=function(e){var n=e.target,r=p.default.outerEdgeBindings.getKey(n)||p.default.innerEdgeBindings.getKey(n),o=l.getPlatformNamesZipped([r.source,r.target]);t.highlightStation(r.source.station,o)},o=l.byId("transfers-outer"),i=l.byId("transfers-inner");o.addEventListener("mouseover",r),i.addEventListener("mouseover",r),o.addEventListener("mouseout",e),i.addEventListener("mouseout",e)},e.prototype.highlightStation=function(t,e){var n,r,o=1.25;if(1===t.platforms.length)r=t.platforms[0],n=k(p.default.platformBindings,r),S.scaleCircle(n,o,!0);else{var i=this.map.getZoom()<this.config.detailedZoom?void 0:this.network.transfers;S.scaleStation(t,o,i),r=t.platforms.reduce(function(t,e){return t.location.lat<e.location.lat?e:t}),n=k(p.default.platformBindings,r)}this.plate.show(g.circleOffset(n),e)},e.prototype.platformToModel=function(t,e){var n=this,r=t.location;Object.defineProperty(t,"location",{get:function(){return t._location},set:function(r){t._location=r;for(var o=n.map.getZoom()<n.config.detailedZoom?t.station.getCenter():r,i=n.overlay.latLngToSvgPoint(o),a=0,s=e;a<s.length;a++){var u=s[a];u.setAttribute("cx",i.x.toString()),u.setAttribute("cy",i.y.toString())}n.whiskers.set(t,n.makeWhiskers(t)),n.platformsOnSVG.set(t,i);for(var c=new Set(t.spans),l=0,f=t.spans;l<f.length;l++){var d=f[l],h=d.other(t);n.whiskers.set(h,n.makeWhiskers(h)),h.spans.forEach(function(t){return c.add(t)})}c.forEach(function(t){var e=[k(n.platformsOnSVG,t.source),k(k(n.whiskers,t.source),t),k(k(n.whiskers,t.target),t),k(n.platformsOnSVG,t.target)],r=p.default.outerEdgeBindings.get(t),o=p.default.innerEdgeBindings.get(t);g.setBezierPath(r,e),o&&g.setBezierPath(o,e)});for(var m=0,v=t.transfers;m<v.length;m++){var y=v[m];y[y.source===t?"source":"target"]=t}}}),t._location=r},e.prototype.transferToModel=function(t,e){var n=this,r=[t.source,t.target],o=e[0].tagName;["source","target"].forEach(function(i,a){Object.defineProperty(t,i,{get:function(){return t["_"+i]},set:function(r){t["_"+i]=r;var s=k(p.default.platformBindings,r),u=parseFloat(getComputedStyle(s).strokeWidth||""),c=+s.getAttribute("r")/2+u,l=k(n.platformsOnSVG,r);if("line"===o){for(var f=a+1,d=t.other(r),h=0,m=e;h<m.length;h++){var v=m[h];v.setAttribute("x"+f,l.x.toString()),v.setAttribute("y"+f,l.y.toString())}var y=k(p.default.gradientBindings,t),b=k(n.platformsOnSVG,d),_="source"===i?b.subtract(l):l.subtract(b);g.Gradients.setDirection(y,_);var w=c/l.distanceTo(b);g.Gradients.setOffset(y,w)}else{if("path"!==o)throw new TypeError("wrong element type for transfer");for(var x=[],S=0,L=n.network.transfers;S<L.length;S++){var M=L[S];if(t.isAdjacent(M)&&(x.push(M),3===x.length))break}for(var E=new Set,O=0,T=x;O<T.length;O++){var C=T[O];E.add(C.source).add(C.target)}var A=Array.from(E).map(function(t){return n.platformsOnSVG.get(t)});E.forEach(function(t){return A.push(n.platformsOnSVG.get(t))});for(var P=x.map(function(t){return p.default.outerEdgeBindings.get(t)}),j=x.map(function(t){return p.default.innerEdgeBindings.get(t)}),B=0;B<3;++B){var N=x[B],I=P[B],R=j[B],F=k(n.platformsOnSVG,N.source),z=k(n.platformsOnSVG,N.target),D=A.find(function(t){return t!==F&&t!==z});D&&g.setCircularPath(I,F,z,D),R.setAttribute("d",I.getAttribute("d"));var y=k(p.default.gradientBindings,N);g.Gradients.setDirection(y,z.subtract(F));var w=c/F.distanceTo(z);g.Gradients.setOffset(y,w)}}}}),t["_"+i]=r[a]})},e}(_);Object.defineProperty(e,"__esModule",{value:!0}),e.default=O},function(t,e,n){"use strict";var r=function(){function t(t,e,n,r){void 0===n&&(n={}),this.spans=[],this.transfers=[],this.name=t,this.altNames=n,this.location=e,this.elevation=r}return Object.defineProperty(t.prototype,"station",{get:function(){return this._station},enumerable:!0,configurable:!0}),t.prototype.passingRoutes=function(){for(var t=new Set,e=0,n=this.spans;e<n.length;e++)for(var r=n[e],o=0,i=r.routes;o<i.length;o++){var a=i[o];t.add(a)}return t},t.prototype.passingLines=function(){for(var t=new Set,e=0,n=this.spans;e<n.length;e++)for(var r=n[e],o=0,i=r.routes;o<i.length;o++){var a=i[o];t.add(a.line)}return t},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(0),i=n(11),a=function(t){function e(e,n,r){var o=t.call(this,e,n)||this;return e.spans.push(o),n.spans.push(o),o.routes=r,o}return r(e,t),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(t){void 0!==this._source&&o.deleteFromArray(this._source.spans,this),this._source=t,t.spans.push(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){void 0!==this._target&&o.deleteFromArray(this._target.spans,this),this._target=t,t.spans.push(this)},enumerable:!0,configurable:!0}),e}(i.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){"use strict";var r=n(0),o=function(){function t(t){this.platforms=t;for(var e=0,n=t;e<n.length;e++){var r=n[e];r._station=this}}return t.prototype.getNames=function(){return r.getPlatformNamesZipped(this.platforms)},t.prototype.getCenter=function(){return r.geo.getCenter(this.platforms.map(function(t){return t.location}))},t.prototype.passingLines=function(){for(var t=new Set,e=0,n=this.platforms;e<n.length;e++)for(var r=n[e],o=0,i=r.spans;o<i.length;o++)for(var a=i[o],s=0,u=a.routes;s<u.length;s++){var c=u[s];t.add(c.line)}return t},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(0),i=n(11),a=function(t){function e(e,n){var r=t.call(this,e,n)||this;return e.transfers.push(r),n.transfers.push(r),r}return r(e,t),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(t){void 0!==this._source&&o.deleteFromArray(this._source.transfers,this),this._source=t,t.transfers.push(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){void 0!==this._target&&o.deleteFromArray(this._target.transfers,this),this._target=t,t.transfers.push(this)},enumerable:!0,configurable:!0}),e}(i.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){"use strict";var r=n(1);e.mapbox=r.tileLayer("https://{s}.tiles.mapbox.com/v3/inker.mlo91c41/{z}/{x}/{y}.png",{detectRetina:!1,attribution:'Map data &copy; <a href="https://openstreetmap.org">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://mapbox.com">Mapbox</a>'}),e.mapnik=r.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.osmFrance=r.tileLayer("http://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",{attribution:'&copy; Openstreetmap France | &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.openMapSurfer=r.tileLayer("http://korona.geog.uni-heidelberg.de/tiles/roads/x={x}&y={y}&z={z}",{attribution:'Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.hyddaBase=r.tileLayer("https://{s}.tile.openstreetmap.se/hydda/base/{z}/{x}/{y}.png",{detectRetina:!0,attribution:'Tiles courtesy of <a href="http://openstreetmap.se/" target="_blank">OpenStreetMap Sweden</a> &mdash; Map data &copy; <a href="http://server.ts.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.esriGrey=r.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ",detectRetina:!0}),e.cartoDB=r.tileLayer("http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'}),e.cartoDBNoLabels=r.tileLayer("http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'}),e.wikimapia=r.tileLayer("http://i{hash}.wikimapia.org/?x={x}&y={y}&zoom={z}",{hash:function(t){return t.x%4+t.y%4*4}})},function(t,e,n){"use strict";var r=n(1),o=n(0),i=n(5);n(99);var a=function(){function t(t){console.log("adding context menu"),this.items=t,this.container=document.createElement("div"),this.container.id="contextmenu",this.container.addEventListener("contextmenu",function(t){t.preventDefault(),t.target.click()}),console.log("context menu ready")}return t.prototype.addTo=function(t){return this.onAdd(t),this},t.prototype.onAdd=function(t){var e=this;if(this.map=t,void 0===t)throw new Error("cannot add map editor to metro map: leaflet map is missing");var n=t.getPanes().mapPane,o=t.getContainer(),i=function(t){return e.handler(t)},a=function(t){return e.hide()};n.addEventListener("contextmenu",i,!1),o.addEventListener("mousedown",a),o.addEventListener("touchstart",a),r.Browser.mobile||t.on("movestart",a),document.body.appendChild(this.container)},t.prototype.onRemove=function(t){},t.prototype.handler=function(t){var e=this;t.preventDefault(),console.log("target",t.target,t.target.parentNode),o.removeAllChildren(this.container);for(var n=0,r=this.items;n<r.length;n++){var a=r[n];if(void 0===a.trigger||a.trigger(t.target)){var s=document.createElement("div");void 0!==a.extra&&a.extra.disabled?s.setAttribute("disabled",""):s.setAttribute("data-event",a.event),s.textContent=i.translate(a.text),this.container.appendChild(s)}else console.log(a.trigger(t.target))}this.container.onclick=function(n){console.log(n);var r=n.target,o=r.getAttribute("data-event");o&&(e.hide(),e.map.fireEvent(o,{clientX:h,clientY:m,relatedTarget:t.target}))};var u=this.container.getBoundingClientRect(),c=u.width,l=u.height,f=document.documentElement,p=f.clientWidth,d=f.clientHeight,h=t.clientX,m=t.clientY,v=h+c>p?p-c:h,g=m+l>d?m-l:m;this.container.style.transform="translate("+v+"px, "+g+"px)",this.show()},t.prototype.insertItem=function(t,e,n,r,o){var i={event:t,text:e,trigger:n,extra:r};void 0===o||o<0?this.items.push(i):this.items.splice(o,0,i)},t.prototype.removeItem=function(t,e){if(void 0===e&&(e=!1),e)return void(this.items=this.items.filter(function(e){return e.event!==t}));var n=this.items.findIndex(function(e){return e.event===t});void 0===n||n<0||this.items.splice(n,1)},t.prototype.show=function(){this.container.style.visibility=null,r.Browser.mobile&&this.map.dragging.disable()},t.prototype.hide=function(){this.container.style.visibility="hidden",r.Browser.mobile&&this.map.dragging.enable()},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){"use strict";var r=n(1),o=n(0),i=n(12),a=function(){function t(){var t=this;this.polyline=r.polyline([],{color:"red"}),this.markers=r.featureGroup().on("layeradd layerremove",function(t){return o.fixFontRendering()}),this.dashedLine=r.polyline([],{color:"red",opacity:.5,dashArray:"0,9"}),this.makeMarker=function(e){if(0===e.originalEvent.button){var n=function(e){t.dashedLine.setStyle({opacity:0}),t.updateDistances()},o=r.marker(e.latlng,{draggable:!0}).setIcon(i.Icons.Circle).bindPopup("").on("mouseover",function(e){return t.hideDashedLine()}).on("mouseout",function(e){return t.showDashedLine()}).on("drag",n).on("click",t.onCircleClick.bind(t));t.markers.addLayer(o),t.updateDistances()}},this.resetDashedLine=function(e){t.dashedLine.getLatLngs()[1]=e.latlng,t.dashedLine.redraw()}}return t.prototype.onAdd=function(t){var e=this;this.map=t;return t.fireEvent("distancemeasureinit"),t.on("measuredistance",function(n){return e.measureDistance(o.mouseToLatLng(t,n))}),t.on("clearmeasurements",function(t){return e.clearMeasurements()}),this},t.prototype.onRemove=function(t){},t.prototype.addTo=function(t){return this.onAdd(t),this},t.prototype.updateDistances=function(){var t=this.polyline.getLatLngs(),e=this.markers.getLayers(),n=e.length;t[0]=e[0].setPopupContent("0").getLatLng();for(var r=1,o=0;r<n;++r){var i=e[r].getLatLng();t[r]=i,o+=e[r-1].getLatLng().distanceTo(i);var a=Math.round(o),s=a<1e3?a+" m":(a<1e4?a/1e3:Math.round(a/10)/100)+" km";e[r].setPopupContent(s)}t.length>n&&(t.length=n),this.dashedLine.getLatLngs()[0]=t[t.length-1],this.polyline.redraw(),n>1&&e[n-1].openPopup()},t.prototype.showDashedLine=function(){this.dashedLine.setStyle({opacity:.5})},t.prototype.hideDashedLine=function(){this.dashedLine.setStyle({opacity:0})},t.prototype.onCircleClick=function(t){if(0===t.originalEvent.button){if(this.markers.removeLayer(t.target),0===this.markers.getLayers().length)return void this.map.fire("clearmeasurements");this.updateDistances(),this.map.hasLayer(this.dashedLine)||this.showDashedLine()}},t.prototype.measureDistance=function(t){var e=this;this.dashedLine.addLatLng(t).addLatLng(t),this.map.addLayer(this.polyline.setLatLngs([])).addLayer(this.markers).addLayer(this.dashedLine.setLatLngs([])).on("click",this.makeMarker).on("mousemove",this.resetDashedLine).fire("click",{latlng:t,originalEvent:{button:0}}),o.onceEscapePress(function(t){return e.map.fire("clearmeasurements")})},t.prototype.clearMeasurements=function(){this.map.removeLayer(this.polyline).removeLayer(this.markers.clearLayers()).removeLayer(this.dashedLine).off("mousemove",this.resetDashedLine).off("click",this.makeMarker)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(24),i=n(47),a=n(0);n(100);var s=function(t){function e(e){var n=t.call(this)||this,r=fetch(e).then(function(t){return t.json()}),i=document.createElement("button");i.id="faq-button",i.textContent="FAQ",i.classList.add("leaflet-control"),i.addEventListener("click",function(t){return n.showFAQ()}),n.button=i,n.card=document.createElement("div"),n.card.id="faq-card",L.Browser.mobile&&new o(n.card).on("swipeleft swiperight",function(t){return n.hideFAQ()});var a=/\[\[(.+?)\|(.*?)\]\]/g,s='<a href="$1" target="_blank">$2</a>',u=function(t){return'<div><span class="question">'+t.q+'</span><span class="answer">'+t.a+"</span></div>"};return n._whenAvailable=r.then(function(t){n.card.innerHTML+=t.faq.map(u).join("").replace(a,s)}),n}return r(e,t),e.prototype.addTo=function(t){var e=this;this._whenAvailable.then(function(t){var n=document.querySelector(".leaflet-right.leaflet-top");return document.body.appendChild(e.card),n?void n.appendChild(e.button):void console.error("cannot append to .leaflet-right.leaflet-top")})},e.prototype.showFAQ=function(){var t=this,e=this.card.style;e.display="inline",e.transform="scale(0.1)",
e.opacity="0",this.card.getBoundingClientRect(),e.transform=null,e.opacity=null,this.button.disabled=!0,L.Browser.mobile||(this.map.getContainer().classList.add("dimmed"),this.map.once("mousedown",function(e){return t.hideFAQ()}),a.once(window,"keydown",function(e){27===e.keyCode&&t.map.fireEvent("mousedown")}))},e.prototype.hideFAQ=function(){var t=this;console.log("hiding"),this.card.getBoundingClientRect(),this.card.style.transform="scale(0.1)",this.card.style.opacity="0",L.Browser.mobile||this.map.getContainer().classList.remove("dimmed"),a.once(this.card,"transitionend",function(e){return t.card.style.display=null}),this.button.disabled=!1},e}(i.DeferredWidget);Object.defineProperty(e,"__esModule",{value:!0}),e.default=s},function(t,e,n){"use strict";var r=n(0);e.Start=L.icon({iconUrl:"https://proxy-antonv.rhcloud.com/?url=http://map.project-osrm.org/images/marker-start-icon-2x.png",iconSize:[20,56],iconAnchor:[10,28]}),e.End=L.icon({iconUrl:"https://proxy-antonv.rhcloud.com/?url=http://map.project-osrm.org/images/marker-end-icon-2x.png",iconSize:[20,56],iconAnchor:[10,28]}),e.Red=L.icon({iconUrl:"https://proxy-antonv.rhcloud.com/?url=http://harrywood.co.uk/maps/examples/leaflet/marker-icon-red.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:"https://proxy-antonv.rhcloud.com/?url=http://cdn.leafletjs.com/leaflet/v0.7.7/images/marker-shadow.png",shadowRetinaUrl:"marker-shadow-@2x.png",shadowSize:[41,41],shadowAnchor:[12,41]}),e.Circle=function(){var t=r.svg.createSVGElement("svg");t.setAttribute("width","100"),t.setAttribute("height","100");var e=r.svg.makeCircle(L.point(50,50),40);e.style.stroke="red",e.style.strokeWidth="20px",e.style.fill="white",t.appendChild(e);var n=5;return L.icon({iconUrl:r.file.svgToDataUrl(t),iconSize:[2*n,2*n],iconAnchor:[n,n],popupAnchor:[0,-n]})}()},function(t,e,n){"use strict";var r=n(5),o=n(0),i=function(){function t(t){var e=this,n=document.createElement("button");n.id="edit-map-button",n.textContent="Edit Map",n.classList.add("leaflet-control"),n.onclick=function(t){return e.editMapClick()},this.button=n}return Object.defineProperty(t.prototype,"editMode",{get:function(){return this._editMode},set:function(t){var e=this;if(t){var n=o.byId("dummy-circles");this.button.textContent=(i=["Save map"],i.raw=["Save map"],r.tr(i)),this.button.onclick=function(t){return e.saveMapClick()},n.onmousedown=n.onclick=function(){return!1},this.metroMap.publish(new Event("editmapstart"))}else this.button.textContent=(a=["Edit map"],a.raw=["Edit map"],r.tr(a)),this.button.onclick=function(t){return e.editMapClick()},this.metroMap.publish(new Event("editmapend"));this._editMode=t;var i,a},enumerable:!0,configurable:!0}),t.prototype.addTo=function(t){var e=t.getMap();if(void 0===e)throw new Error("cannot add map editor to metro map: map is missing");this.metroMap=t;var n=document.querySelector(".leaflet-right.leaflet-top");return n?(n.appendChild(this.button),this.editMode=!1):console.error("cannot append to .leaflet-right.leaflet-top"),this},t.prototype.editMapClick=function(){this.editMode=!0,this.addMapListeners()},t.prototype.saveMapClick=function(){this.metroMap.publish(new Event("mapsave")),this.editMode=!1},t.prototype.addMapListeners=function(){var t=this;console.log("adding edit map listeners");var e,n,r,i=this.metroMap.getMap(),a=o.byId("dummy-circles");o.byId("paths-outer"),o.byId("paths-inner");a.addEventListener("mousedown",function(o){if(2!==o.button&&r){var a={source:r,target:o.target};console.log(a),t.metroMap.publish(new CustomEvent("span"===n?"spanend":"transferend",{detail:a})),r=null,n=void 0}else 0===o.button?(i.dragging.disable(),e=o.target,t.metroMap.publish(new MouseEvent("platformmovestart",{relatedTarget:o.target}))):1===o.button&&(console.log("foo",o.target),t.metroMap.publish(new MouseEvent("spanstart",{relatedTarget:o.target})))}),i.on("mousemove",function(n){if(e){var r=n.originalEvent,o=r.clientX,i=r.clientY,a={relatedTarget:e,clientX:o,clientY:i};t.metroMap.publish(new MouseEvent("platformmove",a))}}).on("mouseup",function(n){if(e){i.dragging.enable();var r={relatedTarget:e};t.metroMap.publish(new MouseEvent("platformmoveend",r)),e=null}}),this.metroMap.subscribe("spanstart",function(t){n="span",r=t.relatedTarget}),this.metroMap.subscribe("transferstart",function(t){n="transfer",r=t.relatedTarget}),this.metroMap.subscribe("platformaddclick",function(e){var n=e.clientX,r=e.clientY;t.metroMap.publish(new CustomEvent("platformadd",{detail:{clientX:n,clientY:r}}))}),this.metroMap.subscribe("platformaddtolineclick",function(e){t.metroMap.publish(new CustomEvent("platformadd",{detail:e}))})},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";var r=n(1),o=n(7),i=n(0),a=n(12),s=i.sfx,u=i.algorithm.shortestRoute,c=function(){function t(){this.fromMarker=r.marker([0,0],{draggable:!0,icon:a.Icons.Start}),this.toMarker=r.marker([0,0],{draggable:!0,icon:a.Icons.End}),this.addMarkerListeners()}return t.prototype.addTo=function(t){var e=this;this.metroMap=t;var n=t.getMap(),r=n.getCenter();return this.fromMarker.setLatLng(r),this.toMarker.setLatLng(r),a.cacheIcons(n,[this.fromMarker,this.toMarker]),t.subscribe("routefrom routeto",this.handleFromTo.bind(this)),t.subscribe("clearroute",function(t){return e.clearRoute()}),n.on("zoomstart",function(t){return s.Animation.terminateAnimations()}),addEventListener("keydown",function(e){27===e.keyCode&&t.publish(new Event("clearroute"))}),this},t.prototype.handleFromTo=function(t){var e=this.metroMap.getMap(),n=i.mouseToLatLng(e,t),r="routefrom"===t.type?this.fromMarker:this.toMarker;r.setLatLng(n),e.hasLayer(r)||e.addLayer(r);var o=r===this.fromMarker?this.toMarker:this.fromMarker;e.hasLayer(o)&&(i.fixFontRendering(),this.visualizeRouteBetween(this.fromMarker.getLatLng(),this.toMarker.getLatLng()))},t.prototype.addMarkerListeners=function(){for(var t=this,e=0,n=[this.fromMarker,this.toMarker];e<n.length;e++){var r=n[e];r.on("drag",function(e){return t.visualizeShortestRoute(!1)}).on("dragend",function(e){i.fixFontRendering(),t.visualizeShortestRoute()})}},t.prototype.visualizeShortestRoute=function(t){void 0===t&&(t=!0);var e=this.metroMap.getMap();e.hasLayer(this.fromMarker)&&e.hasLayer(this.toMarker)&&this.visualizeRouteBetween(this.fromMarker.getLatLng(),this.toMarker.getLatLng(),t)},t.prototype.visualizeRouteBetween=function(t,e,n){void 0===n&&(n=!0),i.resetStyle(),o.dismissAll(),s.visualizeRoute(u(this.metroMap.getNetwork().platforms,t,e),n)},t.prototype.clearRoute=function(){var t=this.metroMap.getMap(),e=s.Animation.terminateAnimations();t.removeLayer(this.fromMarker).removeLayer(this.toMarker),this.fromMarker.off("drag").off("dragend"),this.toMarker.off("drag").off("dragend"),o.dismissAll(),e.then(i.resetStyle)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=c},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(1),i=n(46),a=n(15),s=function(t){function e(e,n){void 0===n&&(n=o.point(100,100));var r=t.call(this,e,n)||this;return r.overlayContainer=a.createSVGElement("svg"),r.overlayContainer.id="overlay",r._defs=a.createSVGElement("defs"),r.overlayContainer.appendChild(r._defs),r._origin=a.createSVGElement("g"),r._origin.id="origin",r._origin.setAttribute("transform","translate("+r.margin.x+", "+r.margin.y+")"),r.overlayContainer.appendChild(r._origin),r}return r(e,t),Object.defineProperty(e.prototype,"origin",{get:function(){return this._origin},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"defs",{get:function(){return this._defs},enumerable:!0,configurable:!0}),e}(i.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=s},function(t,e,n){"use strict";var r=n(0);n(101);var o=function(){function t(){this._disabled=!1,this._editable=!1;var t=document.createElement("div");t.classList.add("plate-box");var e=r.svg.createSVGElement("foreignObject");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width","100%"),e.setAttribute("height","100%"),e.appendChild(t);var n=r.svg.createSVGElement("g");n.id="station-plate",n.style.display="none",n.appendChild(e),this._element=n}return Object.defineProperty(t.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"disabled",{get:function(){return this._disabled},set:function(t){t?this.hide():getSelection().removeAllRanges(),this._disabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editable",{get:function(){return this._editable},set:function(t){for(var e=t?"true":null,n=this._element.childNodes[1].children[1],r=n.children,o=0;o<r.length;++o)r[o].contentEditable=e},enumerable:!0,configurable:!0}),t.prototype.show=function(t,e){if(!this.disabled&&"none"===this._element.style.display){var n=this._element.firstChild,r=n.firstChild;r.innerHTML=e.join("<br>"),this._element.setAttribute("transform","translate("+t.x+", "+t.y+")"),this._element.style.display=null;var o=r.getBoundingClientRect(),i=o.width,a=o.height;n.setAttribute("transform","translate("+-i+", "+-a+")"),console.log(n.getBoundingClientRect()),console.log(r.getBoundingClientRect())}},t.prototype.hide=function(){this._element.style.display="none"},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";function r(t,e){void 0===e&&(e=250),setTimeout(function(){return i.fixFontRendering(t)},e)}var o=n(1),i=n(0),a=function(){function t(t,e){void 0===e&&(e=o.point(100,100)),this.margin=e.round(),this._bounds=t}return t.prototype.addTo=function(t){return this.onAdd(t),this},t.prototype.onAdd=function(t){this.map=t,this.minZoom=t.getMinZoom(),this.maxZoom=t.getMaxZoom(),this.updateOverlayPositioning();var e=t.getPanes(),n=e.objectsPane,r=e.markerPane,i=e.mapPane;("1"===o.version[0]?i:n).insertBefore(this.overlayContainer,r),this.addMapMovementListeners()},t.prototype.onRemove=function(t){var e=t.getPanes(),n=e.objectsPane,r=(e.markerPane,e.mapPane);("1"===o.version[0]?r:n).removeChild(this.overlayContainer),this.map.clearAllEventListeners()},t.prototype.addMapMovementListeners=function(){var t,e=this,n=this.map,a=n.getPanes(),s=a.mapPane,u=a.tilePane,c=a.overlayPane,l=this.overlayContainer,f=l.style,p=l.classList;n.on("zoomstart",function(t){p.add("leaflet-zoom-animated"),console.log("zoomstart",t),n.dragging.disable()}).on("zoomanim",function(n){console.log("zoomanim",n);var r=n,o=r.scale,a=r.origin;1!==o&&i.scaleOverlay(e.overlayContainer,o,t||a),t=null}).on("zoomend",function(t){console.log("zoomend",t),p.remove("leaflet-zoom-animated"),f.transform=null,f.transformOrigin=null,e.updateOverlayPositioning(),n.fireEvent("overlayupdate",e),n.dragging.enable()}).on("moveend",function(t){i.fixFontRendering(),"1"===o.version[0]?r(u.firstElementChild):c.hasChildNodes()&&r(c,0)});var d=function(e){return t=o.DomEvent.getMousePosition(e)};s.addEventListener("wheel",d);var h=document.querySelector(".leaflet-control-container");h?h.addEventListener("wheel",d):console.error("cannot append wheel to leaflet-control-container"),n.zoomControl.getContainer().addEventListener("mousedown",function(e){return t=o.point(innerWidth/2,innerHeight/2).round()},!0),n.on("dblclick",function(e){return t=o.DomEvent.getMousePosition(e.originalEvent)}),document.addEventListener("keydown",function(e){return t=o.point(innerWidth/2,innerHeight/2)})},t.prototype.updateOverlayPositioning=function(){var t=this._bounds.getNorthWest(),e=this._bounds.getSouthEast(),n=this,r=n.map,i=n.margin;this.topLeft=r.project(t).round();var a=o.bounds(r.latLngToLayerPoint(t),r.latLngToLayerPoint(e)),s=this.overlayContainer.style,u=a.min.subtract(i);s.left=u.x+"px",s.top=u.y+"px";var c=a.getSize().add(i).add(i);s.width=c.x+"px",s.height=c.y+"px"},t.prototype.extendBounds=function(t){this._bounds.extend(t),this.updateOverlayPositioning()},t.prototype.latLngToSvgPoint=function(t){return this.map.project(t).round().subtract(this.topLeft)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){"use strict";var r=function(){function t(){}return Object.defineProperty(t.prototype,"whenAvailable",{get:function(){return this._whenAvailable},enumerable:!0,configurable:!0}),t}();e.DeferredWidget=r},function(t,e,n){"use strict";var r=function(){function t(){this.eventListeners=new Map}return t.prototype.subscribe=function(t,e){for(var n=0,r=t.split(/\s+/);n<r.length;n++){var o=r[n],i=this.eventListeners.get(o);void 0===i?this.eventListeners.set(o,[e]):i.push(e)}},t.prototype.unsubscribe=function(t,e){var n=this.eventListeners.get(t);if(void 0!==n){var r=n.indexOf(e);r<0||n.splice(r,1)}},t.prototype.publish=function(t){console.log("event as seen from the dispatcher",t);var e=this.eventListeners.get(t.type);if(void 0===e)return console.log("no event listeners registered for "+t.type),!1;for(var n=0,r=e;n<r.length;n++){var o=r[n];o(t)}return!0},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function r(t,e){if(e.platforms.length<3)return[];var n=e.platforms;if(3===n.length){for(var r=0,o=e.platforms;r<o.length;r++){var i=o[r];if(2!==t.transfers.filter(function(t){return t.has(i)}).length)return[]}return n}if(4===n.length){var a=(t.platforms,t.transfers),u=n.map(function(t){return{platform:t,degree:a.filter(function(e){return e.has(t)}).length}}).sort(function(t,e){return t.degree-e.degree}),c=u.map(function(t){return t.degree}),l=u.map(function(t){return t.platform});if(s.isEqual(c,[2,2,3,3]))return l;if(s.isEqual(c,[1,2,2,3]))return l.slice(1)}return[]}function o(t,e,n){for(var r=new Map,o=new Map,a=0,s=t;a<s.length;a++){var b=s[a],_=b.spans.some(function(t){return t.routes[0].line.startsWith("E")}),w=f(e,b.location),x=w/p;r.set(b,x+(_?y:g)),w=f(b.location,n),x=w/p,o.set(b,x)}for(var k=c.findClosestObject(e,t),S=new Set(t),L=new Map;S.size>0;){var M=1/0;S.forEach(function(t){var e=l.tryGetFromMap(r,t);e<M&&(k=t,M=e)}),S.delete(k);for(var E=L.get(k),O=k.spans.find(function(t){return t.has(E)}),T=[],C=[],A=0,P=k.spans;A<P.length;A++){var j=P[A],B=j.other(k);if(S.has(B)){T.push(B);var w=f(k.location,B.location),N=0;O&&O.routes[0]!==j.routes[0];var I=j.routes[0].line.startsWith("E")?v:m,R=u.timeToTravel(w,d,h);C.push(R+I+N)}}for(var F=0,z=k.station.platforms;F<z.length;F++){var B=z[F];if(S.has(B)){T.push(B);var _=B.spans.some(function(t){return t.routes[0].line.startsWith("E")}),w=f(k.location,B.location)/2;C.push(w/p+(_?y:g))}}for(var D=0,G=T.length;D<G;++D){var B=T[D],W=r.get(k)+C[D];W<r.get(B)&&(r.set(B,W),L.set(B,k))}r.get(k)+o.get(k)}var V=1/0;r.forEach(function(t,e){var n=r.get(e)+o.get(e);n<V&&(V=n,k=e)});var U=f(e,n)/p;if(U<V)return{time:{walkTo:U}};for(var q=[],Z=[k],J=L.get(k);void 0!==J&&void 0!==J;J=L.get(k)){for(var K=void 0,H=0,Y=k.spans;H<Y.length;H++){var j=Y[H];if(j.has(J)){K=j;break}}if(void 0===K)for(var Q=0,X=k.transfers;Q<X.length;Q++){var $=X[Q];if($.has(J)){K=$;break}}if(void 0===K){var tt=i(J,k),et=tt.transfers,nt=tt.midPlatforms;q.push.apply(q,et.reverse()),Z.push.apply(Z,nt)}else q.push(K);Z.push(J),k=J}Z.reverse(),q.reverse();var rt=o.get(Z[Z.length-1]),ot=l.tryGetFromMap(r,Z[0]);return{platforms:Z,edges:q,time:{walkTo:ot,metro:V-rt-ot,walkFrom:rt,total:V}}}function i(t,e){if(t.station!==e.station)throw new Error("platforms ("+t.name+" & "+e.name+" must be on the same station");for(var n=t.station,r=n.platforms,o=new Set(r),i=new Map,a=new Map,s=0,u=r;s<u.length;s++){var c=u[s];i.set(c,1/0)}i.set(t,0);for(var p=t;o.size>0;){var d=1/0;o.forEach(function(t){var e=l.tryGetFromMap(i,t);e<d&&(p=t,d=e)}),o.delete(p);for(var h=p.transfers.map(function(t){return t.other(p)}),m=0,v=h;m<v.length;m++){var g=v[m];if(g&&o.has(g)){var y=f(p.location,g.location),b=i.get(p)+y;b<i.get(g)&&(i.set(g,b),a.set(g,p))}}}var _=[],w=[];for(p=e;;){var x=a.get(p);if(!x)break;var k=p.transfers.find(function(t){return t.has(x)});k?(_.push(k),p=x,w.push(p)):console.error("cannot find transfer node")}return w.pop(),{transfers:_.reverse(),midPlatforms:w.reverse()}}var a=n(1),s=n(9),u=n(14),c=n(13),l=n(0);e.findCircle=r;var f=function(t,e){return a.LatLng.prototype.distanceTo.call(t,e)},p=1,d=20,h=.7,m=25,v=40,g=240,y=360;e.shortestRoute=o},function(t,e,n){"use strict";function r(t){var e=t.match(/[0-9a-f]{1,2}/gi);return e?e.map(function(t){return parseInt(t,16)}):[]}function o(t){var e=t.match(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i);return e?e.slice(1).map(Number):[]}function i(t){var e=function(t,e){return(e.startsWith("#")?r:o)(e).map(function(e,n){return t[n]+e})},n=t.reduce(e,[0,0,0]).map(function(e){return Math.floor(e/t.length)}),i=n[0],a=n[1],s=n[2];return"rgb("+i+", "+a+", "+s+")"}e.mean=i},function(t,e,n){"use strict";function r(t,e,n){var r=n.value;return n.value=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];console.time(e),r.apply(this,t),console.timeEnd(e)},n}function o(t,e,n){var r=n.value;if(null===r)throw new Error(e+" is not a method");var o=new Map;n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=JSON.stringify(t),i=o.get(n);if(void 0!==i)return i;var a=r.apply(this,t);return o.set(n,a),a}}e.time=r,e.MemoizeWithParameters=o},function(t,e,n){"use strict";function r(t,e){var n=document.createElement("a");n.href=e,n.download=t,n.click()}function o(t,e){var n=URL.createObjectURL(e);r(t,n),URL.revokeObjectURL(n)}function i(t,e){o(t,new Blob([e],{type:"octet/stream"}))}function a(t,e,n){s(e,n).then(function(e){return r(t,e)})}function s(t,e){return u(t).then(function(t){return t.toDataURL("image/"+e)})}function u(t){return new Promise(function(e,n){var r=l(t,!0);r.onload=function(t){var o=document.createElement("canvas");o.width=r.width,o.height=r.height;var i=o.getContext("2d");return i?(i.drawImage(r,0,0),void e(o)):n(new Error("2d context does not exist on canvas"))}})}function c(t){var e=s(t,"png"),n=document.createElement("img");return n.width=parseInt(t.getAttribute("width")||"")||parseInt(t.style.width||""),n.height=parseInt(t.getAttribute("height")||"")||parseInt(t.style.height||""),e.then(function(t){return n.src=t,n})}function l(t,e){void 0===e&&(e=!1),e&&(t=p(t));var n=document.createElement("img");return n.width=parseInt(t.getAttribute("width")||"")||parseInt(t.style.width||""),n.height=parseInt(t.getAttribute("height")||"")||parseInt(t.style.height||""),n.src=f(t),n}function f(t){return"data:image/svg+xml;base64,"+btoa((new XMLSerializer).serializeToString(t))}function p(t){for(var e=t.cloneNode(!0),n=e.querySelectorAll("[id^=dummy]"),r=0,o=n.length;r<o;++r){var i=n[r],a=i.parentNode;a&&a.removeChild(i)}e.style.left=e.style.top="";var s=e.querySelector("#station-plate");if(s){var u=s.parentNode;u&&u.removeChild(s)}var c=document.createElement("style");c.textContent=d.getStyleRulesAsText();var l=e.querySelector("defs");return l&&l.insertBefore(c,l.firstChild),e}var d=n(8);e.download=r,e.downloadBlob=o,e.downloadText=i,e.downloadSvgAsPicture=a,e.svgToPictureDataUrl=s,e.svgToCanvas=u,e.svgToPicture=c,e.svgToImg=l,e.svgToDataUrl=f},function(t,e,n){"use strict";function r(t,e){return void 0===e&&(e=!0),s(this,void 0,void 0,function(){var n,r,a,s,l,f,p,h,g,y,b;return u(this,function(u){switch(u.label){case 0:return n=t.platforms,r=void 0===n?[]:n,a=t.edges,s=t.time,l=d.formatTime(s.walkTo),void 0===a?[2,c.success((y=[""," on foot!"],y.raw=[""," on foot!"],d.tr(y,l)))]:[4,v.terminateAnimations()];case 1:for(u.sent(),f=0,p=document.querySelectorAll(m);f<p.length;f++)h=p[f].style,h.filter=null,h.opacity="0.25";return e?[4,v.animateRoute(r,a,1)]:(o(a),i(r),[2]);case 2:return g=u.sent(),g&&c.message((b=["TIME:<br>"," on foot<br>"," by metro<br>"," on foot<br>TOTAL: ",""],b.raw=["TIME:<br>"," on foot<br>"," by metro<br>"," on foot<br>TOTAL: ",""],d.tr(b,l,d.formatTime(s.metro),d.formatTime(s.walkFrom),d.formatTime(s.total))),10),[2]}})})}function o(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],o=l.default.outerEdgeBindings.get(r);if(void 0!==o){o.style.opacity=null;var i=l.default.innerEdgeBindings.get(r);void 0!==i&&(i.style.opacity=null),r instanceof f.Span&&p.Filters.applyDrop(o)}}}function i(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],o=l.default.platformBindings.get(r);o&&(o.style.opacity=null)}}var a,s=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e)).next())})},u=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},c=n(7),l=n(25),f=n(26),p=n(15),d=n(5),h=n(0),m=["paths-inner","paths-outer","transfers-inner","transfers-outer","station-circles"].map(function(t){return"#"+t+" *"}).join(", ");!function(t){function e(t,e,n){if(void 0===n&&(n=!1),!n)return void(t.style.transform="scale("+e+")");o.add(t);var r=t.getAttribute("r");r&&t.setAttribute("data-r",r),t.setAttribute("r",(+r*e).toString())}function n(t,n,r){for(var o=parseFloat(h.byId("transfers-outer").style.strokeWidth||""),a=parseFloat(h.byId("transfers-inner").style.strokeWidth||""),s=0,u=t.platforms;s<u.length;s++){var c=u[s],f=h.tryGetFromMap(l.default.platformBindings,c);if(e(f,n,!0),r&&!(t.platforms.length<2))for(var p=0,d=r;p<d.length;p++){var m=d[p];if(m.has(c)){var v=l.default.outerEdgeBindings.get(m),g=l.default.innerEdgeBindings.get(m);i.add(v),i.add(g),v.style.strokeWidth=o*n+"px",g.style.strokeWidth=a*n+"px"}}}}function r(){o.forEach(function(t){var e=t.getAttribute("data-r");null!==e&&t.setAttribute("r",e)}),i.forEach(function(t){return t.style.strokeWidth=null}),i.clear(),o.clear()}var o=new Set,i=new Set;t.scaleCircle=e,t.scaleStation=n,t.unscaleAll=r}(a=e.Scale||(e.Scale={}));var v,g=L.Browser.webkit&&!L.Browser.mobile;!function(t){function e(){return null===i?Promise.resolve(!0):(o=!1,i)}function n(t,n,a){return void 0===a&&(a=1),i=e().then(function(e){return new Promise(function(e,i){return function i(s){if(!o)return e(!1);var u=h.tryGetFromMap(l.default.platformBindings,t[s]);if(u.style.opacity=null,g&&r(u,s<n.length?1.5:3,200),s===n.length)return e(!0);var c=l.default.outerEdgeBindings.get(n[s]);if(!c)return i(s+1);var f=l.default.innerEdgeBindings.get(n[s]),d=c.cloneNode(!0),m=void 0===f?void 0:f.cloneNode(!0),v=h.byId("paths-outer");v.appendChild(d);var y=h.byId("paths-inner");m&&y.appendChild(m);var b;if(d instanceof SVGPathElement)b=d.getTotalLength();else{var _=L.point(+d.getAttribute("x1"),+d.getAttribute("y1")),w=L.point(+d.getAttribute("x2"),+d.getAttribute("y2"));b=_.distanceTo(w)}var x=n[s],k=x.source===t[s]?b:-b,S=b/a;p.Filters.applyDrop(d);for(var M=0,E=void 0===m?[d]:[d,m];M<E.length;M++){var O=E[M],T=O.style;T.transition=null,T.opacity=null,T.strokeDasharray=b+" "+b,T.strokeDashoffset=k.toString(),O.getBoundingClientRect(),T.transition="stroke-dashoffset "+S+"ms linear",T.strokeDashoffset="0"}d.addEventListener("transitionend",function(t){c.style.opacity=null,"t"!==d.id.charAt(1)&&p.Filters.applyDrop(c),v.removeChild(d),m&&(f.style.opacity=null,y.removeChild(m)),i(s+1)})}(0)}).then(function(t){return i=null,o=!0,t})})}function r(t,e,n){t.getBoundingClientRect(),t.style.transition="transform "+n/2+"ms linear",a.scaleCircle(t,e),t.addEventListener("transitionend",function t(e){this.removeEventListener("transitionend",t),this.style.transform="scale(1)",this.addEventListener("transitionend",function t(e){this.removeEventListener("transitionend",t),this.style.transition=null,this.style.transform=null})})}var o=!0,i=null;t.terminateAnimations=e,t.animateRoute=n,t.pulsateCircle=r}(v=e.Animation||(e.Animation={})),e.visualizeRoute=r,e.rehighlightEdges=o,e.rehighlightPlatforms=i},function(t,e,n){"use strict";var r=function(){function t(t){var e=this;this.left=new Map(t),this.right=new Map,this.left.forEach(function(t){return e.right.set(t)})}return t.prototype.clear=function(){this.left.clear(),this.right.clear()},t.prototype.delete=function(t){var e=this.left.get(t);return!!this.right.has(e)&&(this.right.delete(e),this.left.delete(t))},t.prototype.entries=function(){return this.left.entries()},t.prototype.forEach=function(t,e){this.left.forEach(t,e)},t.prototype.get=function(t){return this.left.get(t)},t.prototype.has=function(t){return this.left.has(t)},t.prototype.keys=function(){return this.left.keys()},t.prototype.set=function(t,e){var n=this.left.get(t),r=this.right.get(e);return this.left.has(t)&&this.right.delete(n),this.right.has(e)&&this.left.delete(r),this.left.set(t,e),this.right.set(e,t),this},Object.defineProperty(t.prototype,"size",{get:function(){return this.left.size},enumerable:!0,configurable:!0}),t.prototype.values=function(){return this.left.values()},t.prototype[Symbol.iterator]=function(){return this.left[Symbol.iterator]()},Object.defineProperty(t.prototype,Symbol.toStringTag,{get:function(){return this.left[Symbol.toStringTag]},enumerable:!0,configurable:!0}),t.prototype.deleteValue=function(t){var e=this.right.get(t);return!!this.left.has(e)&&(this.left.delete(e),this.right.delete(t))},t.prototype.getKey=function(t){return this.right.get(t)},t.prototype.hasValue=function(t){return this.right.has(t)},t}();e.BiMap=r;var o=function(){function t(t){if(this.left=new WeakMap,this.right=new WeakMap,void 0!==t)for(var e=0,n=t;e<n.length;e++){var r=n[e],o=r[0],i=r[1];this.left.set(o,i),this.right.set(i,o)}}return t.prototype.delete=function(t){var e=this.left.get(t);return!!this.right.has(e)&&(this.right.delete(e),this.left.delete(t))},t.prototype.get=function(t){return this.left.get(t)},t.prototype.has=function(t){return this.left.has(t)},t.prototype.set=function(t,e){var n=this.left.get(t),r=this.right.get(e);return this.left.has(t)&&this.right.delete(n),this.right.has(e)&&this.left.delete(r),this.left.set(t,e),this.right.set(e,t),this},Object.defineProperty(t.prototype,Symbol.toStringTag,{get:function(){return this.left[Symbol.toStringTag]},enumerable:!0,configurable:!0}),t.prototype.deleteValue=function(t){var e=this.right.get(t);return!!this.left.has(e)&&(this.left.delete(e),this.right.delete(t))},t.prototype.getKey=function(t){return this.right.get(t)},t.prototype.hasValue=function(t){return this.right.has(t)},t}();e.WeakBiMap=o},function(t,e){/*! @source http://purl.eligrey.com/github/classList.js/blob/master/classList.js*/
"document"in window.self&&("classList"in document.createElement("_")&&(!document.createElementNS||"classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))?!function(){"use strict";var t=document.createElement("_");if(t.classList.add("c1","c2"),!t.classList.contains("c2")){var e=function(t){var e=DOMTokenList.prototype[t];DOMTokenList.prototype[t]=function(t){var n,r=arguments.length;for(n=0;n<r;n++)t=arguments[n],e.call(this,t)}};e("add"),e("remove")}if(t.classList.toggle("c3",!1),t.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(t,e){return 1 in arguments&&!this.contains(t)==!e?e:n.call(this,t)}}t=null}():!function(t){"use strict";if("Element"in t){var e="classList",n="prototype",r=t.Element[n],o=Object,i=String[n].trim||function(){return this.replace(/^\s+|\s+$/g,"")},a=Array[n].indexOf||function(t){for(var e=0,n=this.length;e<n;e++)if(e in this&&this[e]===t)return e;return-1},s=function(t,e){this.name=t,this.code=DOMException[t],this.message=e},u=function(t,e){if(""===e)throw new s("SYNTAX_ERR","An invalid or illegal string was specified");if(/\s/.test(e))throw new s("INVALID_CHARACTER_ERR","String contains an invalid character");return a.call(t,e)},c=function(t){for(var e=i.call(t.getAttribute("class")||""),n=e?e.split(/\s+/):[],r=0,o=n.length;r<o;r++)this.push(n[r]);this._updateClassName=function(){t.setAttribute("class",this.toString())}},l=c[n]=[],f=function(){return new c(this)};if(s[n]=Error[n],l.item=function(t){return this[t]||null},l.contains=function(t){return t+="",u(this,t)!==-1},l.add=function(){var t,e=arguments,n=0,r=e.length,o=!1;do t=e[n]+"",u(this,t)===-1&&(this.push(t),o=!0);while(++n<r);o&&this._updateClassName()},l.remove=function(){var t,e,n=arguments,r=0,o=n.length,i=!1;do for(t=n[r]+"",e=u(this,t);e!==-1;)this.splice(e,1),i=!0,e=u(this,t);while(++r<o);i&&this._updateClassName()},l.toggle=function(t,e){t+="";var n=this.contains(t),r=n?e!==!0&&"remove":e!==!1&&"add";return r&&this[r](t),e===!0||e===!1?e:!n},l.toString=function(){return this.join(" ")},o.defineProperty){var p={get:f,enumerable:!0,configurable:!0};try{o.defineProperty(r,e,p)}catch(t){t.number===-2146823252&&(p.enumerable=!1,o.defineProperty(r,e,p))}}else o[n].__defineGetter__&&r.__defineGetter__(e,f)}}(window.self))},function(t,e,n){e=t.exports=n(16)(),e.push([t.i,'#contextmenu {\r\n    position: fixed;\r\n    left: 0;\r\n    top: 0;\r\n    z-index: 10000;\r\n    background-color: white;\r\n    box-shadow: 0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22);\r\n    font-family: "Segoe UI", Tahoma, Ubuntu, Cambay, Roboto, sans-serif;\r\n    font-size: 0.7em;\r\n    margin-left: 1px; /* so that the first element is not automatically selected */\r\n    border-collapse: collapse;\r\n    transform-origin: 0 0;\r\n    -moz-user-select: none;\r\n    -khtml-user-select: none;\r\n    -webkit-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n}\r\n\r\n@media only screen and (max-device-width: 400px) and (-webkit-min-device-pixel-ratio: 2) {\r\n    #contextmenu {\r\n        font-size: 1.2em;\r\n    }\r\n} \r\n\r\n#contextmenu div {\r\n    padding: 5px;\r\n    cursor: default;\r\n}\r\n\r\n#contextmenu div[disabled] {\r\n    color: grey;\r\n    /*cursor: not-allowed*/\r\n}\r\n\r\n#contextmenu div:not([disabled]):hover {\r\n    background-color: #82B1FF;\r\n    /*color: #ffffff;*/\r\n}',""])},function(t,e,n){e=t.exports=n(16)(),e.push([t.i,"\r\n#faq-card {\r\n    position: absolute;\r\n    top: 5%;\r\n    bottom: 5%;\r\n    right: 5%;\r\n    left: 5%;\r\n    width: 50%;\r\n    margin: 0 auto;\r\n    padding: 1%;\r\n    display: none;\r\n    background-color: white;\r\n    border-radius: 4px;\r\n    box-shadow: 0 19px 38px rgba(0,0,0,0.30), 0 15px 12px rgba(0,0,0,0.22);\r\n    font-family: Roboto, Calibri, Helvetica, sans-serif;\r\n    overflow-y: scroll;\r\n    transition-property: transform opacity;\r\n    transition-duration:  200ms;\r\n}\r\n\r\n@media only screen and (max-width: 1000px) {\r\n    #faq-card {\r\n        max-width: 500px;\r\n        width: 90%;\r\n    }\r\n}\r\n\r\n.cross-ball {\r\n    float: right;\r\n    height: 12mm;\r\n    width: 12mm;\r\n    line-height: 12mm;\r\n    border-radius: 50%;\r\n    background: #E91E63;\r\n    color: white;\r\n    /*font-size: 12mm;*/\r\n    font-weight: bold;\r\n    text-align: center;\r\n    /* not selectabled */\r\n    -webkit-user-select: none;\r\n    user-select: none;\r\n    cursor: pointer;\r\n}\r\n\r\n.cross-ball:hover {\r\n    filter: grayscale(0.1) opacity(0.8);\r\n    -webkit-filter: grayscale(0.1) opacity(0.8);\r\n}\r\n\r\n.question {\r\n    font-weight: bold;\r\n    display: block;\r\n    margin-top: 1%;\r\n}\r\n\r\n.answer {\r\n    display: block;\r\n    padding-bottom: 1%;\r\n    border-bottom: #cccccc 1px solid;\r\n}",""])},function(t,e,n){e=t.exports=n(16)(),e.push([t.i,".plate-box {\r\n    color: #000000;\r\n    text-anchor: end;\r\n    text-align: right;\r\n    font-family: Corbel, Candara, Calibri, Ubuntu, sans-serif;\r\n    font-weight: bold;\r\n    opacity: 1;\r\n    -webkit-user-select: none;\r\n    user-select: none;\r\n    \r\n    white-space: nowrap;\r\n    /*border-radius: 2px;*/\r\n    box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);\r\n    /*filter: url(#shadow);*/\r\n    background-color: white; /* for div */\r\n    padding: 1px 3px 1px 3px;\r\n    line-height: 1.3em;\r\n    display: inline-block;\r\n    /*float: left;*/\r\n}",""])},function(t,e,n){"use strict";var r,o=n(70),i=n(78),a=n(4),s=n(2),u=Function.prototype.bind,c=Object.defineProperty,l=Object.prototype.hasOwnProperty;r=function(t,e,n){var r,i=s(e)&&a(e.value);return r=o(e),delete r.writable,delete r.value,r.get=function(){return l.call(this,t)?i:(e.value=u.call(i,null==n?this:this[n]),c(this,t,e),this[t])},r},t.exports=function(t){var e=arguments[1];return i(t,function(t,n){return r(n,t,e)})}},function(t,e,n){"use strict";var r=n(66),o=n(2),i=Array.prototype.indexOf,a=Object.prototype.hasOwnProperty,s=Math.abs,u=Math.floor;t.exports=function(t){var e,n,c,l;if(t===t)return i.apply(this,arguments);for(n=r(o(this).length),c=arguments[1],c=isNaN(c)?0:c>=0?u(c):r(this.length)-u(s(c)),e=c;e<n;++e)if(a.call(this,e)&&(l=this[e],l!==l))return e;return-1}},function(t,e,n){"use strict";t.exports=new Function("return this")()},function(t,e,n){"use strict";t.exports=n(63)()?Math.sign:n(64)},function(t,e,n){"use strict";t.exports=function(){var t=Math.sign;return"function"==typeof t&&(1===t(10)&&t(-20)===-1)}},function(t,e,n){"use strict";t.exports=function(t){return t=Number(t),isNaN(t)||0===t?t:t>0?1:-1}},function(t,e,n){"use strict";var r=n(62),o=Math.abs,i=Math.floor;t.exports=function(t){return isNaN(t)?0:(t=Number(t),0!==t&&isFinite(t)?r(t)*i(o(t)):t)}},function(t,e,n){"use strict";var r=n(65),o=Math.max;t.exports=function(t){return o(0,r(t))}},function(t,e,n){"use strict";var r=n(4),o=n(2),i=Function.prototype.bind,a=Function.prototype.call,s=Object.keys,u=Object.prototype.propertyIsEnumerable;t.exports=function(t,e){return function(n,c){var l,f=arguments[2],p=arguments[3];return n=Object(o(n)),r(c),l=s(n),p&&l.sort("function"==typeof p?i.call(p,n):void 0),"function"!=typeof t&&(t=l[t]),a.call(t,l,function(t,r){return u.call(n,t)?a.call(c,f,n[t],t,n,r):e})}}},function(t,e,n){"use strict";t.exports=function(){var t,e=Object.assign;return"function"==typeof e&&(t={foo:"raz"},e(t,{bar:"dwa"},{trzy:"trzy"}),t.foo+t.bar+t.trzy==="razdwatrzy")}},function(t,e,n){"use strict";var r=n(75),o=n(2),i=Math.max;t.exports=function(t,e){var n,a,s,u=i(arguments.length,2);for(t=Object(o(t)),s=function(r){try{t[r]=e[r]}catch(t){n||(n=t)}},a=1;a<u;++a)e=arguments[a],r(e).forEach(s);if(void 0!==n)throw n;return t}},function(t,e,n){"use strict";var r=n(18),o=n(2);t.exports=function(t){var e=Object(o(t));return e!==t?e:r({},t)}},function(t,e,n){"use strict";var r,o=Object.create;n(28)()||(r=n(29)),t.exports=function(){var t,e,n;return r?1!==r.level?o:(t={},e={},n={configurable:!1,enumerable:!1,writable:!0,value:void 0},Object.getOwnPropertyNames(Object.prototype).forEach(function(t){return"__proto__"===t?void(e[t]={configurable:!0,enumerable:!1,writable:!0,value:void 0}):void(e[t]=n)}),Object.defineProperties(t,e),Object.defineProperty(r,"nullPolyfill",{configurable:!1,enumerable:!1,writable:!1,value:t}),function(e,n){return o(null===e?t:e,n)}):o}()},function(t,e,n){"use strict";t.exports=n(67)("forEach")},function(t,e,n){"use strict";t.exports=function(t){return"function"==typeof t}},function(t,e,n){"use strict";var r={function:!0,object:!0};t.exports=function(t){return null!=t&&r[typeof t]||!1}},function(t,e,n){"use strict";t.exports=n(76)()?Object.keys:n(77)},function(t,e,n){"use strict";t.exports=function(){try{return Object.keys("primitive"),!0}catch(t){return!1}}},function(t,e,n){"use strict";var r=Object.keys;t.exports=function(t){return r(null==t?t:Object(t))}},function(t,e,n){"use strict";var r=n(4),o=n(72),i=Function.prototype.call;t.exports=function(t,e){var n={},a=arguments[2];return r(e),o(t,function(t,r,o,s){n[r]=i.call(e,a,t,r,o,s)}),n}},function(t,e,n){"use strict";var r=Array.prototype.forEach,o=Object.create,i=function(t,e){var n;for(n in t)e[n]=t[n]};t.exports=function(t){var e=o(null);return r.call(arguments,function(t){null!=t&&i(Object(t),e)}),e}},function(t,e,n){"use strict";var r="razdwatrzy";t.exports=function(){return"function"==typeof r.contains&&(r.contains("dwa")===!0&&r.contains("foo")===!1)}},function(t,e,n){"use strict";var r=String.prototype.indexOf;t.exports=function(t){return r.call(this,t,arguments[1])>-1}},function(t,e,n){"use strict";var r,o=n(10),i=n(19),a=n(3),s=n(21),u=Object.defineProperty;r=t.exports=function(t,e){return this instanceof r?(s.call(this,t),e=e?i.call(e,"key+value")?"key+value":i.call(e,"key")?"key":"value":"value",void u(this,"__kind__",a("",e))):new r(t,e)},o&&o(r,s),r.prototype=Object.create(s.prototype,{constructor:a(r),_resolve:a(function(t){return"value"===this.__kind__?this.__list__[t]:"key+value"===this.__kind__?[t,this.__list__[t]]:t}),toString:a(function(){return"[object Array Iterator]"})})},function(t,e,n){"use strict";var r=n(17),o=n(4),i=n(20),a=n(84),s=Array.isArray,u=Function.prototype.call,c=Array.prototype.some;t.exports=function(t,e){var n,l,f,p,d,h,m,v,g=arguments[2];if(s(t)||r(t)?n="array":i(t)?n="string":t=a(t),o(e),f=function(){p=!0},"array"===n)return void c.call(t,function(t){if(u.call(e,g,t,f),p)return!0});if("string"!==n)for(l=t.next();!l.done;){if(u.call(e,g,l.value,f),p)return;l=t.next()}else for(h=t.length,d=0;d<h&&(m=t[d],d+1<h&&(v=m.charCodeAt(0),v>=55296&&v<=56319&&(m+=t[++d])),u.call(e,g,m,f),!p);++d);}},function(t,e,n){"use strict";var r=n(17),o=n(20),i=n(82),a=n(86),s=n(30),u=n(6).iterator;t.exports=function(t){return"function"==typeof s(t)[u]?t[u]():r(t)?new i(t):o(t)?new a(t):new i(t)}},function(t,e,n){"use strict";var r=n(17),o=n(20),i=n(6).iterator,a=Array.isArray;t.exports=function(t){return null!=t&&(!!a(t)||(!!o(t)||(!!r(t)||"function"==typeof t[i])))}},function(t,e,n){"use strict";var r,o=n(10),i=n(3),a=n(21),s=Object.defineProperty;r=t.exports=function(t){return this instanceof r?(t=String(t),a.call(this,t),void s(this,"__length__",i("",t.length))):new r(t)},o&&o(r,a),r.prototype=Object.create(a.prototype,{constructor:i(r),_next:i(function(){if(this.__list__)return this.__nextIndex__<this.__length__?this.__nextIndex__++:void this._unBind()}),_resolve:i(function(t){var e,n=this.__list__[t];return this.__nextIndex__===this.__length__?n:(e=n.charCodeAt(0),e>=55296&&e<=56319?n+this.__list__[this.__nextIndex__++]:n)}),toString:i(function(){return"[object String Iterator]"})})},function(t,e,n){(function(e,r){/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   4.0.5
 */
!function(e,n){t.exports=n()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function o(t){return"function"==typeof t}function i(t){H=t}function a(t){Y=t}function s(){return function(){return e.nextTick(p)}}function u(){return"undefined"!=typeof K?function(){K(p)}:f()}function c(){var t=0,e=new $(p),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function l(){var t=new MessageChannel;return t.port1.onmessage=p,function(){return t.port2.postMessage(0)}}function f(){var t=setTimeout;return function(){return t(p,1)}}function p(){for(var t=0;t<J;t+=2){var e=nt[t],n=nt[t+1];e(n),nt[t]=void 0,nt[t+1]=void 0}J=0}function d(){try{var t=n(103);return K=t.runOnLoop||t.runOnContext,u()}catch(t){return f()}}function h(t,e){var n=arguments,r=this,o=new this.constructor(v);void 0===o[ot]&&N(o);var i=r._state;return i?!function(){var t=n[i-1];Y(function(){return P(i,o,t,r._result)})}():O(r,o,t,e),o}function m(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(v);return S(n,t),n}function v(){}function g(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function b(t){try{return t.then}catch(t){return ut.error=t,ut}}function _(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function w(t,e,n){Y(function(t){var r=!1,o=_(n,e,function(n){r||(r=!0,e!==n?S(t,n):M(t,n))},function(e){r||(r=!0,E(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,E(t,o))},t)}function x(t,e){e._state===at?M(t,e._result):e._state===st?E(t,e._result):O(e,void 0,function(e){return S(t,e)},function(e){return E(t,e)})}function k(t,e,n){e.constructor===t.constructor&&n===h&&e.constructor.resolve===m?x(t,e):n===ut?E(t,ut.error):void 0===n?M(t,e):o(n)?w(t,e,n):M(t,e)}function S(e,n){e===n?E(e,g()):t(n)?k(e,n,b(n)):M(e,n)}function L(t){t._onerror&&t._onerror(t._result),T(t)}function M(t,e){t._state===it&&(t._result=e,t._state=at,0!==t._subscribers.length&&Y(T,t))}function E(t,e){t._state===it&&(t._state=st,t._result=e,Y(L,t))}function O(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+at]=n,o[i+st]=r,0===i&&t._state&&Y(T,t)}function T(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,a=0;a<e.length;a+=3)r=e[a],o=e[a+n],r?P(n,r,o,i):o(i);t._subscribers.length=0}}function C(){this.error=null}function A(t,e){try{return t(e)}catch(t){return ct.error=t,ct}}function P(t,e,n,r){var i=o(n),a=void 0,s=void 0,u=void 0,c=void 0;if(i){if(a=A(n,r),a===ct?(c=!0,s=a.error,a=null):u=!0,e===a)return void E(e,y())}else a=r,u=!0;e._state!==it||(i&&u?S(e,a):c?E(e,s):t===at?M(e,a):t===st&&E(e,a))}function j(t,e){try{e(function(e){S(t,e)},function(e){E(t,e)})}catch(e){E(t,e)}}function B(){return lt++}function N(t){t[ot]=lt++,t._state=void 0,t._result=void 0,t._subscribers=[]}function I(t,e){this._instanceConstructor=t,this.promise=new t(v),this.promise[ot]||N(this.promise),Z(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&M(this.promise,this._result))):E(this.promise,R())}function R(){return new Error("Array Methods must be provided an Array")}function F(t){return new I(this,t).promise}function z(t){var e=this;return new e(Z(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function D(t){var e=this,n=new e(v);return E(n,t),n}function G(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function W(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function V(t){this[ot]=B(),this._result=this._state=void 0,this._subscribers=[],v!==t&&("function"!=typeof t&&G(),this instanceof V?j(this,t):W())}function U(){var t=void 0;if("undefined"!=typeof r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=V}var q=void 0;q=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var Z=q,J=0,K=void 0,H=void 0,Y=function(t,e){nt[J]=t,nt[J+1]=e,J+=2,2===J&&(H?H(p):rt())},Q="undefined"!=typeof window?window:void 0,X=Q||{},$=X.MutationObserver||X.WebKitMutationObserver,tt="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),et="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,nt=new Array(1e3),rt=void 0;rt=tt?s():$?c():et?l():void 0===Q?d():f();var ot=Math.random().toString(36).substring(16),it=void 0,at=1,st=2,ut=new C,ct=new C,lt=0;return I.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===it&&n<t;n++)this._eachEntry(e[n],n)},I.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===m){var o=b(t);if(o===h&&t._state!==it)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===V){var i=new n(v);k(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},I.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===it&&(this._remaining--,t===st?E(r,n):this._result[e]=n),0===this._remaining&&M(r,this._result)},I.prototype._willSettleAt=function(t,e){var n=this;O(t,void 0,function(t){return n._settledAt(at,e,t)},function(t){return n._settledAt(st,e,t)})},V.all=F,V.race=z,V.resolve=m,V.reject=D,V._setScheduler=i,V._setAsap=a,V._asap=Y,V.prototype={constructor:V,then:h,catch:function(t){return this.then(null,t)}},V.polyfill=U,V.Promise=V,V})}).call(e,n(98),n(31))},function(t,e,n){"use strict";n(89)()||Object.defineProperty(n(61),"Set",{value:n(92),configurable:!0,enumerable:!1,writable:!0})},function(t,e,n){"use strict";t.exports=function(){var t,e,n;return"function"==typeof Set&&(t=new Set(["raz","dwa","trzy"]),"[object Set]"===String(t)&&(3===t.size&&("function"==typeof t.add&&("function"==typeof t.clear&&("function"==typeof t.delete&&("function"==typeof t.entries&&("function"==typeof t.forEach&&("function"==typeof t.has&&("function"==typeof t.keys&&("function"==typeof t.values&&(e=t.values(),n=e.next(),n.done===!1&&"raz"===n.value)))))))))))}},function(t,e,n){"use strict";t.exports=function(){return"undefined"!=typeof Set&&"[object Set]"===Object.prototype.toString.call(Set.prototype)}()},function(t,e,n){"use strict";var r,o=n(10),i=n(19),a=n(3),s=n(21),u=n(6).toStringTag,c=Object.defineProperty;r=t.exports=function(t,e){return this instanceof r?(s.call(this,t.__setData__,t),e=e&&i.call(e,"key+value")?"key+value":"value",void c(this,"__kind__",a("",e))):new r(t,e)},o&&o(r,s),r.prototype=Object.create(s.prototype,{constructor:a(r),_resolve:a(function(t){return"value"===this.__kind__?this.__list__[t]:[this.__list__[t],this.__list__[t]]}),toString:a(function(){return"[object Set Iterator]"})}),c(r.prototype,u,a("c","Set Iterator"))},function(t,e,n){"use strict";var r,o,i,a=n(27),s=n(60),u=n(10),c=n(4),l=n(3),f=n(97),p=n(6),d=n(30),h=n(83),m=n(91),v=n(90),g=Function.prototype.call,y=Object.defineProperty,b=Object.getPrototypeOf;v&&(i=Set),t.exports=r=function(){var t,e=arguments[0];if(!(this instanceof r))throw new TypeError("Constructor requires 'new'");return t=v&&u?u(new i,b(this)):this,null!=e&&d(e),y(t,"__setData__",l("c",[])),e?(h(e,function(t){s.call(this,t)===-1&&this.push(t)},t.__setData__),t):t},v&&(u&&u(r,i),r.prototype=Object.create(i.prototype,{constructor:l(r)})),f(Object.defineProperties(r.prototype,{add:l(function(t){return this.has(t)?this:(this.emit("_add",this.__setData__.push(t)-1,t),this)}),clear:l(function(){this.__setData__.length&&(a.call(this.__setData__),this.emit("_clear"))}),delete:l(function(t){var e=s.call(this.__setData__,t);return e!==-1&&(this.__setData__.splice(e,1),this.emit("_delete",e,t),!0)}),entries:l(function(){return new m(this,"key+value")}),forEach:l(function(t){var e,n,r,o=arguments[1];for(c(t),e=this.values(),n=e._next();void 0!==n;)r=e._resolve(n),g.call(t,o,r,r,this),n=e._next()}),has:l(function(t){return s.call(this.__setData__,t)!==-1}),keys:l(o=function(){return this.values()}),size:l.gs(function(){return this.__setData__.length}),values:l(function(){return new m(this)}),toString:l(function(){return"[object Set]"})})),y(r.prototype,p.iterator,l(o)),y(r.prototype,p.toStringTag,l("c","Set"))},function(t,e,n){"use strict";var r={object:!0,symbol:!0};t.exports=function(){var t;if("function"!=typeof Symbol)return!1;t=Symbol("test symbol");try{String(t)}catch(t){return!1}return!!r[typeof Symbol.iterator]&&(!!r[typeof Symbol.toPrimitive]&&!!r[typeof Symbol.toStringTag])}},function(t,e,n){"use strict";t.exports=function(t){return!!t&&("symbol"==typeof t||!!t.constructor&&("Symbol"===t.constructor.name&&"Symbol"===t[t.constructor.toStringTag]))}},function(t,e,n){"use strict";var r,o,i,a,s=n(3),u=n(96),c=Object.create,l=Object.defineProperties,f=Object.defineProperty,p=Object.prototype,d=c(null);if("function"==typeof Symbol){r=Symbol;try{String(r()),a=!0}catch(t){}}var h=function(){var t=c(null);return function(e){for(var n,r,o=0;t[e+(o||"")];)++o;return e+=o||"",t[e]=!0,n="@@"+e,f(p,n,s.gs(null,function(t){r||(r=!0,f(this,n,s(t)),r=!1)})),n}}();i=function(t){if(this instanceof i)throw new TypeError("TypeError: Symbol is not a constructor");return o(t)},t.exports=o=function t(e){var n;if(this instanceof t)throw new TypeError("TypeError: Symbol is not a constructor");return a?r(e):(n=c(i.prototype),e=void 0===e?"":String(e),l(n,{__description__:s("",e),__name__:s("",h(e))}))},l(o,{for:s(function(t){return d[t]?d[t]:d[t]=o(String(t))}),keyFor:s(function(t){var e;u(t);for(e in d)if(d[e]===t)return e}),hasInstance:s("",r&&r.hasInstance||o("hasInstance")),isConcatSpreadable:s("",r&&r.isConcatSpreadable||o("isConcatSpreadable")),iterator:s("",r&&r.iterator||o("iterator")),match:s("",r&&r.match||o("match")),replace:s("",r&&r.replace||o("replace")),search:s("",r&&r.search||o("search")),species:s("",r&&r.species||o("species")),split:s("",r&&r.split||o("split")),toPrimitive:s("",r&&r.toPrimitive||o("toPrimitive")),toStringTag:s("",r&&r.toStringTag||o("toStringTag")),unscopables:s("",r&&r.unscopables||o("unscopables"))}),l(i.prototype,{constructor:s(o),toString:s("",function(){return this.__name__})}),l(o.prototype,{toString:s(function(){return"Symbol ("+u(this).__description__+")"}),valueOf:s(function(){return u(this)})}),f(o.prototype,o.toPrimitive,s("",function(){var t=u(this);return"symbol"==typeof t?t:t.toString()})),f(o.prototype,o.toStringTag,s("c","Symbol")),f(i.prototype,o.toStringTag,s("c",o.prototype[o.toStringTag])),f(i.prototype,o.toPrimitive,s("c",o.prototype[o.toPrimitive]))},function(t,e,n){"use strict";var r=n(94);t.exports=function(t){if(!r(t))throw new TypeError(t+" is not a symbol");return t}},function(t,e,n){"use strict";var r,o,i,a,s,u,c,l=n(3),f=n(4),p=Function.prototype.apply,d=Function.prototype.call,h=Object.create,m=Object.defineProperty,v=Object.defineProperties,g=Object.prototype.hasOwnProperty,y={configurable:!0,enumerable:!1,writable:!0};r=function(t,e){var n;return f(e),g.call(this,"__ee__")?n=this.__ee__:(n=y.value=h(null),m(this,"__ee__",y),y.value=null),n[t]?"object"==typeof n[t]?n[t].push(e):n[t]=[n[t],e]:n[t]=e,this},o=function(t,e){var n,o;return f(e),o=this,r.call(this,t,n=function(){i.call(o,t,n),p.call(e,this,arguments)}),n.__eeOnceListener__=e,this},i=function(t,e){var n,r,o,i;if(f(e),!g.call(this,"__ee__"))return this;if(n=this.__ee__,!n[t])return this;if(r=n[t],"object"==typeof r)for(i=0;o=r[i];++i)o!==e&&o.__eeOnceListener__!==e||(2===r.length?n[t]=r[i?0:1]:r.splice(i,1));else r!==e&&r.__eeOnceListener__!==e||delete n[t];return this},a=function(t){var e,n,r,o,i;if(g.call(this,"__ee__")&&(o=this.__ee__[t]))if("object"==typeof o){for(n=arguments.length,i=new Array(n-1),e=1;e<n;++e)i[e-1]=arguments[e];for(o=o.slice(),e=0;r=o[e];++e)p.call(r,this,i)}else switch(arguments.length){case 1:d.call(o,this);break;case 2:d.call(o,this,arguments[1]);break;case 3:d.call(o,this,arguments[1],arguments[2]);break;default:for(n=arguments.length,i=new Array(n-1),e=1;e<n;++e)i[e-1]=arguments[e];p.call(o,this,i)}},s={on:r,once:o,off:i,emit:a},u={on:l(r),once:l(o),off:l(i),emit:l(a)},c=v({},u),t.exports=e=function(t){return null==t?h(c):v(Object(t),u)},e.methods=s},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function i(t){if(f===clearTimeout)return clearTimeout(t);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function a(){m&&d&&(m=!1,d.length?h=d.concat(h):v=-1,h.length&&s())}function s(){if(!m){var t=o(a);m=!0;for(var e=h.length;e;){for(d=h,h=[];++v<e;)d&&d[v].run();v=-1,e=h.length}d=null,m=!1,i(t)}}function u(t,e){this.fun=t,this.array=e}function c(){}var l,f,p=t.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:n}catch(t){l=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(t){f=r}}();var d,h=[],m=!1,v=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];h.push(new u(t,e)),1!==h.length||m||o(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=c,p.addListener=c,p.once=c,p.off=c,p.removeListener=c,p.removeAllListeners=c,p.emit=c,p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e,n){var r=n(56);"string"==typeof r&&(r=[[t.i,r,""]]);n(22)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){var r=n(57);"string"==typeof r&&(r=[[t.i,r,""]]);n(22)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){var r=n(58);"string"==typeof r&&(r=[[t.i,r,""]]);n(22)(r,{});r.locals&&(t.exports=r.locals)},,function(t,e){},function(t,e,n){"use strict";var r=this&&this.__awaiter||function(t,e,n,r){return new(n||(n=Promise))(function(o,i){function a(t){try{u(r.next(t))}catch(t){i(t)}}function s(t){try{u(r.throw(t))}catch(t){i(t)}}function u(t){t.done?o(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e)).next())})},o=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},i=this,a=n(8),s=n(5),u=n(32);L.Icon.Default.imagePath="http://cdn.leafletjs.com/leaflet/v0.7.7/images",L.Browser.ie&&alert("Does not work in IE (yet)");var c=n(23);c.default();var l=window.location.search.match(/city=(\w+)/),f=l?l[1]:"spb";!function(){return r(i,void 0,void 0,function(){var t,e,n,r,i;return o(this,function(o){switch(o.label){case 0:return[4,a.getConfig()];case 1:for(t=o.sent(),e=s.updateDictionary(t.url.dictionary),n=0,r=Object.keys(t.url);n<r.length;n++)i=r[n],t.url[i]=t.url[i].replace(/\{city\}/g,f);return document.title=s.translate(("moscow"===f?"Moscow":"St Petersburg")+" metro plan proposal"),[4,e];case 2:return o.sent(),document.title=s.translate(document.title),new u.default(t),[2]}})})}()}],[104]);