webpackJsonp([0],[function(t,e,r){"use strict";(function(t){function n(t,e){var r=t.size;if(r!==e.size)return!1;for(var n=t.values(),o=n.next();!o.done;o=n.next())if(!e.has(o.value))return!1;return!0}function o(t,e){var r=new Set;return t.forEach(function(t){e.has(t)&&r.add(t)}),r}function i(t,e){var r=t.indexOf(e);r<0||(t[r]=t[t.length-1],t.pop())}function a(t){for(var e=t.toString(),r=e.length%3,n=r>0?[e.slice(0,r)]:[],o=e.length%3;o<e.length;o+=3)n.push(e.substr(o,3));return n.join("'")}function s(t,e){return O.point(+t.x.toFixed(e),+t.y.toFixed(e))}function u(t,e){return void 0===e&&(e=10),t.toString(e).split(".")[1]||"0"}function l(t){var e=Math.random().toString(36).slice(2);return t&&t(e)?l(t):e}function c(t,e){var r=t.getContainer().getBoundingClientRect(),n=O.point(e.clientX-r.left,e.clientY-r.top);return t.containerPointToLatLng(n)}function f(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t?t.apply(void 0,e):void 0}function d(t,e,r){t.addEventListener(e,function n(o){t.removeEventListener(e,n),r(o)})}function h(t){function e(){removeEventListener("keydown",r),removeEventListener("backbutton",n)}var r=function(r){27===r.keyCode&&(e(),t(r))},n=function(r){e(),t(r)};addEventListener("keydown",r),addEventListener("backbutton",n)}function p(){for(var t=document.querySelectorAll(U),e=0;e<t.length;++e){var r=t[e];r.style.opacity=null,"t"!==r.id[1]&&(r.style.filter=null)}}function m(t,e){var r=document.createEvent("MouseEvents");r.initEvent(e,!0,!0),t.dispatchEvent(r)}function v(t){var e=t.name,r=t.altNames,n=M(),o=[e];return n&&r[n]&&o.push(r[n]),r.en&&o.push(r.en),o}function g(t){var e=t.map(v);return console.log("pl",e),[0,1,2].map(function(r){return t.map(function(t,n){return e[n][r]})}).map(function(t){return B.uniq(t).reduce(function(t,e){return t+" / "+e})}).filter(function(t){return void 0!==t})}function y(t,e){var r=e.map(function(e){return t.distanceTo(e)}),n=e[1].subtract(e[0]).multiplyBy(r[0]/(r[0]+r[1])).add(e[0]),o=t.subtract(n);return e.map(function(t){return s(t.add(o),2)})}function b(t){var e=t.style,r=e.transform;r&&(e.transform=r.replace(/translate3d\s*\((.+?,\s*.+?),\s*.+?\s*\)/i,"translate($1)"))}function w(t,e){var r=0;setInterval(function(){return document.title=t[++r%t.length]},e)}function _(t,e,r){var n=t.getBoundingClientRect();if(!r){var o=document.documentElement;r=O.point(o.clientWidth/2,o.clientHeight/2)}var i=O.point(r.x-n.left,r.y-n.top),a=O.point(i.x/n.width,i.y/n.height),s=t.style;s.transformOrigin=100*a.x+"% "+100*a.y+"%",s.transform="scale("+e+")"}function x(t,r,n,o){return void 0===n&&(n=100),void 0===o&&(o=100),T(this,void 0,void 0,function(){var i,a;return C(this,function(s){switch(s.label){case 0:i=0,s.label=1;case 1:return i<o?(a=t(),!r||r(a)?[2,a]:[4,e.delay(n)]):[3,4];case 2:s.sent(),s.label=3;case 3:return++i,[3,1];case 4:throw new Error("rejected")}})})}function k(t,e,r){void 0===e&&(e=100),void 0===r&&(r=100);var n=t.slice(1),o="#"===t[0]?function(){return document.getElementById(n)}:function(){return document.querySelector(t)};return x(o,function(t){return null!==t},e,r)}function L(t){for(var e;e=t.firstChild;)t.removeChild(e)}function E(t){void 0===t&&(t=document);var e=t.querySelectorAll('[style*="translate3d"]');console.log("fixing font",t,e);for(var r=0,n=e;r<n.length;r++){var o=n[r];b(o)}}function M(){var t=window.location.search.match(/city=(\w+)/),e=t?t[1]:"spb",r={spb:"fi",qazan:"tt",helsinki:"se"};return r[e]}function S(t,e){var r=t.get(e);if(void 0===r)throw console.error("in map",t,":",e,"->",r),new Error("key or val is undefined");return r}function A(t){var e=document.getElementById(t);if(!e)throw new Error("no element with id="+t+" exists");return e}var T=this&&this.__awaiter||function(e,r,n,o){return new(n||(n=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new n(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,r||[])).next())})},C=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){s.label=r[1];break}if(6===r[0]&&s.label<a[1]){s.label=a[1],a=r;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(r);break}a[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}},O=r(1),B=r(3),P=r(37);e.algorithm=P;var j=r(39);e.decorators=j;var R=r(10);e.geo=R;var F=r(11);e.math=F;var I=r(36);e.Mediator=I.default;var N=r(41);e.sfx=N;var G=r(12);e.svg=G;var D=r(40);e.file=D;var z=r(38);e.color=z;var U=["paths-inner","paths-outer","transfers-inner","transfers-outer","station-circles"].map(function(t){return"#"+t+" > *"}).join(", ");e.setsEqual=n,e.intersection=o,e.deleteFromArray=i,e.formatInteger=a,e.roundPoint=s,e.getFraction=u,e.generateId=l,e.mouseToLatLng=c,e.callMeMaybe=f,e.once=d,e.onceEscapePress=h,e.resetStyle=p,e.triggerMouseEvent=m,e.getPlatformNames=v,e.getPlatformNamesZipped=g,e.midPointsToEnds=y,e.trim3d=b,e.flashTitle=w,e.scaleOverlay=_,e.delay=function(e){return new t(function(t,r){return setTimeout(t,e)})},e.tryGet=x,e.tryGetElement=k,e.removeAllChildren=L,e.fixFontRendering=E,e.getSecondLanguage=M,e.tryGetFromMap=S,e.byId=A}).call(e,r(2))},,function(t,e,r){(function(e,n,o){!function(e,r){t.exports=r()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function n(t){return"function"==typeof t}function i(t){H=t}function a(t){Q=t}function s(){return function(){return e.nextTick(d)}}function u(){return"undefined"!=typeof Z?function(){Z(d)}:f()}function l(){var t=0,e=new $(d),r=document.createTextNode("");return e.observe(r,{characterData:!0}),function(){r.data=t=++t%2}}function c(){var t=new MessageChannel;return t.port1.onmessage=d,function(){return t.port2.postMessage(0)}}function f(){var t=setTimeout;return function(){return t(d,1)}}function d(){for(var t=0;t<K;t+=2){var e=rt[t],r=rt[t+1];e(r),rt[t]=void 0,rt[t+1]=void 0}K=0}function h(){try{var t=r(56);return Z=t.runOnLoop||t.runOnContext,u()}catch(t){return f()}}function p(t,e){var r=arguments,n=this,o=new this.constructor(v);void 0===o[ot]&&R(o);var i=n._state;return i?!function(){var t=r[i-1];Q(function(){return B(i,o,t,n._result)})}():A(n,o,t,e),o}function m(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var r=new e(v);return L(r,t),r}function v(){}function g(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function b(t){try{return t.then}catch(t){return ut.error=t,ut}}function w(t,e,r,n){try{t.call(e,r,n)}catch(t){return t}}function _(t,e,r){Q(function(t){var n=!1,o=w(r,e,function(r){n||(n=!0,e!==r?L(t,r):M(t,r))},function(e){n||(n=!0,S(t,e))},"Settle: "+(t._label||" unknown promise"));!n&&o&&(n=!0,S(t,o))},t)}function x(t,e){e._state===at?M(t,e._result):e._state===st?S(t,e._result):A(e,void 0,function(e){return L(t,e)},function(e){return S(t,e)})}function k(t,e,r){e.constructor===t.constructor&&r===p&&e.constructor.resolve===m?x(t,e):r===ut?S(t,ut.error):void 0===r?M(t,e):n(r)?_(t,e,r):M(t,e)}function L(e,r){e===r?S(e,g()):t(r)?k(e,r,b(r)):M(e,r)}function E(t){t._onerror&&t._onerror(t._result),T(t)}function M(t,e){t._state===it&&(t._result=e,t._state=at,0!==t._subscribers.length&&Q(T,t))}function S(t,e){t._state===it&&(t._state=st,t._result=e,Q(E,t))}function A(t,e,r,n){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+at]=r,o[i+st]=n,0===i&&t._state&&Q(T,t)}function T(t){var e=t._subscribers,r=t._state;if(0!==e.length){for(var n=void 0,o=void 0,i=t._result,a=0;a<e.length;a+=3)n=e[a],o=e[a+r],n?B(r,n,o,i):o(i);t._subscribers.length=0}}function C(){this.error=null}function O(t,e){try{return t(e)}catch(t){return lt.error=t,lt}}function B(t,e,r,o){var i=n(r),a=void 0,s=void 0,u=void 0,l=void 0;if(i){if(a=O(r,o),a===lt?(l=!0,s=a.error,a=null):u=!0,e===a)return void S(e,y())}else a=o,u=!0;e._state!==it||(i&&u?L(e,a):l?S(e,s):t===at?M(e,a):t===st&&S(e,a))}function P(t,e){try{e(function(e){L(t,e)},function(e){S(t,e)})}catch(e){S(t,e)}}function j(){return ct++}function R(t){t[ot]=ct++,t._state=void 0,t._result=void 0,t._subscribers=[]}function F(t,e){this._instanceConstructor=t,this.promise=new t(v),this.promise[ot]||R(this.promise),J(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&M(this.promise,this._result))):S(this.promise,I())}function I(){return new Error("Array Methods must be provided an Array")}function N(t){return new F(this,t).promise}function G(t){var e=this;return new e(J(t)?function(r,n){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(r,n)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function D(t){var e=this,r=new e(v);return S(r,t),r}function z(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function U(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function V(t){this[ot]=j(),this._result=this._state=void 0,this._subscribers=[],v!==t&&("function"!=typeof t&&z(),this instanceof V?P(this,t):U())}function W(){var t=void 0;if("undefined"!=typeof o)t=o;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===r&&!e.cast)return}t.Promise=V}var q=void 0;q=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var J=q,K=0,Z=void 0,H=void 0,Q=function(t,e){rt[K]=t,rt[K+1]=e,K+=2,2===K&&(H?H(d):nt())},Y="undefined"!=typeof window?window:void 0,X=Y||{},$=X.MutationObserver||X.WebKitMutationObserver,tt="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),et="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,rt=new Array(1e3),nt=void 0;nt=tt?s():$?l():et?c():void 0===Y?h():f();var ot=Math.random().toString(36).substring(16),it=void 0,at=1,st=2,ut=new C,lt=new C,ct=0;return F.prototype._enumerate=function(){for(var t=this.length,e=this._input,r=0;this._state===it&&r<t;r++)this._eachEntry(e[r],r)},F.prototype._eachEntry=function(t,e){var r=this._instanceConstructor,n=r.resolve;if(n===m){var o=b(t);if(o===p&&t._state!==it)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(r===V){var i=new r(v);k(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new r(function(e){return e(t)}),e)}else this._willSettleAt(n(t),e)},F.prototype._settledAt=function(t,e,r){var n=this.promise;n._state===it&&(this._remaining--,t===st?S(n,r):this._result[e]=r),0===this._remaining&&M(n,this._result)},F.prototype._willSettleAt=function(t,e){var r=this;A(t,void 0,function(t){return r._settledAt(at,e,t)},function(t){return r._settledAt(st,e,t)})},V.all=N,V.race=G,V.resolve=m,V.reject=D,V._setScheduler=i,V._setAsap=a,V._asap=Q,V.prototype={constructor:V,then:p,catch:function(t){return this.then(null,t)}},V.polyfill=W,V.Promise=V,V})}).call(e,r(49),r(2),r(13))},,function(t,e,r){"use strict";(function(t){function n(t){return u(this,void 0,void 0,function(){var r,n,o,i,a,s;return l(this,function(u){switch(u.label){case 0:return[4,c.getJSON(t)];case 1:for(r=u.sent(),n=Object.keys(r),o=0,i=n;o<i.length;o++)a=i[o],s=r[a],f.set(a.toLowerCase(),e.userLanguage in s?s[e.userLanguage]:a);return d=new RegExp(n.join("|"),"ig"),[2]}})})}function o(t){var e=f.get(t.toLowerCase());return void 0===e?t:t.toUpperCase()===t?e.toUpperCase():e}function i(t){for(var e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];return t.map(function(t){return t.replace(d,o)}).map(function(t,r){return t+(e[r]||"")}).join("")}function a(t,r){return 0===t?"":""+t+(t>1&&"en"===e.userLanguage?r+"s":r)}function s(t){if(void 0===t)return"";if(t<60)return Math.round(t)+" seconds";if(t<3570){var e=Math.round(t/60);return a(e,"min")}var r=Math.floor(t/3600),n=Math.floor((t-3600*r)/60);return(r>0?r+(o=["%hour%"],o.raw=["%hour%"],i(o)):"")+" "+a(n,"min");var o}var u=this&&this.__awaiter||function(e,r,n,o){return new(n||(n=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new n(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,r||[])).next())})},l=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){s.label=r[1];break}if(6===r[0]&&s.label<a[1]){s.label=a[1],a=r;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(r);break}a[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}},c=r(7);e.userLanguage=navigator.language.slice(0,2).toLowerCase();var f=new Map,d=new RegExp(Object.keys(f).join("|"),"ig");e.updateDictionary=n,e.translate=o,e.tr=i,e.formatTime=s}).call(e,r(2))},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var r=this[e];r[2]?t.push("@media "+r[2]+"{"+r[1]+"}"):t.push(r[1])}return t.join("")},t.i=function(e,r){"string"==typeof e&&(e=[[null,e,""]]);for(var n={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(n[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&n[a[0]]||(r&&!a[2]?a[2]=r:r&&(a[2]="("+a[2]+") and ("+r+")"),t.push(a))}},t}},function(t,e){function r(t,e){for(var r=0;r<t.length;r++){var n=t[r],o=d[n.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](n.parts[i]);for(;i<n.parts.length;i++)o.parts.push(u(n.parts[i],e))}else{for(var a=[],i=0;i<n.parts.length;i++)a.push(u(n.parts[i],e));d[n.id]={id:n.id,refs:1,parts:a}}}}function n(t){for(var e=[],r={},n=0;n<t.length;n++){var o=t[n],i=o[0],a=o[1],s=o[2],u=o[3],l={css:a,media:s,sourceMap:u};r[i]?r[i].parts.push(l):e.push(r[i]={id:i,parts:[l]})}return e}function o(t,e){var r=m(),n=y[y.length-1];if("top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");r.appendChild(e)}}function i(t){t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function a(t){var e=document.createElement("style");return e.type="text/css",o(t,e),e}function s(t){var e=document.createElement("link");return e.rel="stylesheet",o(t,e),e}function u(t,e){var r,n,o;if(e.singleton){var u=g++;r=v||(v=a(e)),n=l.bind(null,r,u,!1),o=l.bind(null,r,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=s(e),n=f.bind(null,r),o=function(){i(r),r.href&&URL.revokeObjectURL(r.href)}):(r=a(e),n=c.bind(null,r),o=function(){i(r)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else o()}}function l(t,e,r,n){var o=r?"":n.css;if(t.styleSheet)t.styleSheet.cssText=b(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function c(t,e){var r=e.css,n=e.media;if(n&&t.setAttribute("media",n),t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}function f(t,e){var r=e.css,n=e.sourceMap;n&&(r+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(n))))+" */");var o=new Blob([r],{type:"text/css"}),i=t.href;t.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var d={},h=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},p=h(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),m=h(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,g=0,y=[];t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");e=e||{},"undefined"==typeof e.singleton&&(e.singleton=p()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var o=n(t);return r(o,e),function(t){for(var i=[],a=0;a<o.length;a++){var s=o[a],u=d[s.id];u.refs--,i.push(u)}if(t){var l=n(t);r(l,e)}for(var a=0;a<i.length;a++){var u=i[a];if(0===u.refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete d[u.id]}}}};var b=function(){var t=[];return function(e,r){return t[e]=r,t.filter(Boolean).join("\n")}}()},function(t,e,r){"use strict";(function(t,n){function o(){for(var t=document.styleSheets,e="",r=0,n=t.length;r<n;++r){var o=t[r];console.log(o.cssText);var i=o.cssRules;if(i)for(var a=0;a<i.length;++a)e+=i[a].cssText;else console.log(o)}return console.log("css text ready"),e}function i(){return a(this,void 0,void 0,function(){var t,e,r,n,o,i,a;return s(this,function(s){switch(s.label){case 0:return t=document.getElementById("scheme"),[4,u.tryGet(function(){return t.sheet},function(t){return null!==t})];case 1:for(e=s.sent(),r=new Map,n=0,o=e.cssRules;n<o.length;n++)i=o[n],i instanceof CSSStyleRule&&(a=i.selectorText.match(/^.(M\d+|L|E)$/),a&&a[1]?r.set(a[1],i.style):"#paths-outer > .L"===i.selectorText&&r.set("light-rail-path",i.style));return console.log(r),[2,r]}})})}var a=this&&this.__awaiter||function(e,r,n,o){return new(n||(n=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new n(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,r||[])).next())})},s=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){s.label=r[1];break}if(6===r[0]&&s.label<a[1]){s.label=a[1],a=r;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(r);break}a[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}},u=r(0);e.getJSON=function(t){return n(t).then(function(t){return t.json()})},e.getContent=function(t){return n(t).then(function(t){return t.text()})},e.getConfig=function(){return n("res/mapconfig.json").then(function(t){return t.json()})},e.getStyleRulesAsText=o,e.getLineRules=i}).call(e,r(2),r(19))},,function(t,e,r){"use strict";var n=function(){function t(t,e){if(t===e)throw new Error("source is the same as target: "+t);this._source=t,this._target=e}return Object.defineProperty(t.prototype,"source",{get:function(){return this._source},set:function(t){this._source=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),t.prototype.isOf=function(t,e){return this._source===t&&this._target===e||this._source===e&&this._target===t},t.prototype.has=function(t){return this._source===t||this._target===t},t.prototype.other=function(t){if(this._source===t)return this._target;if(this._target===t)return this._source;throw new Error("span does not have vertex")},t.prototype.isAdjacent=function(t){return this.has(t._source)||this.has(t._target)},t.prototype.invert=function(){t=[this._target,this._source],this._source=t[0],this._target=t[1];var t},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,r){"use strict";function n(t,e){if(e.length<1)throw new Error("an objects array must contain at least 1 object");for(var r=e[0],n=t.distanceTo(r.location||r),o=1,i=e.length;o<i;++o){var a=e[o],s=t.distanceTo(a.location||a);s<n&&(r=e[o],n=s)}return r}function o(t,e,r,n){void 0===n&&(n=!1);var o=e.map(function(e){return{item:e,distance:t.distanceTo(e.location)}}).filter(function(t){return t.distance<=r});return(n?o.sort(function(t,e){return t.distance-e.distance}):o).map(function(t){return t.item})}function i(t){for(var e=0,r=0,n=0,o=t;n<o.length;n++){var i=o[n],a=i.lat,u=i.lng;e+=a,r+=u}return s.latLng(e/t.length,r/t.length)}function a(t,e,r,n){void 0===r&&(r=1e-5);var o=i(t),a=e(o);u.callMeMaybe(n,o);for(var l=10;l>r;l*=.61803398875)for(var c=l,f=-c;f<=c;f+=l)for(var d=-c;d<=c;d+=l){var h=s.latLng(o.lat+f,o.lng+d),p=e(h);p<a&&(o=h,a=p,u.callMeMaybe(n,o))}return o}var s=r(1),u=r(0);e.findClosestObject=n,e.findObjectsWithinRadius=o,e.getCenter=i,e.calculateGeoMean=a},function(t,e,r){"use strict";function n(t,e){return t.x*e.x+t.y*e.y}function o(t,e){return n(t,e)/t.distanceTo(e)}function i(t){return t.reduce(function(t,e){return t.add(e)}).divideBy(t.length)}function a(t){if(3!==t.length)throw new Error("must have 3 vertices");var e=t[0],r=t[1].subtract(e),o=t[2].subtract(e),i=n(r,r),a=n(o,o);return c.point(o.y*i-r.y*a,r.x*a-o.x*i).divideBy(2*(r.x*o.y-r.y*o.x)).add(e)}function s(t,e,r){return c.point(t.x+e*Math.cos(r),t.y+e*Math.sin(r))}function u(t){var e=Math.abs(t.x),r=Math.abs(t.y);return t.divideBy(e<r?r:e)}function l(t,e,r){var n=e*e/r;return n<t?e/r*2+(t-n)/e:2*Math.sqrt(t/r)}var c=r(1);e.dot=n,e.angle=o,e.getCenter=i,e.getCircumcenter=a,e.polarToCartesian=s,e.vectorToGradCoordinates=u,e.timeToTravel=l},function(t,e,r){"use strict";function n(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function o(t,e){var r=n("circle");return r.setAttribute("r",e.toString()),r.setAttribute("cy",t.y.toString()),r.setAttribute("cx",t.x.toString()),r}function i(t,e){var r=n("line");return r.setAttribute("x1",t.x.toString()),r.setAttribute("y1",t.y.toString()),r.setAttribute("x2",e.x.toString()),r.setAttribute("y2",e.y.toString()),r}function a(t,e,r){var o=n("path");return c(o,t,e,r),o}function s(t){var e=[],r=/\D([\d\.]+).*?,.*?([\d\.]+)/g,n=t.getAttribute("d");if(n){for(var o;null!==(o=r.exec(n));)e.push(v.point(Number(o[1]),Number(o[2])));return e}}function u(t,e){if(4!==e.length)throw new Error("there should be 4 points");var r=["M"].concat(e.map(function(t){return t.x+","+t.y}));r.splice(2,0,"C"),t.setAttribute("d",r.join(" "))}function l(t){var e=[],r=/\D([\d\.]+)/g,n=t.getAttribute("d");if(n){for(var o;null!==(o=r.exec(n));)e.push(Number(o[1]));return e}}function c(t,e,r,n){var o=g.getCircumcenter([e,r,n]),i=Math.atan2(e.y-o.y,e.x-o.x),a=Math.atan2(r.y-o.y,r.x-o.x),s=a-i,u=s<=Math.PI||s>-Math.PI?0:1,l=e.subtract(o),c=r.subtract(o),f=l.x*c.y-c.x*l.y<0?0:1,d=g.dot(n.subtract(e),n.subtract(r));d<0&&(f=1-f,u=1-u);var h=o.distanceTo(e),p=["M",e.x,e.y,"A",h,h,0,u,f,r.x,r.y].join(" ");t.setAttribute("d",p)}function f(t){var e=n("path");return u(e,t),e}function d(t,e){var r=o(t,e),n=r.cloneNode(!0);return[r,n]}function h(t,e,r){var n=a(t,e,r),o=n.cloneNode(!0);return[n,o]}function p(t,e){var r=e.clone();return t.x===e.x?r.x+=.01:t.y===e.y&&(r.y+=.01),[i(t,r),i(t,r)]}function m(t){var e=v.point(+t.getAttribute("cx"),+t.getAttribute("cy")),r=~~t.getAttribute("r"),n=v.point(0+r,4+r);return e.subtract(n)}var v=r(1),g=r(11);e.createSVGElement=n,e.makeCircle=o,e.makeLine=i,e.makeArc=a,e.getBezierPathPoints=s,e.setBezierPath=u,e.getCircularPath=l,e.setCircularPath=c,e.makeCubicBezier=f,e.makeTransferRing=d,e.makeTransferArc=h,e.makeTransferLine=p,e.circleOffset=m;var y;!function(t){function e(){var t=n("filter");return t.id="shadow",t.setAttribute("width","200%"),t.setAttribute("height","200%"),t.innerHTML='\n            <feOffset result="offOut" in="SourceAlpha" dx="0" dy="4" />\n            <feColorMatrix result="matrixOut" in="offOut" type="matrix" values=\n                "0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0.5 0"/>\n            <feGaussianBlur result="blurOut" in="matrixOut" stdDeviation="2" />\n\n            <feBlend in="SourceGraphic" in2="blurOut" mode="normal" />\n        ',t}function r(){var t=n("filter");return t.id="black-glow",t.innerHTML='<feColorMatrix type="matrix" values=\n                "0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0.3 0"/>\n            <feGaussianBlur stdDeviation="2.5" result="coloredBlur"/>\n            <feMerge>\n                <feMergeNode in="coloredBlur"/>\n                <feMergeNode in="SourceGraphic"/>\n            </feMerge>',t}function o(){var t=n("filter");return t.id="opacity",t.innerHTML='<feComponentTransfer>\n            <feFuncA type="table" tableValues="0 0.5">\n        </feComponentTransfer>',t}function i(){var t=n("filter");return t.id="gray",t.innerHTML='<feColorMatrix type="matrix"\n               values="0.2126 0.7152 0.0722 0 0\n                       0.2126 0.7152 0.0722 0 0\n                       0.2126 0.7152 0.0722 0 0\n                       0 0 0 1 0"/>',t}function a(t){t.appendChild(e()),t.appendChild(r()),t.appendChild(o()),t.appendChild(i())}function s(t){var e=t.getBoundingClientRect(),r=getComputedStyle(t),n=2*parseFloat(r.strokeWidth||t.style.strokeWidth||"0");e.height>=n&&e.width>=n&&(t.style.filter="url(#black-glow)")}t.makeDrop=e,t.makeGlow=r,t.makeOpacity=o,t.makeGray=i,t.appendAll=a,t.applyDrop=s}(y=e.Filters||(e.Filters={}));var b;!function(t){function e(t){var e=n("linearGradient");if("innerHTML"in e)return e.innerHTML='<stop style="stop-color:'+t[0]+'" /><stop style="stop-color:'+t[1]+'" />',e;var r=n("stop");r.style.stopColor=t[0];var o=n("stop");return o.style.stopColor=t[1],e.appendChild(r),e.appendChild(o),e}function r(t,r,n){void 0===n&&(n=0);var a=e(r);return i(a,n),o(a,t),a}function o(t,e){var r="rotate("+180*Math.atan2(e.y,e.x)/Math.PI+", 0.5, 0.5)";t.setAttribute("gradientTransform",r)}function i(t,e){t.firstChild.setAttribute("offset",e.toString()),t.lastChild.setAttribute("offset",(1-e).toString())}t.makeUndirectedLinear=e,t.makeLinear=r,t.setDirection=o,t.setOffset=i}(b=e.Gradients||(e.Gradients={}))},,,function(t,e,r){"use strict";var n=r(47),o={platformBindings:new WeakMap,dummyBindings:new n.WeakBiMap,outerEdgeBindings:new n.WeakBiMap,innerEdgeBindings:new n.WeakBiMap,gradientBindings:new WeakMap};Object.defineProperty(e,"__esModule",{value:!0}),e.default=Object.freeze(o)},function(t,e,r){"use strict";var n=r(1),o=r(0),i=r(21);e.Platform=i.default;var a=r(23);e.Station=a.default;var s=r(9);e.Edge=s.default;var u=r(22);e.Span=u.default;var l=r(24);e.Transfer=l.default;var c=function(){function t(t){var e=this,r=function(t){return n.latLng(t.lat,t.lng)};this.platforms=t.platforms.map(function(t){return new i.default(t.name,r(t.location),t.altNames)}),this.stations=[],this.routes=t.routes,this.lines=t.lines,this.transfers=t.transfers.map(function(t){return new l.default(e.platforms[t.source],e.platforms[t.target])});var o=function(t){return t.routes.map(function(t){return e.routes[t]})};this.spans=t.spans.map(function(t){return new u.default(e.platforms[t.source],e.platforms[t.target],o(t))}),console.time("restore");for(var s=new Set(this.transfers),c=new Set(this.platforms);s.size>0;){var f=s.values().next().value,d=(new Set).add(f.source).add(f.target);s.delete(f);for(var h=d.values(),p=h.next().value;void 0!==p;p=h.next().value){for(var m=new Set,v=s.values(),g=v.next().value;void 0!==g;g=v.next().value)g.source===p?(d.add(g.target),m.add(g)):g.target===p&&(d.add(g.source),m.add(g));m.forEach(function(t){return s.delete(t)}),c.delete(p)}var y=new a.default(Array.from(d));this.stations.push(y)}c.forEach(function(t){return e.stations.push(new a.default([t]))}),console.timeEnd("restore")}return t.prototype.toJSON=function(){var t=this;return JSON.stringify({platforms:this.platforms.map(function(t){return{name:t.name,altNames:t.altNames,location:t.location}}),transfers:this.transfers.map(function(e){return{source:t.platforms.indexOf(e.source),target:t.platforms.indexOf(e.target)}}),lines:this.lines,spans:this.spans.map(function(e){return{source:t.platforms.indexOf(e.source),target:t.platforms.indexOf(e.target),routes:e.routes.map(function(e){return t.routes.indexOf(e)})}}),routes:this.routes},function(t,e){return t.startsWith("_")?void 0:e})},t.prototype.deletePlatform=function(t){console.log("removing platform",t);for(var e=0,r=t.transfers;e<r.length;e++){var n=r[e];o.deleteFromArray(this.transfers,n)}if(t.transfers.length=0,1===t.spans.length){var i=t.spans[0],a=i.other(t);o.deleteFromArray(a.spans,i),o.deleteFromArray(this.spans,i)}else if(2===t.spans.length){var s=t.spans,u=s[0],l=s[1],c=l.other(t);if(!c)throw new Error("span does not have other end");if(2===t.passingRoutes().size){var f=u.other(t);o.deleteFromArray(f.spans,u),o.deleteFromArray(this.spans,u)}else u.source===t?u.source=c:u.target=c;o.deleteFromArray(c.spans,l),o.deleteFromArray(this.spans,l)}else for(var d=0,h=t.spans;d<h.length;d++){var i=h[d],a=i.other(t);o.deleteFromArray(a.spans,i),o.deleteFromArray(this.spans,i)}var p=t.station;1===p.platforms.length?o.deleteFromArray(this.stations,p):o.deleteFromArray(p.platforms,t),o.deleteFromArray(this.platforms,t)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=c},function(t,e,r){"use strict";var n=r(28);e.RedCircle=n.default,e.start=L.icon({iconUrl:"https://proxy-antonv.rhcloud.com/?url=http://map.project-osrm.org/images/marker-start-icon-2x.png",iconSize:[20,56],iconAnchor:[10,28]}),e.end=L.icon({iconUrl:"https://proxy-antonv.rhcloud.com/?url=http://map.project-osrm.org/images/marker-end-icon-2x.png",iconSize:[20,56],iconAnchor:[10,28]}),e.red=L.icon({iconUrl:"https://proxy-antonv.rhcloud.com/?url=http://harrywood.co.uk/maps/examples/leaflet/marker-icon-red.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:"https://proxy-antonv.rhcloud.com/?url=http://cdn.leafletjs.com/leaflet/v0.7.7/images/marker-shadow.png",shadowRetinaUrl:"marker-shadow-@2x.png",shadowSize:[41,41],shadowAnchor:[12,41]})},function(t,e,r){"use strict";function n(t){var e=t.name,r=t.altNames,n=r.fi,o=r.en,i=o?[e,n,o]:n?[e,n]:[e],a=i.join("|"),s=window.location.search.match(/city=(\w+)/),u=s?s[1]:"spb",c="spb"===u?"fi":"helsinki"===u?"se":"defaultForeign";
l.prompt((d=["New name"],d.raw=["New name"],f.tr(d)),a,function(r,n){var o=n.split("|");if(t.name=o[0],t.altNames[c]=o[1],t.altNames.en=o[2],n===a)return l.warning((h=["Name was not changed"],h.raw=["Name was not changed"],f.tr(h)));var s=i.slice(1).join(", "),u=o.slice(1).join(", ");l.success((p=[""," (",") renamed to "," (",")"],p.raw=[""," (",") renamed to "," (",")"],f.tr(p,e,s,o[0],u)));var d=t.station;if(!(d.platforms.length<2)){l.confirm((m=["Rename the entire station?"],m.raw=["Rename the entire station?"],f.tr(m)),function(){for(var t=0,e=d.platforms;t<e.length;t++){var r=e[t];r.name=o[0],r.altNames.fi=o[1],r.altNames.en=o[2]}l.success((i=["The entire station was renamed to ",""],i.raw=["The entire station was renamed to ",""],f.tr(i,n)));var i});var h,p,m}},function(){return l.warning((t=["Name change cancelled"],t.raw=["Name change cancelled"],f.tr(t)));var t});var d}function o(t,e){for(var r=void 0===e?void 0:Array.from(e).map(function(t){return t.line+t.branch}).join("|"),n=new Set,o=prompt("routes",r)||"",i=0,a=o.split("|");i<a.length;i++){var s=a[i],u="M"===s[0]?s.match(/(M\d{0,2})(\w?)/):s.match(/([EL])(.{0,2})/);if(u){var l=u[1],c=u[2],f=t.routes.find(function(t){return t.line===l&&t.branch===c});void 0===f&&(console.log("creating new route"),f={line:l,branch:c},t.routes.push(f)),n.add(f)}else console.error("incorrect route",s)}return n}function i(t,e){var r=0;console.log(e.length),addEventListener("keydown",function(n){n.shiftKey&&n.ctrlKey&&76===n.keyCode&&(n.preventDefault(),t.removeLayer(e[r]),++r===e.length&&(r=0),t.addLayer(e[r]),t.invalidateSize(!1))})}function a(t,e){var r=e.filter(function(t){return t.spans[0].routes[0].line.startsWith("M")}).map(function(t){return t.location}),n=function(t){return r.reduce(function(e,r){return e+t.distanceTo(r)},0)},o=u.polyline([],{color:"red"}),i=c.calculateGeoMean(r,n,1,function(t){return o.addLatLng(t)});t.addLayer(o);for(var a=5e3;a<2e4;a+=5e3)u.circle(i,a-250,{weight:1}).addTo(t),u.circle(i,a+250,{weight:1}).addTo(t);var s=(e.filter(function(t){return t.spans[0].routes[0].line.startsWith("E")}).map(function(t){return t.location}),e.find(function(t){return"Glavnyj voxal"===t.name&&t.spans[0].routes[0].line.startsWith("E")}));if(s){var l=s.location;u.circle(l,3e4).addTo(t),u.circle(l,45e3).addTo(t)}}function s(t,e){for(var r=0,n=e;r<n.length;r++){var o=n[r];t.addLayer(o).removeLayer(o)}}var u=r(1),l=r(8),c=r(10),f=r(4),d=r(29);e.MapEditor=d.default;var h=r(27);e.FAQ=h.default;var p=r(32);e.TextPlate=p.default;var m=r(30);e.RoutePlanner=m.default;var v=r(25);e.ContextMenu=v.default;var g=r(26);e.DistanceMeasure=g.default;var y=r(31);e.SvgOverlay=y.default;var b=r(17);e.Icons=b;var w=r(35);e.tileLayers=w,e.platformRenameDialog=n,e.askRoutes=o,e.addLayerSwitcher=i,e.drawZones=a,e.cacheIcons=s},function(t,e,r){(function(e,r){(function(){!function(t){"use strict";function r(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!=typeof t&&(t=String(t)),t}function o(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return y.iterable&&(e[Symbol.iterator]=function(){return e}),e}function i(t){this.map={},t instanceof i?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function a(t){return t.bodyUsed?e.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function s(t){return new e(function(e,r){t.onload=function(){e(t.result)},t.onerror=function(){r(t.error)}})}function u(t){var e=new FileReader,r=s(e);return e.readAsArrayBuffer(t),r}function l(t){var e=new FileReader,r=s(e);return e.readAsText(t),r}function c(t){for(var e=new Uint8Array(t),r=new Array(e.length),n=0;n<e.length;n++)r[n]=String.fromCharCode(e[n]);return r.join("")}function f(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function d(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(y.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(y.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(y.arrayBuffer&&y.blob&&w(t))this._bodyArrayBuffer=f(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!y.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!_(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=f(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var t=a(this);if(t)return t;if(this._bodyBlob)return e.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return e.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return e.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?a(this)||e.resolve(this._bodyArrayBuffer):this.blob().then(u)}),this.text=function(){var t=a(this);if(t)return t;if(this._bodyBlob)return l(this._bodyBlob);if(this._bodyArrayBuffer)return e.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return e.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}function h(t){var e=t.toUpperCase();return x.indexOf(e)>-1?e:t}function p(t,e){e=e||{};var r=e.body;if("string"==typeof t)this.url=t;else{if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new i(t.headers)),this.method=t.method,this.mode=t.mode,r||null==t._bodyInit||(r=t._bodyInit,t.bodyUsed=!0)}if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new i(e.headers)),this.method=h(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function m(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var r=t.split("="),n=r.shift().replace(/\+/g," "),o=r.join("=").replace(/\+/g," ");e.append(decodeURIComponent(n),decodeURIComponent(o))}}),e}function v(t){var e=new i;return t.split("\r\n").forEach(function(t){var r=t.split(":"),n=r.shift().trim();if(n){var o=r.join(":").trim();e.append(n,o)}}),e}function g(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new i(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var y={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(y.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],w=function(t){return t&&DataView.prototype.isPrototypeOf(t)},_=ArrayBuffer.isView||function(t){return t&&b.indexOf(Object.prototype.toString.call(t))>-1};i.prototype.append=function(t,e){t=r(t),e=n(e);var o=this.map[t];this.map[t]=o?o+","+e:e},i.prototype.delete=function(t){delete this.map[r(t)]},i.prototype.get=function(t){return t=r(t),this.has(t)?this.map[t]:null},i.prototype.has=function(t){return this.map.hasOwnProperty(r(t))},i.prototype.set=function(t,e){this.map[r(t)]=n(e)},i.prototype.forEach=function(t,e){for(var r in this.map)this.map.hasOwnProperty(r)&&t.call(e,this.map[r],r,this)},i.prototype.keys=function(){var t=[];return this.forEach(function(e,r){t.push(r)}),o(t)},i.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),o(t)},i.prototype.entries=function(){var t=[];return this.forEach(function(e,r){t.push([r,e])}),o(t)},y.iterable&&(i.prototype[Symbol.iterator]=i.prototype.entries);var x=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this,{body:this._bodyInit})},d.call(p.prototype),d.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},g.error=function(){var t=new g(null,{status:0,statusText:""});return t.type="error",t};var k=[301,302,303,307,308];g.redirect=function(t,e){if(k.indexOf(e)===-1)throw new RangeError("Invalid status code");return new g(null,{status:e,headers:{location:t}})},t.Headers=i,t.Request=p,t.Response=g,t.fetch=function(t,r){return new e(function(e,n){var o=new p(t,r),i=new XMLHttpRequest;i.onload=function(){var t={status:i.status,statusText:i.statusText,headers:v(i.getAllResponseHeaders()||"")};t.url="responseURL"in i?i.responseURL:t.headers.get("X-Request-URL");var r="response"in i?i.response:i.responseText;e(new g(r,t))},i.onerror=function(){n(new TypeError("Network request failed"))},i.ontimeout=function(){n(new TypeError("Network request failed"))},i.open(o.method,o.url,!0),"include"===o.credentials&&(i.withCredentials=!0),"responseType"in i&&y.blob&&(i.responseType="blob"),o.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.send("undefined"==typeof o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this),t.exports=r.fetch}).call(r)}).call(e,r(2),r(13))},function(t,e,r){"use strict";(function(t){var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},o=this&&this.__awaiter||function(e,r,n,o){return new(n||(n=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new n(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,r||[])).next())})},i=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){s.label=r[1];break}if(6===r[0]&&s.label<a[1]){s.label=a[1],a=r;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(r);break}a[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}},a=r(1),s=r(3),u=r(16),l=r(18),c=r(0),f=r(7),d=r(15),h=r(4),p=c.geo,m=c.sfx,v=c.svg,g=c.math,y=c.algorithm,b=c.Mediator,w=c.color,_=c.file,x=c.tryGetFromMap,k=l.tileLayers,L=k.mapbox,E=k.mapnik,M=k.osmFrance,S=k.openMapSurfer,A=k.cartoDBNoLabels,T=k.wikimapia,C=m.Scale,O=g.getCenter,B=y.findCycle,P=[{event:"routefrom",text:"Route from here"},{event:"routeto",text:"Route to here"},{event:"clearroute",text:"Clear route"},{event:"showheatmap",text:"Show heatmap",extra:{disabled:!0}}],j=function(e){function r(t){var r=e.call(this)||this;return r.whiskers=new WeakMap,r.platformsOnSVG=new WeakMap,r.config=t,r.makeMap(),r}return n(r,e),r.prototype.getMap=function(){return this.map},r.prototype.getNetwork=function(){return this.network},r.prototype.makeMap=function(){return o(this,void 0,void 0,function(){var e,r,n,o,s,d,m,g,y,b,w,_,x,k,C=this;return i(this,function(i){switch(i.label){case 0:return e=this.config,document.getElementById("scheme").href=e.url.scheme,r=this.getGraph(),n=f.getLineRules(),o=new t(function(t){return L.once("load",t)}),s=new l.FAQ(e.url.data),e.center=[0,0],d=Object.assign({},e),"1"===a.version[0]&&(d.wheelPxPerZoomLevel=75,d.inertiaMaxSpeed=1500,d.fadeAnimation=!1),this.map=a.map(e.containerId,d).addControl(a.control.scale({imperial:!1})),m=this.map.getPanes().mapPane.style,m.visibility="hidden",l.addLayerSwitcher(this.map,[L,E,M,S,A,T]),addEventListener("keydown",function(t){t.shiftKey&&t.ctrlKey&&82===t.keyCode&&C.getGraph().then(function(t){return C.resetNetwork(t)})}),this.addContextMenu(),[4,r];case 1:return g=i.sent(),this.network=new u.default(g),y=p.getCenter(this.network.platforms.map(function(t){return t.location})),e.center=[y.lat,y.lng],b=a.latLngBounds(this.network.platforms.map(function(t){return t.location})),this.overlay=new l.SvgOverlay(b).addTo(this.map),w=this.overlay.defs,v.Filters.appendAll(w),_=w.textContent,0===(_||"").length&&alert((k=["Your browser doesn't seem to have capabilities to display some features of the map. Consider using Chrome or Firefox for the best experience."],k.raw=["Your browser doesn't seem to have capabilities to display some features of the map. Consider using Chrome or Firefox for the best experience."],h.tr(k))),[4,n];case 2:return x=i.sent(),this.lineRules=x,this.resetMapView(),this.map.addLayer(L),this.map.on("overlayupdate",function(t){C.redrawNetwork()}),this.initNetwork(),this.map.invalidateSize(!1),this.addMapListeners(),(new l.RoutePlanner).addTo(this),(new l.DistanceMeasure).addTo(this.map),a.Browser.mobile||new l.MapEditor(e.detailedZoom).addTo(this),[4,s.whenAvailable];case 3:return i.sent(),s.addTo(this.map),[4,o];case 4:return i.sent(),c.fixFontRendering(),this.map.on("layeradd layerremove",function(t){return c.fixFontRendering()}),m.visibility="",[2]}})})},r.prototype.subscribe=function(t,r){var n=this;e.prototype.subscribe.call(this,t,r),this.map.on(t,function(t){return n.publish(t)})},r.prototype.addContextMenu=function(){var t=this;this.contextMenu=new l.ContextMenu(P);for(var e=0,r=P;e<r.length;e++){var n=r[e];this.map.on(n.event,function(e){console.log(e),t.publish(e)})}this.contextMenu.addTo(this.map)},r.prototype.addMapListeners=function(){var t=this,e=function(t){var e=t;return d.default.outerEdgeBindings.getKey(e)||d.default.innerEdgeBindings.getKey(e)},r=function(t){return d.default.dummyBindings.getKey(t)},n=this,o=n.map,i=n.contextMenu;o.on("distancemeasureinit",function(t){i.insertItem("measuredistance","Measure distance")}),o.on("clearmeasurements",function(t){i.removeItem("clearmeasurements"),i.insertItem("measuredistance","Measure distance")}),o.on("zoomstart",function(e){t.plate.hide()}),this.subscribe("measuredistance",function(t){i.removeItem("measuredistance"),i.insertItem("clearmeasurements","Clear measurements")}),this.subscribe("platformrename",function(e){var n=r(e.relatedTarget);t.plate.show(v.circleOffset(e.relatedTarget),c.getPlatformNames(n)),l.platformRenameDialog(n)}),this.subscribe("platformmovestart",function(e){t.plate.disabled=!0}),this.subscribe("platformmove",function(t){var e=r(t.relatedTarget);e.location=c.mouseToLatLng(o,t)}),this.subscribe("platformmoveend",function(e){var n=r(e.relatedTarget);t.plate.disabled=!1,t.plate.show(v.circleOffset(e.relatedTarget),c.getPlatformNames(n))}),this.subscribe("platformadd",function(r){console.log(r);var n=r.detail,i=c.mouseToLatLng(o,n),a=new u.Platform((d=["New station"],d.raw=["New station"],h.tr(d)),i,{});if(t.network.platforms.push(a),void 0!==n.relatedTarget){var s=e(n.relatedTarget),l=s.source===a?"target":"source",f=new u.Span(a,s[l],s.routes);s[l]=a,t.network.spans.push(f)}t.overlay.extendBounds(i),t.resetNetwork(JSON.parse(t.network.toJSON()));var d}),this.subscribe("platformdelete",function(e){var n=r(e.relatedTarget);t.network.deletePlatform(n),t.redrawNetwork()}),this.subscribe("spanroutechange",function(r){if(void 0!==r.relatedTarget){var n=e(r.relatedTarget),o=l.askRoutes(t.network,new Set(n.routes));n.routes=Array.from(o),t.resetNetwork(JSON.parse(t.network.toJSON()))}}),this.subscribe("spaninvert",function(r){if(void 0!==r.relatedTarget){var n=e(r.relatedTarget);n.invert(),t.resetNetwork(JSON.parse(t.network.toJSON()))}}),this.subscribe("spanend",function(e){var r=d.default.dummyBindings.getKey(e.detail.source),n=d.default.dummyBindings.getKey(e.detail.target);console.log(r,n),i.removeItem("spanend");var o=r.passingRoutes(),a=n.passingRoutes(),s=o.size,f=a.size,h=s>0&&0===f?1===s?o:l.askRoutes(t.network,o):f>0&&0===s?1===f?a:l.askRoutes(t.network,a):l.askRoutes(t.network,c.intersection(o,a));t.network.spans.push(new u.Span(r,n,Array.from(h))),t.resetNetwork(JSON.parse(t.network.toJSON()))}),this.subscribe("spandelete",function(r){if(void 0!==r.relatedTarget){var n=e(r.relatedTarget);c.deleteFromArray(t.network.spans,n),t.resetNetwork(JSON.parse(t.network.toJSON()))}}),this.subscribe("transferend",function(e){var r=d.default.dummyBindings.getKey(e.detail.source),n=d.default.dummyBindings.getKey(e.detail.target);console.log(r,n),i.removeItem("transferend"),t.network.transfers.push(new u.Transfer(r,n)),t.resetNetwork(JSON.parse(t.network.toJSON()))}),this.subscribe("transferdelete",function(e){if(void 0!==e.relatedTarget){var r=e.relatedTarget,n=d.default.outerEdgeBindings.getKey(r)||d.default.innerEdgeBindings.getKey(r);c.deleteFromArray(t.network.transfers,n),t.resetNetwork(JSON.parse(t.network.toJSON()))}}),this.subscribe("editmapstart",function(e){o.getZoom()<t.config.detailedZoom&&o.setZoom(t.config.detailedZoom);var r=function(t){var e=t.parentElement;if(!e)return!1;var r=e.id;return"paths-outer"===r||"paths-inner"===r};i.insertItem("platformaddclick","New station",function(t){return!r(t)});var n=function(t){var e=t.parentElement;return!!e&&"dummy-circles"===e.id};i.insertItem("platformrename","Rename station",n),i.insertItem("platformdelete","Delete station",n),i.insertItem("spanstart","Span from here",n),i.insertItem("transferstart","Transfer from here",n),i.insertItem("spanroutechange","Change route",r),i.insertItem("spaninvert","Invert span",r),i.insertItem("platformaddtolineclick","Add station to line",r),i.insertItem("spandelete","Delete span",r),i.insertItem("transferdelete","Delete transfer",function(t){var e=t.parentElement;if(!e)return!1;var r=e.id;return"transfers-outer"===r||"transfers-inner"===r})}),this.subscribe("editmapend",function(t){i.removeItem("platformaddclick"),i.removeItem("platformrename"),i.removeItem("platformdelete"),i.removeItem("spanstart"),i.removeItem("transferstart"),i.removeItem("platformaddtolineclick"),i.removeItem("spanroutechange"),i.removeItem("spandelete"),i.removeItem("transferdelete")}),this.subscribe("mapsave",function(e){_.downloadText("graph.json",t.network.toJSON())})},r.prototype.initNetwork=function(){for(var t=this.overlay.origin,e=["paths-outer","paths-inner","transfers-outer","station-circles","transfers-inner","dummy-circles"],r=0,n=e;r<n.length;r++){var o=n[r],i=v.createSVGElement("g");i.id=o,t.appendChild(i)}this.plate=new l.TextPlate,t.insertBefore(this.plate.element,document.getElementById("dummy-circles")),this.redrawNetwork(),this.addStationListeners()},r.prototype.resetMapView=function(){var t=this.config,e=t.center,r=t.zoom,n={pan:{animate:!1},zoom:{animate:!1}};return e?(this.map.setView(e,r+1,n),void this.map.setView(e,r,n)):void console.error("cannot set map to center")},r.prototype.getGraph=function(){return f.getJSON(this.config.url.graph)},r.prototype.resetNetwork=function(t){this.network=new u.default(t),this.redrawNetwork()},r.prototype.cleanElements=function(){for(var t=0,e=this.overlay.origin.childNodes;t<e.length;t++){var r=e[t];r!==this.plate.element&&c.removeAllChildren(r)}},r.prototype.addBindings=function(){for(var t=this.network.platforms,e=d.default.platformBindings,r=d.default.dummyBindings,n=0,o=t;n<o.length;n++){var i=o[n];this.platformToModel(i,[x(e,i),x(r,i)])}},r.prototype.redrawNetwork=function(){var t=this;console.time("pre"),this.cleanElements(),this.updatePlatformsPositionOnOverlay(),console.timeEnd("pre"),console.time("preparation");for(var e=this.config.detailedZoom,r=this.map.getZoom(),n=r>9?r:r>8?9.5:9,o=.5*(n-7),i=.75*o,a=n<e?1.25*o:o,u=n<e?.4*a:.6*a,l=2*a,f=.9*o,h=1.25*u,p={"station-circles":u,"dummy-circles":0,"transfers-outer":f+h/2,"transfers-inner":f-h/2,"paths-outer":o,"paths-inner":o/2},m=a+u/2,g=new Map,y=0,b=Object.keys(p);y<b.length;y++){var w=b[y];g.set(w,document.createDocumentFragment()),c.byId(w).style.strokeWidth=p[w]+"px"}var _=x(this.lineRules,"light-rail-path");_.strokeWidth=i+"px";var k=Math.max(.5*(r+10),11),L=s.get(this.plate,"element.firstChild.firstChild.style");L&&(L.fontSize=k+"px");var E=new Map;console.timeEnd("preparation"),console.time("circle preparation");for(var M=x(g,"station-circles"),S=x(g,"dummy-circles"),A=0,T=this.network.stations;A<T.length;A++){for(var C=T[A],O=[],P=0,j=C.platforms;P<j.length;P++){var R=j[P],F=x(this.platformsOnSVG,R);if(r>9){var I=v.makeCircle(F,a);r>=e&&this.colorizePlatformCircle(I,R.passingLines());var N=v.makeCircle(F,l);M.appendChild(I),d.default.platformBindings.set(R,I),S.appendChild(N),d.default.dummyBindings.set(R,N)}this.whiskers.set(R,this.makeWhiskers(R))}var G=B(this.network,C);if(G.length>0){for(var D=0,z=C.platforms;D<z.length;D++){var R=z[D];if(G.includes(R)){var U=x(this.platformsOnSVG,R);O.push(U)}}E.set(C,G)}}if(console.timeEnd("circle preparation"),console.time("transfer preparation"),r>=e)for(var V=x(g,"transfers-outer"),W=x(g,"transfers-inner"),q=this.overlay.defs,J=0,K=this.network.transfers;J<K.length;J++){var Z=K[J],H=Z.source,Q=Z.target,Y=x(this.platformsOnSVG,Z.source),X=x(this.platformsOnSVG,Z.target),$=E.get(H.station),tt=void 0!==$&&$.includes(H)&&$.includes(Q)?this.makeTransferArc(Z,$):v.makeTransferLine(Y,X);d.default.outerEdgeBindings.set(Z,tt[0]),d.default.innerEdgeBindings.set(Z,tt[1]);var et=[H,Q].map(function(e){return t.getPlatformColor(e)}),rt=m/Y.distanceTo(X),nt=X.subtract(Y),ot=d.default.gradientBindings.get(Z);void 0===ot?(ot=v.Gradients.makeLinear(nt,et,rt),ot.id=c.generateId(function(t){return null!==document.getElementById(t)}),d.default.gradientBindings.set(Z,ot),q.appendChild(ot)):(v.Gradients.setDirection(ot,nt),v.Gradients.setOffset(ot,rt)),tt[0].style.stroke="url(#"+ot.id+")",V.appendChild(tt[0]),W.appendChild(tt[1])}console.timeEnd("transfer preparation"),console.time("span preparation");for(var it=x(g,"paths-outer"),at=x(g,"paths-inner"),st=0,ut=this.network.spans;st<ut.length;st++){var lt=ut[st],ct=this.makePath(lt),ft=ct[0],dt=ct[1];it.appendChild(ft),dt&&at.appendChild(dt)}console.timeEnd("span preparation"),console.time("appending"),g.forEach(function(t,e){return c.byId(e).appendChild(t)}),this.addBindings(),console.timeEnd("appending")},r.prototype.updatePlatformsPositionOnOverlay=function(t){void 0===t&&(t=this.map.getZoom());for(var e=t<this.config.detailedZoom,r=0,n=this.network.stations;r<n.length;r++)for(var o=n[r],i=e?this.overlay.latLngToSvgPoint(o.getCenter()):void 0,a=0,s=o.platforms;a<s.length;a++){var u=s[a],l=i||this.overlay.latLngToSvgPoint(u.location);this.platformsOnSVG.set(u,l)}},r.prototype.getPlatformColor=function(t){return w.mean(this.linesToColors(t.passingLines()))},r.prototype.linesToColors=function(t){var e=this,r=[];return t.forEach(function(t){var n=x(e.lineRules,"M"===t[0]?t:t[0]).stroke;n&&r.push(n)}),r},r.prototype.colorizePlatformCircle=function(t,e){if(0!==e.size){if(1===e.size){var r=e.values().next().value;return void t.classList.add("M"===r[0]?r:r[0])}t.style.stroke=w.mean(this.linesToColors(e))}},r.prototype.makeWhiskers=function(t){var e=this,r=x(this.platformsOnSVG,t),n=new Map;if(0===t.spans.length)return n;if(1===t.spans.length)return n.set(t.spans[0],r);if(2===t.spans.length){if(2===t.passingLines().size)return n.set(t.spans[0],r).set(t.spans[1],r);var o=function(r){return x(e.platformsOnSVG,r.other(t))},i=t.spans.map(function(t){return o(t).add(r).divideBy(2)}),a=c.midPointsToEnds(r,i);return n.set(t.spans[0],a[0]).set(t.spans[1],a[1])}for(var s=[[],[]],u=[[],[]],l=0,f=t.spans;l<f.length;l++){var d=f[l],h=d.other(t),p=x(this.platformsOnSVG,h),m=d.source===t?0:1;s[m].push(p),u[m].push(d)}var v=function(t){return 1===t.length?t[0]:0===t.length?r:O(t)},g=s.map(function(t){return v(t).add(r).divideBy(2)}),y=c.midPointsToEnds(r,g);return u[0].forEach(function(t){return n.set(t,y[0])}),u[1].forEach(function(t){return n.set(t,y[1])}),n},r.prototype.makeTransferArc=function(t,e){var r=this,n=t.source,o=t.target,i=x(this.platformsOnSVG,t.source),a=x(this.platformsOnSVG,t.target),u=function(t){return v.makeTransferArc(i,a,x(r.platformsOnSVG,t))};if(3===e.length){var l=s.difference(e,[n,o])[0];return u(l)}if(n===e[2]&&o===e[3]||n===e[3]&&o===e[2])return v.makeTransferLine(i,a);for(var c=[],f=0,d=this.network.transfers;f<d.length;f++){var h=d[f];h!==t&&(t.has(h.source)?c.push(h.target):t.has(h.target)&&c.push(h.source))}var p;if(2===c.length){if(c[0]!==c[1])throw Error("FFFFUC");p=c[0]}else{if(3!==c.length)throw new Error("111FUUFF");p=c[0]===c[1]?c[2]:c[0]===c[2]?c[1]:c[0]}return u(p)},r.prototype.makePath=function(t){var e=t.routes,r="",n="",o="";if(e.length>0){var i=t.routes[0].line.match(/([MEL])(\d{0,2})/);if(!i)throw new Error("match failed for "+t.source.name+"-"+t.target.name);r=i[0],n=i[1],o=i[2]}else console.error(t,"span has no routes!");var a=[x(this.platformsOnSVG,t.source),x(x(this.whiskers,t.source),t),x(x(this.whiskers,t.target),t),x(this.platformsOnSVG,t.target)],s=v.makeCubicBezier(a);if("E"===n){s.classList.add("E");var u=s.cloneNode(!0);return d.default.outerEdgeBindings.set(t,s),d.default.innerEdgeBindings.set(t,u),[s,u]}return void 0!==r&&s.classList.add(r),void 0!==n?s.classList.add(n):s.style.stroke="black",d.default.outerEdgeBindings.set(t,s),[s]},r.prototype.addStationListeners=function(){var t=this,e=function(e){t.plate.hide(),C.unscaleAll()},r=c.byId("dummy-circles");r.addEventListener("mouseover",function(e){var r=e.target,n=d.default.dummyBindings.getKey(r),o=n.station,i=t.map.getZoom()<t.config.detailedZoom&&o.platforms.length>1?o.getNames():c.getPlatformNames(n);t.highlightStation(o,i)}),r.addEventListener("mouseout",e);var n=function(e){var r=e.target,n=d.default.outerEdgeBindings.getKey(r)||d.default.innerEdgeBindings.getKey(r),o=c.getPlatformNamesZipped([n.source,n.target]);t.highlightStation(n.source.station,o)},o=c.byId("transfers-outer"),i=c.byId("transfers-inner");o.addEventListener("mouseover",n),i.addEventListener("mouseover",n),o.addEventListener("mouseout",e),i.addEventListener("mouseout",e)},r.prototype.highlightStation=function(t,e){var r,n,o=1.25;if(1===t.platforms.length)n=t.platforms[0],r=x(d.default.platformBindings,n),C.scaleCircle(r,o,!0);else{var i=this.map.getZoom()<this.config.detailedZoom?void 0:this.network.transfers;C.scaleStation(t,o,i),n=t.platforms.reduce(function(t,e){return t.location.lat<e.location.lat?e:t}),r=x(d.default.platformBindings,n)}this.plate.show(v.circleOffset(r),e)},r.prototype.platformToModel=function(t,e){var r=this,n=t.location;Object.defineProperty(t,"location",{get:function(){return t._location},set:function(n){t._location=n;for(var o=r.map.getZoom()<r.config.detailedZoom?t.station.getCenter():n,i=r.overlay.latLngToSvgPoint(o),a=0,s=e;a<s.length;a++){var u=s[a];u.setAttribute("cx",i.x.toString()),u.setAttribute("cy",i.y.toString())}r.whiskers.set(t,r.makeWhiskers(t)),r.platformsOnSVG.set(t,i);for(var l=new Set(t.spans),c=0,f=t.spans;c<f.length;c++){var h=f[c],p=h.other(t);r.whiskers.set(p,r.makeWhiskers(p)),p.spans.forEach(function(t){return l.add(t)})}l.forEach(function(t){var e=[x(r.platformsOnSVG,t.source),x(x(r.whiskers,t.source),t),x(x(r.whiskers,t.target),t),x(r.platformsOnSVG,t.target)],n=d.default.outerEdgeBindings.get(t),o=d.default.innerEdgeBindings.get(t);v.setBezierPath(n,e),o&&v.setBezierPath(o,e)});for(var m=0,g=t.transfers;m<g.length;m++){var y=g[m];y[y.source===t?"source":"target"]=t}}}),t._location=n},r.prototype.transferToModel=function(t,e){var r=this,n=[t.source,t.target],o=e[0].tagName;["source","target"].forEach(function(i,a){Object.defineProperty(t,i,{get:function(){return t["_"+i]},set:function(n){t["_"+i]=n;var u=x(d.default.platformBindings,n),l=parseFloat(getComputedStyle(u).strokeWidth||""),c=+u.getAttribute("r")/2+l,f=x(r.platformsOnSVG,n);if("line"===o){for(var h=a+1,p=t.other(n),m=0,g=e;m<g.length;m++){var y=g[m];y.setAttribute("x"+h,f.x.toString()),y.setAttribute("y"+h,f.y.toString())}var b=x(d.default.gradientBindings,t),w=x(r.platformsOnSVG,p),_="source"===i?w.subtract(f):f.subtract(w);v.Gradients.setDirection(b,_);var k=c/f.distanceTo(w);v.Gradients.setOffset(b,k)}else{if("path"!==o)throw new TypeError("wrong element type for transfer");for(var L=[],E=0,M=r.network.transfers;E<M.length;E++){var S=M[E];if(t.isAdjacent(S)&&(L.push(S),3===L.length))break}for(var A=new Set,T=0,C=L;T<C.length;T++){var O=C[T];A.add(O.source).add(O.target)}var B=Array.from(A).map(function(t){return r.platformsOnSVG.get(t)});A.forEach(function(t){return B.push(r.platformsOnSVG.get(t))});for(var P=L.map(function(t){return d.default.outerEdgeBindings.get(t)}),j=L.map(function(t){return d.default.innerEdgeBindings.get(t)}),R=0;R<3;++R){var F=L[R],I=P[R],N=j[R],G=x(r.platformsOnSVG,F.source),D=x(r.platformsOnSVG,F.target),z=s.difference(B,[G,D])[0];z&&(v.setCircularPath(I,G,D,z),N.setAttribute("d",I.getAttribute("d")));var b=x(d.default.gradientBindings,F);v.Gradients.setDirection(b,D.subtract(G));var k=c/G.distanceTo(D);v.Gradients.setOffset(b,k)}}}}),t["_"+i]=n[a]})},r}(b);Object.defineProperty(e,"__esModule",{value:!0}),e.default=j}).call(e,r(2))},function(t,e,r){"use strict";var n=function(){function t(t,e,r,n){void 0===r&&(r={}),this.spans=[],this.transfers=[],this.name=t,this.altNames=r,this.location=e,this.elevation=n}return Object.defineProperty(t.prototype,"station",{get:function(){return this._station},enumerable:!0,configurable:!0}),t.prototype.passingRoutes=function(){for(var t=new Set,e=0,r=this.spans;e<r.length;e++)for(var n=r[e],o=0,i=n.routes;o<i.length;o++){var a=i[o];t.add(a)}return t},t.prototype.passingLines=function(){for(var t=new Set,e=0,r=this.spans;e<r.length;e++)for(var n=r[e],o=0,i=n.routes;o<i.length;o++){var a=i[o];t.add(a.line)}return t},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},o=r(0),i=r(9),a=function(t){function e(e,r,n){var o=t.call(this,e,r)||this;return e.spans.push(o),r.spans.push(o),o.routes=n,o}return n(e,t),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(t){void 0!==this._source&&o.deleteFromArray(this._source.spans,this),this._source=t,t.spans.push(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){void 0!==this._target&&o.deleteFromArray(this._target.spans,this),this._target=t,t.spans.push(this)},enumerable:!0,configurable:!0}),e}(i.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,r){"use strict";var n=r(0),o=function(){function t(t){this.platforms=t;for(var e=0,r=t;e<r.length;e++){var n=r[e];n._station=this}}return t.prototype.getNames=function(){return n.getPlatformNamesZipped(this.platforms)},t.prototype.getCenter=function(){return n.geo.getCenter(this.platforms.map(function(t){
return t.location}))},t.prototype.passingLines=function(){for(var t=new Set,e=0,r=this.platforms;e<r.length;e++)for(var n=r[e],o=0,i=n.spans;o<i.length;o++)for(var a=i[o],s=0,u=a.routes;s<u.length;s++){var l=u[s];t.add(l.line)}return t},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},o=r(0),i=r(9),a=function(t){function e(e,r){var n=t.call(this,e,r)||this;return e.transfers.push(n),r.transfers.push(n),n}return n(e,t),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(t){void 0!==this._source&&o.deleteFromArray(this._source.transfers,this),this._source=t,t.transfers.push(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){void 0!==this._target&&o.deleteFromArray(this._target.transfers,this),this._target=t,t.transfers.push(this)},enumerable:!0,configurable:!0}),e}(i.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,r){"use strict";var n=r(1),o=r(3),i=r(0),a=r(4),s=r(51),u=function(){function t(t){console.log("adding context menu"),this.items=t,this.container=document.createElement("div"),this.container.classList.add(s.contextmenu),this.container.addEventListener("contextmenu",function(t){t.preventDefault(),t.target.click()}),console.log("context menu ready")}return t.prototype.addTo=function(t){return this.onAdd(t),this},t.prototype.onAdd=function(t){var e=this;if(this.map=t,void 0===t)throw new Error("cannot add map editor to metro map: leaflet map is missing");var r=t.getPanes().mapPane,o=t.getContainer(),i=function(t){return e.handler(t)},a=function(t){return e.hide()};r.addEventListener("contextmenu",i,!1),o.addEventListener("mousedown",a),o.addEventListener("touchstart",a),n.Browser.mobile||t.on("movestart",a),document.body.appendChild(this.container)},t.prototype.onRemove=function(t){},t.prototype.handler=function(t){var e=this;t.preventDefault(),console.log("target",t.target,t.target.parentNode),i.removeAllChildren(this.container);for(var r=0,n=this.items;r<n.length;r++){var o=n[r];if(void 0===o.trigger||o.trigger(t.target)){var s=document.createElement("div");void 0!==o.extra&&o.extra.disabled?s.setAttribute("disabled",""):s.setAttribute("data-event",o.event),s.textContent=a.translate(o.text),this.container.appendChild(s)}else console.log(o.trigger(t.target))}this.container.onclick=function(r){console.log(r);var n=r.target,o=n.getAttribute("data-event");o&&(e.hide(),e.map.fireEvent(o,{clientX:p,clientY:m,relatedTarget:t.target}))};var u=this.container.getBoundingClientRect(),l=u.width,c=u.height,f=document.documentElement,d=f.clientWidth,h=f.clientHeight,p=t.clientX,m=t.clientY,v=p+l>d?d-l:p,g=m+c>h?m-c:m;this.container.style.transform="translate("+v+"px, "+g+"px)",this.show()},t.prototype.insertItem=function(t,e,r,n,o){var i={event:t,text:e,trigger:r,extra:n};void 0===o||o<0?this.items.push(i):this.items.splice(o,0,i)},t.prototype.removeItem=function(t,e){if(void 0===e&&(e=!1),e)return void o.remove(this.items,function(e){return e.event===t});var r=this.items.findIndex(function(e){return e.event===t});void 0===r||r<0||this.items.splice(r,1)},t.prototype.show=function(){this.container.style.visibility=null,n.Browser.mobile&&this.map.dragging.disable()},t.prototype.hide=function(){this.container.style.visibility="hidden",n.Browser.mobile&&this.map.dragging.enable()},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=u},function(t,e,r){"use strict";var n=r(1),o=r(0),i=r(17),a=function(){function t(){var t=this;this.polyline=n.polyline([],{color:"red"}),this.markers=n.featureGroup().on("layeradd layerremove",function(t){return o.fixFontRendering()}),this.dashedLine=n.polyline([],{color:"red",opacity:.5,dashArray:"0,9"}),this.makeMarker=function(e){if(0===e.originalEvent.button){var r=function(e){t.dashedLine.setStyle({opacity:0}),t.updateDistances()},o=n.marker(e.latlng,{draggable:!0}).setIcon(i.RedCircle).bindPopup("").on("mouseover",function(e){return t.hideDashedLine()}).on("mouseout",function(e){return t.showDashedLine()}).on("drag",r).on("click",t.onCircleClick.bind(t));t.markers.addLayer(o),t.updateDistances()}},this.resetDashedLine=function(e){t.dashedLine.getLatLngs()[1]=e.latlng,t.dashedLine.redraw()}}return t.prototype.onAdd=function(t){var e=this;this.map=t;return t.fireEvent("distancemeasureinit"),t.on("measuredistance",function(r){return e.measureDistance(o.mouseToLatLng(t,r))}),t.on("clearmeasurements",function(t){return e.clearMeasurements()}),this},t.prototype.onRemove=function(t){},t.prototype.addTo=function(t){return this.onAdd(t),this},t.prototype.updateDistances=function(){var t=this.polyline.getLatLngs(),e=this.markers.getLayers(),r=e.length;t[0]=e[0].setPopupContent("0").getLatLng();for(var n=1,o=0;n<r;++n){var i=e[n].getLatLng();t[n]=i,o+=e[n-1].getLatLng().distanceTo(i);var a=Math.round(o),s=a<1e3?a+" m":(a<1e4?a/1e3:Math.round(a/10)/100)+" km";e[n].setPopupContent(s)}t.length>r&&(t.length=r),this.dashedLine.getLatLngs()[0]=t[t.length-1],this.polyline.redraw(),r>1&&e[r-1].openPopup()},t.prototype.showDashedLine=function(){this.dashedLine.setStyle({opacity:.5})},t.prototype.hideDashedLine=function(){this.dashedLine.setStyle({opacity:0})},t.prototype.onCircleClick=function(t){if(0===t.originalEvent.button){if(this.markers.removeLayer(t.target),0===this.markers.getLayers().length)return void this.map.fire("clearmeasurements");this.updateDistances(),this.map.hasLayer(this.dashedLine)||this.showDashedLine()}},t.prototype.measureDistance=function(t){var e=this;this.dashedLine.addLatLng(t).addLatLng(t),this.map.addLayer(this.polyline.setLatLngs([])).addLayer(this.markers).addLayer(this.dashedLine.setLatLngs([])).on("click",this.makeMarker).on("mousemove",this.resetDashedLine).fire("click",{latlng:t,originalEvent:{button:0}}),o.onceEscapePress(function(t){return e.map.fire("clearmeasurements")})},t.prototype.clearMeasurements=function(){this.map.removeLayer(this.polyline).removeLayer(this.markers.clearLayers()).removeLayer(this.dashedLine).off("mousemove",this.resetDashedLine).off("click",this.makeMarker)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,r){"use strict";(function(t){var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},o=r(14),i=r(34),a=r(0),s=r(52),u=function(e){function r(r){var n=e.call(this)||this,i=t(r).then(function(t){return t.json()}),a=document.createElement("button");a.textContent="FAQ",a.classList.add("leaflet-control"),a.classList.add(s["faq-button"]),a.addEventListener("click",function(t){return n.showFAQ()}),n.button=a,n.card=document.createElement("div"),n.card.classList.add(s["faq-card"]),L.Browser.mobile&&new o(n.card).on("swipeleft swiperight",function(t){return n.hideFAQ()});var u=/\[\[(.+?)\|(.*?)\]\]/g,l='<a href="$1" target="_blank">$2</a>',c=s.question,f=s.answer,d=function(t){return'\n            <div>\n                <span class="'+c+'">'+t.q+'</span>\n                <span class="'+f+'">'+t.a+"</span>\n            </div>\n        "};return n._whenAvailable=i.then(function(t){n.card.innerHTML+=t.faq.map(d).join("").replace(u,l)}),n}return n(r,e),r.prototype.addTo=function(t){var e=this;this.map=t,this.whenAvailable.then(function(t){var r=document.querySelector(".leaflet-right.leaflet-top");return document.body.appendChild(e.card),r?void r.appendChild(e.button):void console.error("cannot append to .leaflet-right.leaflet-top")})},r.prototype.showFAQ=function(){var t=this,e=this.card.style;e.display="inline",e.transform="scale(0.1)",e.opacity="0",this.card.getBoundingClientRect(),e.transform=null,e.opacity=null,this.button.disabled=!0,L.Browser.mobile||(this.map.getContainer().classList.add("dimmed"),this.map.once("mousedown",function(e){return t.hideFAQ()}),a.once(window,"keydown",function(e){27===e.keyCode&&t.map.fireEvent("mousedown")}))},r.prototype.hideFAQ=function(){var t=this;console.log("hiding"),this.card.getBoundingClientRect(),this.card.style.transform="scale(0.1)",this.card.style.opacity="0",L.Browser.mobile||this.map.getContainer().classList.remove("dimmed"),a.once(this.card,"transitionend",function(e){return t.card.style.display=null}),this.button.disabled=!1},r}(i.DeferredWidget);Object.defineProperty(e,"__esModule",{value:!0}),e.default=u}).call(e,r(19))},function(t,e,r){"use strict";var n=r(0),o=n.svg.createSVGElement("svg");o.setAttribute("width","100"),o.setAttribute("height","100");var i=n.svg.makeCircle(L.point(50,50),40);i.style.stroke="red",i.style.strokeWidth="20px",i.style.fill="white",o.appendChild(i);var a=5;Object.defineProperty(e,"__esModule",{value:!0}),e.default=L.icon({iconUrl:n.file.svgToDataUrl(o),iconSize:[2*a,2*a],iconAnchor:[a,a],popupAnchor:[0,-a]})},function(t,e,r){"use strict";var n=r(4),o=r(0),i=r(53),a=function(){function t(t){var e=this,r=document.createElement("button");r.textContent="Edit Map",r.classList.add("leaflet-control"),r.classList.add(i["edit-map-button"]),r.onclick=function(t){return e.editMapClick()},this.button=r}return Object.defineProperty(t.prototype,"editMode",{get:function(){return this._editMode},set:function(t){var e=this;if(t){var r=o.byId("dummy-circles");this.button.textContent=(i=["Save map"],i.raw=["Save map"],n.tr(i)),this.button.onclick=function(t){return e.saveMapClick()},r.onmousedown=r.onclick=function(){return!1},this.metroMap.publish(new Event("editmapstart"))}else this.button.textContent=(a=["Edit map"],a.raw=["Edit map"],n.tr(a)),this.button.onclick=function(t){return e.editMapClick()},this.metroMap.publish(new Event("editmapend"));this._editMode=t;var i,a},enumerable:!0,configurable:!0}),t.prototype.addTo=function(t){var e=t.getMap();if(void 0===e)throw new Error("cannot add map editor to metro map: map is missing");this.metroMap=t;var r=document.querySelector(".leaflet-right.leaflet-top");return r?(r.appendChild(this.button),this.editMode=!1):console.error("cannot append to .leaflet-right.leaflet-top"),this},t.prototype.editMapClick=function(){this.editMode=!0,this.addMapListeners()},t.prototype.saveMapClick=function(){this.metroMap.publish(new Event("mapsave")),this.editMode=!1},t.prototype.addMapListeners=function(){var t=this;console.log("adding edit map listeners");var e,r,n,i=this.metroMap.getMap(),a=o.byId("dummy-circles");o.byId("paths-outer"),o.byId("paths-inner");a.addEventListener("mousedown",function(o){if(2!==o.button&&n){var a={source:n,target:o.target};console.log(a),t.metroMap.publish(new CustomEvent("span"===r?"spanend":"transferend",{detail:a})),n=null,r=void 0}else 0===o.button?(i.dragging.disable(),e=o.target,t.metroMap.publish(new MouseEvent("platformmovestart",{relatedTarget:o.target}))):1===o.button&&(console.log("foo",o.target),t.metroMap.publish(new MouseEvent("spanstart",{relatedTarget:o.target})))}),i.on("mousemove",function(r){if(e){var n=r.originalEvent,o=n.clientX,i=n.clientY,a={relatedTarget:e,clientX:o,clientY:i};t.metroMap.publish(new MouseEvent("platformmove",a))}}).on("mouseup",function(r){if(e){i.dragging.enable();var n={relatedTarget:e};t.metroMap.publish(new MouseEvent("platformmoveend",n)),e=null}}),this.metroMap.subscribe("spanstart",function(t){r="span",n=t.relatedTarget}),this.metroMap.subscribe("transferstart",function(t){r="transfer",n=t.relatedTarget}),this.metroMap.subscribe("platformaddclick",function(e){var r=e.clientX,n=e.clientY;t.metroMap.publish(new CustomEvent("platformadd",{detail:{clientX:r,clientY:n}}))}),this.metroMap.subscribe("platformaddtolineclick",function(e){t.metroMap.publish(new CustomEvent("platformadd",{detail:e}))})},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,r){"use strict";var n=r(1),o=r(8),i=r(0),a=r(18),s=i.sfx,u=i.algorithm.shortestRoute,l=function(){function t(){this.fromMarker=n.marker([0,0],{draggable:!0,icon:a.Icons.start}),this.toMarker=n.marker([0,0],{draggable:!0,icon:a.Icons.end}),this.addMarkerListeners()}return t.prototype.addTo=function(t){var e=this;this.metroMap=t;var r=t.getMap(),n=r.getCenter();return this.fromMarker.setLatLng(n),this.toMarker.setLatLng(n),a.cacheIcons(r,[this.fromMarker,this.toMarker]),t.subscribe("routefrom routeto",this.handleFromTo.bind(this)),t.subscribe("clearroute",function(t){return e.clearRoute()}),r.on("zoomstart",function(t){return s.Animation.terminateAnimations()}),addEventListener("keydown",function(e){27===e.keyCode&&t.publish(new Event("clearroute"))}),this},t.prototype.handleFromTo=function(t){var e=this.metroMap.getMap(),r=i.mouseToLatLng(e,t),n="routefrom"===t.type?this.fromMarker:this.toMarker;n.setLatLng(r),e.hasLayer(n)||e.addLayer(n);var o=n===this.fromMarker?this.toMarker:this.fromMarker;e.hasLayer(o)&&(i.fixFontRendering(),this.visualizeRouteBetween(this.fromMarker.getLatLng(),this.toMarker.getLatLng()))},t.prototype.addMarkerListeners=function(){for(var t=this,e=0,r=[this.fromMarker,this.toMarker];e<r.length;e++){var n=r[e];n.on("drag",function(e){return t.visualizeShortestRoute(!1)}).on("dragend",function(e){i.fixFontRendering(),t.visualizeShortestRoute()})}},t.prototype.visualizeShortestRoute=function(t){void 0===t&&(t=!0);var e=this.metroMap.getMap();e.hasLayer(this.fromMarker)&&e.hasLayer(this.toMarker)&&this.visualizeRouteBetween(this.fromMarker.getLatLng(),this.toMarker.getLatLng(),t)},t.prototype.visualizeRouteBetween=function(t,e,r){void 0===r&&(r=!0),i.resetStyle(),o.dismissAll(),s.visualizeRoute(u(this.metroMap.getNetwork().platforms,t,e),r)},t.prototype.clearRoute=function(){var t=this.metroMap.getMap(),e=s.Animation.terminateAnimations();t.removeLayer(this.fromMarker).removeLayer(this.toMarker),this.fromMarker.off("drag").off("dragend"),this.toMarker.off("drag").off("dragend"),o.dismissAll(),e.then(i.resetStyle)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=l},function(t,e,r){"use strict";var n=this&&this.__extends||function(t,e){function r(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)},o=r(1),i=r(33),a=r(12),s=r(54),u=function(t){function e(e,r){void 0===r&&(r=o.point(100,100));var n=t.call(this,e,r)||this;return n.overlayContainer=a.createSVGElement("svg"),n.overlayContainer.classList.add(s.overlay),n.defs=a.createSVGElement("defs"),n.overlayContainer.appendChild(n.defs),n.origin=a.createSVGElement("g"),n.origin.id="origin",n.origin.setAttribute("transform","translate("+n.margin.x+", "+n.margin.y+")"),n.overlayContainer.appendChild(n.origin),n}return n(e,t),e}(i.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=u},function(t,e,r){"use strict";var n=r(0),o=r(55),i=function(){function t(){this.element=n.svg.createSVGElement("g"),this._disabled=!1,this._editable=!1;var t=document.createElement("div");t.classList.add(o["plate-box"]);var e=n.svg.createSVGElement("foreignObject");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width","100%"),e.setAttribute("height","100%"),e.appendChild(t);var r=this.element;r.id="station-plate",r.style.display="none",r.appendChild(e)}return Object.defineProperty(t.prototype,"disabled",{get:function(){return this._disabled},set:function(t){t?this.hide():getSelection().removeAllRanges(),this._disabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editable",{get:function(){return this._editable},set:function(t){for(var e=t?"true":"false",r=this.element.childNodes[1].children[1],n=r.children,o=0,i=n;o<i.length;o++){var a=i[o];a.contentEditable=e}},enumerable:!0,configurable:!0}),t.prototype.show=function(t,e){if(!this.disabled&&"none"===this.element.style.display){var r=this.element.firstChild,n=r.firstChild;n.innerHTML=e.join("<br>"),this.element.setAttribute("transform","translate("+t.x+", "+t.y+")"),this.element.style.display=null;var o=n.getBoundingClientRect(),i=o.width,a=o.height;r.setAttribute("transform","translate("+-i+", "+-a+")"),console.log(r.getBoundingClientRect()),console.log(n.getBoundingClientRect())}},t.prototype.hide=function(){this.element.style.display="none"},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,r){"use strict";function n(t,e){void 0===e&&(e=250),setTimeout(function(){return i.fixFontRendering(t)},e)}var o=r(1),i=r(0),a=function(){function t(t,e){void 0===e&&(e=o.point(100,100)),this.margin=e.round(),this.bounds=t}return t.prototype.addTo=function(t){return this.onAdd(t),this},t.prototype.onAdd=function(t){this.map=t,this.minZoom=t.getMinZoom(),this.maxZoom=t.getMaxZoom(),this.updateOverlayPositioning();var e=t.getPanes(),r=e.objectsPane,n=e.markerPane,i=e.mapPane;("1"===o.version[0]?i:r).insertBefore(this.overlayContainer,n),this.addMapMovementListeners()},t.prototype.onRemove=function(t){var e=t.getPanes(),r=e.objectsPane,n=e.mapPane;("1"===o.version[0]?n:r).removeChild(this.overlayContainer),this.map.clearAllEventListeners()},t.prototype.addMapMovementListeners=function(){var t,e=this,r=this.map,a=r.getPanes(),s=a.mapPane,u=a.tilePane,l=a.overlayPane,c=this.overlayContainer,f=c.style,d=c.classList;r.on("zoomstart",function(t){d.add("leaflet-zoom-animated"),console.log("zoomstart",t),r.dragging.disable()}).on("zoomanim",function(r){console.log("zoomanim",r);var n=r,o=n.scale,a=n.origin;1!==o&&i.scaleOverlay(e.overlayContainer,o,t||a),t=null}).on("zoomend",function(t){console.log("zoomend",t),d.remove("leaflet-zoom-animated"),f.transform=null,f.transformOrigin=null,e.updateOverlayPositioning(),r.fireEvent("overlayupdate",e),r.dragging.enable()}).on("moveend",function(t){i.fixFontRendering(),"1"===o.version[0]?n(u.firstElementChild):l.hasChildNodes()&&n(l,0)});var h=function(e){return t=o.DomEvent.getMousePosition(e)};s.addEventListener("wheel",h);var p=document.querySelector(".leaflet-control-container");p?p.addEventListener("wheel",h):console.error("cannot append wheel to leaflet-control-container"),r.zoomControl.getContainer().addEventListener("mousedown",function(e){return t=o.point(innerWidth/2,innerHeight/2).round()},!0),r.on("dblclick",function(e){return t=o.DomEvent.getMousePosition(e.originalEvent)}),document.addEventListener("keydown",function(e){return t=o.point(innerWidth/2,innerHeight/2)})},t.prototype.updateOverlayPositioning=function(){var t=this.bounds.getNorthWest(),e=this.bounds.getSouthEast(),r=this,n=r.map,i=r.margin;this.topLeft=n.project(t).round();var a=o.bounds(n.latLngToLayerPoint(t),n.latLngToLayerPoint(e)),s=this.overlayContainer.style,u=a.min.subtract(i);s.left=u.x+"px",s.top=u.y+"px";var l=a.getSize().add(i).add(i);s.width=l.x+"px",s.height=l.y+"px"},t.prototype.extendBounds=function(t){this.bounds.extend(t),this.updateOverlayPositioning()},t.prototype.latLngToSvgPoint=function(t){return this.map.project(t).round().subtract(this.topLeft)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,r){"use strict";var n=function(){function t(){}return Object.defineProperty(t.prototype,"whenAvailable",{get:function(){return this._whenAvailable},enumerable:!0,configurable:!0}),t}();e.DeferredWidget=n},function(t,e,r){"use strict";var n=r(1);e.mapbox=n.tileLayer("https://{s}.tiles.mapbox.com/v3/inker.mlo91c41/{z}/{x}/{y}.png",{detectRetina:!1,attribution:'Map data &copy; <a href="https://openstreetmap.org">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://mapbox.com">Mapbox</a>'}),e.mapnik=n.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.osmFrance=n.tileLayer("http://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",{attribution:'&copy; Openstreetmap France | &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.openMapSurfer=n.tileLayer("http://korona.geog.uni-heidelberg.de/tiles/roads/x={x}&y={y}&z={z}",{attribution:'Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.hyddaBase=n.tileLayer("https://{s}.tile.openstreetmap.se/hydda/base/{z}/{x}/{y}.png",{detectRetina:!0,attribution:'Tiles courtesy of <a href="http://openstreetmap.se/" target="_blank">OpenStreetMap Sweden</a> &mdash; Map data &copy; <a href="http://server.ts.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.esriGrey=n.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ",detectRetina:!0}),e.cartoDB=n.tileLayer("http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'}),e.cartoDBNoLabels=n.tileLayer("http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'}),e.wikimapia=n.tileLayer("http://i{hash}.wikimapia.org/?x={x}&y={y}&zoom={z}",{hash:function(t){return t.x%4+t.y%4*4}})},function(t,e,r){"use strict";var n=function(){function t(){this.eventListeners=new Map}return t.prototype.subscribe=function(t,e){for(var r=0,n=t.split(/\s+/);r<n.length;r++){var o=n[r],i=this.eventListeners.get(o);void 0===i?this.eventListeners.set(o,[e]):i.push(e)}},t.prototype.unsubscribe=function(t,e){var r=this.eventListeners.get(t);if(void 0!==r){var n=r.indexOf(e);n<0||r.splice(n,1)}},t.prototype.publish=function(t){console.log("event as seen from the dispatcher",t);var e=this.eventListeners.get(t.type);if(void 0===e||0===e.length)return console.log("no event listeners registered for "+t.type),!1;for(var r=0,n=e;r<n.length;r++){var o=n[r];o(t)}return!0},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=n},function(t,e,r){"use strict";function n(t,e){if(e.platforms.length<3)return[];var r=e.platforms;if(3===r.length){for(var n=0,o=e.platforms;n<o.length;n++){var i=o[n];if(2!==t.transfers.filter(function(t){return t.has(i)}).length)return[]}return r}if(4===r.length){var a=(t.platforms,t.transfers),u=r.map(function(t){return{platform:t,degree:a.filter(function(e){return e.has(t)}).length}}).sort(function(t,e){return t.degree-e.degree}),l=u.map(function(t){return t.degree}),c=u.map(function(t){return t.platform});if(s.isEqual(l,[2,2,3,3]))return c;if(s.isEqual(l,[1,2,2,3]))return c.slice(1)}return[]}function o(t,e,r){for(var n=new Map,o=new Map,a=0,s=t;a<s.length;a++){var b=s[a],w=b.spans.some(function(t){return t.routes[0].line.startsWith("E")}),_=f(e,b.location),x=_/d;n.set(b,x+(w?y:g)),_=f(b.location,r),x=_/d,o.set(b,x)}for(var k=l.findClosestObject(e,t),L=new Set(t),E=new Map;L.size>0;){var M=1/0;L.forEach(function(t){var e=c.tryGetFromMap(n,t);e<M&&(k=t,M=e)}),L.delete(k);for(var S=[],A=[],T=0,C=k.spans;T<C.length;T++){var O=C[T],B=O.other(k);if(L.has(B)){S.push(B);var _=f(k.location,B.location),P=0,j=O.routes[0].line.startsWith("E")?v:m,R=u.timeToTravel(_,h,p);A.push(R+j+P)}}for(var F=0,I=k.station.platforms;F<I.length;F++){var B=I[F];if(L.has(B)){S.push(B);var w=B.spans.some(function(t){return t.routes[0].line.startsWith("E")}),_=f(k.location,B.location)/2;A.push(_/d+(w?y:g))}}for(var N=0,G=S.length;N<G;++N){var B=S[N],D=n.get(k)+A[N];D<n.get(B)&&(n.set(B,D),E.set(B,k))}n.get(k)+o.get(k)}var z=1/0;n.forEach(function(t,e){var r=n.get(e)+o.get(e);r<z&&(z=r,k=e)});var U=f(e,r)/d;if(U<z)return{time:{walkTo:U}};for(var V=[],W=[k],q=E.get(k);void 0!==q&&void 0!==q;q=E.get(k)){for(var J=void 0,K=0,Z=k.spans;K<Z.length;K++){var O=Z[K];if(O.has(q)){J=O;break}}if(void 0===J)for(var H=0,Q=k.transfers;H<Q.length;H++){var Y=Q[H];if(Y.has(q)){J=Y;break}}if(void 0===J){var X=i(q,k),$=X.transfers,tt=X.midPlatforms;V.push.apply(V,$.reverse()),W.push.apply(W,tt)}else V.push(J);W.push(q),k=q}W.reverse(),V.reverse();var et=o.get(W[W.length-1]),rt=c.tryGetFromMap(n,W[0]);return{platforms:W,edges:V,time:{walkTo:rt,metro:z-et-rt,walkFrom:et,total:z}}}function i(t,e){if(t.station!==e.station)throw new Error("platforms ("+t.name+" & "+e.name+" must be on the same station");for(var r=t.station,n=r.platforms,o=new Set(n),i=new Map,a=new Map,s=0,u=n;s<u.length;s++){var l=u[s];i.set(l,1/0)}i.set(t,0);for(var d=t;o.size>0;){var h=1/0;o.forEach(function(t){var e=c.tryGetFromMap(i,t);e<h&&(d=t,h=e)}),o.delete(d);for(var p=d.transfers.map(function(t){return t.other(d)}),m=0,v=p;m<v.length;m++){var g=v[m];if(g&&o.has(g)){var y=f(d.location,g.location),b=i.get(d)+y;b<i.get(g)&&(i.set(g,b),a.set(g,d))}}}var w=[],_=[];d=e;for(var x=function(){var t=a.get(d);if(!t)return"break";var e=d.transfers.find(function(e){return e.has(t)});return e?(w.push(e),d=t,void _.push(d)):(console.error("cannot find transfer node"),"continue")};;){var k=x();if("break"===k)break}return _.pop(),{transfers:w.reverse(),midPlatforms:_.reverse()}}var a=r(1),s=r(3),u=r(11),l=r(10),c=r(0);e.findCycle=n;var f=function(t,e){return a.LatLng.prototype.distanceTo.call(t,e)},d=1,h=20,p=.7,m=25,v=40,g=240,y=360;e.shortestRoute=o},function(t,e,r){"use strict";function n(t){var e=t.match(/[0-9a-f]{1,2}/gi);return e?e.map(function(t){return parseInt(t,16)}):[]}function o(t){var e=t.match(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i);return e?e.slice(1).map(Number):[]}function i(t){var e=function(t,e){return(e.startsWith("#")?n:o)(e).map(function(e,r){return t[r]+e})},r=t.reduce(e,[0,0,0]).map(function(e){return Math.floor(e/t.length)}),i=r[0],a=r[1],s=r[2];return"rgb("+i+", "+a+", "+s+")"}e.mean=i},function(t,e,r){"use strict";function n(t,e,r){var n=r.value;return r.value=function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];console.time(e),n.apply(this,t),console.timeEnd(e)},r}function o(t,e,r){var n=r.value;if(null===n)throw new Error(e+" is not a method");var o=new Map;r.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=JSON.stringify(t),i=o.get(r);if(void 0!==i)return i;var a=n.apply(this,t);return o.set(r,a),a}}e.time=n,e.MemoizeWithParameters=o},function(t,e,r){"use strict";(function(t){function n(t,e){var r=document.createElement("a");r.href=e,r.download=t,r.click()}function o(t,e){var r=URL.createObjectURL(e);n(t,r),URL.revokeObjectURL(r)}function i(t,e){o(t,new Blob([e],{type:"octet/stream"}))}function a(t,e,r){s(e,r).then(function(e){return n(t,e)})}function s(t,e){return u(t).then(function(t){return t.toDataURL("image/"+e)})}function u(e){return new t(function(t,r){var n=c(e,!0);n.onload=function(e){var o=document.createElement("canvas");o.width=n.width,o.height=n.height;var i=o.getContext("2d");return i?(i.drawImage(n,0,0),void t(o)):r(new Error("2d context does not exist on canvas"))}})}function l(t){var e=s(t,"png"),r=document.createElement("img");return r.width=parseInt(t.getAttribute("width")||"")||parseInt(t.style.width||""),r.height=parseInt(t.getAttribute("height")||"")||parseInt(t.style.height||""),e.then(function(t){return r.src=t,r})}function c(t,e){void 0===e&&(e=!1),e&&(t=d(t));var r=document.createElement("img");return r.width=parseInt(t.getAttribute("width")||"")||parseInt(t.style.width||""),r.height=parseInt(t.getAttribute("height")||"")||parseInt(t.style.height||""),r.src=f(t),r}function f(t){return"data:image/svg+xml;base64,"+btoa((new XMLSerializer).serializeToString(t))}function d(t){for(var e=t.cloneNode(!0),r=e.querySelectorAll("[id^=dummy]"),n=0,o=r.length;n<o;++n){var i=r[n],a=i.parentNode;a&&a.removeChild(i)}e.style.left=e.style.top="";var s=e.querySelector("#station-plate");if(s){var u=s.parentNode;u&&u.removeChild(s)}var l=document.createElement("style");l.textContent=h.getStyleRulesAsText();var c=e.querySelector("defs");return c&&c.insertBefore(l,c.firstChild),e}var h=r(7);e.download=n,e.downloadBlob=o,e.downloadText=i,e.downloadSvgAsPicture=a,e.svgToPictureDataUrl=s,e.svgToCanvas=u,e.svgToPicture=l,e.svgToImg=c,e.svgToDataUrl=f}).call(e,r(2))},function(t,e,r){"use strict";(function(t){function n(t,e){return void 0===e&&(e=!0),s(this,void 0,void 0,function(){var r,n,a,s,c,f,d,p,g,y,b;return u(this,function(u){switch(u.label){case 0:return r=t.platforms,n=void 0===r?[]:r,a=t.edges,s=t.time,c=h.formatTime(s.walkTo),void 0===a?[2,l.success((y=[""," on foot!"],y.raw=[""," on foot!"],h.tr(y,c)))]:[4,v.terminateAnimations()];case 1:for(u.sent(),f=0,d=document.querySelectorAll(m);f<d.length;f++)p=d[f].style,p.filter=null,p.opacity="0.25";return e?[4,v.animateRoute(n,a,1)]:(o(a),i(n),[2]);case 2:return g=u.sent(),g&&l.message((b=["TIME:<br>"," on foot<br>"," by metro<br>"," on foot<br>TOTAL: ",""],b.raw=["TIME:<br>"," on foot<br>"," by metro<br>"," on foot<br>TOTAL: ",""],h.tr(b,c,h.formatTime(s.metro),h.formatTime(s.walkFrom),h.formatTime(s.total))),10),[2]}})})}function o(t){for(var e=0,r=t;e<r.length;e++){var n=r[e],o=c.default.outerEdgeBindings.get(n);if(void 0!==o){o.style.opacity=null;var i=c.default.innerEdgeBindings.get(n);void 0!==i&&(i.style.opacity=null),n instanceof f.Span&&d.Filters.applyDrop(o)}}}function i(t){for(var e=0,r=t;e<r.length;e++){var n=r[e],o=c.default.platformBindings.get(n);o&&(o.style.opacity=null)}}var a,s=this&&this.__awaiter||function(e,r,n,o){return new(n||(n=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new n(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,r||[])).next())})},u=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){s.label=r[1];break}if(6===r[0]&&s.label<a[1]){s.label=a[1],a=r;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(r);break}a[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}},l=r(8),c=r(15),f=r(16),d=r(12),h=r(4),p=r(0),m=["paths-inner","paths-outer","transfers-inner","transfers-outer","station-circles"].map(function(t){return"#"+t+" *"}).join(", ");!function(t){function e(t,e,r){if(void 0===r&&(r=!1),!r)return void(t.style.transform="scale("+e+")");o.add(t);var n=t.getAttribute("r");n&&t.setAttribute("data-r",n),t.setAttribute("r",(+n*e).toString())}function r(t,r,n){for(var o=parseFloat(p.byId("transfers-outer").style.strokeWidth||""),a=parseFloat(p.byId("transfers-inner").style.strokeWidth||""),s=0,u=t.platforms;s<u.length;s++){var l=u[s],f=p.tryGetFromMap(c.default.platformBindings,l);if(e(f,r,!0),n&&!(t.platforms.length<2))for(var d=0,h=n;d<h.length;d++){var m=h[d];if(m.has(l)){var v=c.default.outerEdgeBindings.get(m),g=c.default.innerEdgeBindings.get(m);i.add(v),i.add(g),v.style.strokeWidth=o*r+"px",g.style.strokeWidth=a*r+"px"}}}}function n(){o.forEach(function(t){var e=t.getAttribute("data-r");null!==e&&t.setAttribute("r",e)}),i.forEach(function(t){return t.style.strokeWidth=null}),i.clear(),o.clear()}var o=new Set,i=new Set;t.scaleCircle=e,t.scaleStation=r,t.unscaleAll=n}(a=e.Scale||(e.Scale={}));var v,g=L.Browser.webkit&&!L.Browser.mobile;
!function(e){function r(){return null===s?t.resolve(!0):(i=!1,s)}function n(e,n,a){return void 0===a&&(a=1),s=r().then(function(r){return new t(function(t,r){return function r(s){if(!i)return t(!1);var u=p.tryGetFromMap(c.default.platformBindings,e[s]);if(u.style.opacity=null,g&&o(u,s<n.length?1.5:3,200),s===n.length)return t(!0);var l=c.default.outerEdgeBindings.get(n[s]);if(!l)return r(s+1);var f=c.default.innerEdgeBindings.get(n[s]),h=l.cloneNode(!0),m=void 0===f?void 0:f.cloneNode(!0),v=p.byId("paths-outer");v.appendChild(h);var y=p.byId("paths-inner");m&&y.appendChild(m);var b;if(h instanceof SVGPathElement)b=h.getTotalLength();else{var w=L.point(+h.getAttribute("x1"),+h.getAttribute("y1")),_=L.point(+h.getAttribute("x2"),+h.getAttribute("y2"));b=w.distanceTo(_)}var x=n[s],k=x.source===e[s]?b:-b,E=b/a;d.Filters.applyDrop(h);for(var M=0,S=void 0===m?[h]:[h,m];M<S.length;M++){var A=S[M],T=A.style;T.transition=null,T.opacity=null,T.strokeDasharray=b+" "+b,T.strokeDashoffset=k.toString(),A.getBoundingClientRect(),T.transition="stroke-dashoffset "+E+"ms linear",T.strokeDashoffset="0"}h.addEventListener("transitionend",function(t){l.style.opacity=null,"t"!==h.id.charAt(1)&&d.Filters.applyDrop(l),v.removeChild(h),m&&(f.style.opacity=null,y.removeChild(m)),r(s+1)})}(0)}).then(function(t){return s=null,i=!0,t})})}function o(t,e,r){t.getBoundingClientRect(),t.style.transition="transform "+r/2+"ms linear",a.scaleCircle(t,e),t.addEventListener("transitionend",function t(e){this.removeEventListener("transitionend",t),this.style.transform="scale(1)",this.addEventListener("transitionend",function t(e){this.removeEventListener("transitionend",t),this.style.transition=null,this.style.transform=null})})}var i=!0,s=null;e.terminateAnimations=r,e.animateRoute=n,e.pulsateCircle=o}(v=e.Animation||(e.Animation={})),e.visualizeRoute=n,e.rehighlightEdges=o,e.rehighlightPlatforms=i}).call(e,r(2))},function(t,e,r){e=t.exports=r(5)(),e.push([t.i,'.ui-ContextMenu-___style__contextmenu___1C6e0 {\r\n    position: fixed;\r\n    left: 0;\r\n    top: 0;\r\n    z-index: 10000;\r\n    background-color: white;\r\n    box-shadow: 0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22);\r\n    font-family: "Segoe UI", Tahoma, Ubuntu, Cambay, Roboto, sans-serif;\r\n    font-size: 0.7em;\r\n    margin-left: 1px; /* so that the first element is not automatically selected */\r\n    border-collapse: collapse;\r\n    transform-origin: 0 0;\r\n    -moz-user-select: none;\r\n    -khtml-user-select: none;\r\n    -webkit-user-select: none;\r\n    -ms-user-select: none;\r\n    user-select: none;\r\n}\r\n\r\n@media only screen and (max-device-width: 400px) and (-webkit-min-device-pixel-ratio: 2) {\r\n    .ui-ContextMenu-___style__contextmenu___1C6e0 {\r\n        font-size: 1.2em;\r\n    }\r\n} \r\n\r\n.ui-ContextMenu-___style__contextmenu___1C6e0 div {\r\n    padding: 5px;\r\n    cursor: default;\r\n}\r\n\r\n.ui-ContextMenu-___style__contextmenu___1C6e0 div[disabled] {\r\n    color: grey;\r\n    /*cursor: not-allowed*/\r\n}\r\n\r\n.ui-ContextMenu-___style__contextmenu___1C6e0 div:not([disabled]):hover {\r\n    background-color: #82B1FF;\r\n    /*color: #ffffff;*/\r\n}',""]),e.locals={contextmenu:"ui-ContextMenu-___style__contextmenu___1C6e0"}},function(t,e,r){e=t.exports=r(5)(),e.push([t.i,"\r\n.ui-FAQ-___style__faq-card___kG3d9 {\r\n    position: absolute;\r\n    top: 5%;\r\n    bottom: 5%;\r\n    right: 5%;\r\n    left: 5%;\r\n    width: 50%;\r\n    margin: 0 auto;\r\n    padding: 1%;\r\n    display: none;\r\n    background-color: white;\r\n    border-radius: 4px;\r\n    box-shadow: 0 19px 38px rgba(0,0,0,0.30), 0 15px 12px rgba(0,0,0,0.22);\r\n    font-family: Roboto, Calibri, Helvetica, sans-serif;\r\n    overflow-y: scroll;\r\n    transition-property: transform opacity;\r\n    transition-duration:  200ms;\r\n}\r\n\r\n@media only screen and (max-width: 1000px) {\r\n    .ui-FAQ-___style__faq-card___kG3d9 {\r\n        max-width: 500px;\r\n        width: 90%;\r\n    }\r\n}\r\n\r\n.ui-FAQ-___style__cross-ball___1Mutj {\r\n    float: right;\r\n    height: 12mm;\r\n    width: 12mm;\r\n    line-height: 12mm;\r\n    border-radius: 50%;\r\n    background: #E91E63;\r\n    color: white;\r\n    /*font-size: 12mm;*/\r\n    font-weight: bold;\r\n    text-align: center;\r\n    /* not selectabled */\r\n    -webkit-user-select: none;\r\n    user-select: none;\r\n    cursor: pointer;\r\n}\r\n\r\n.ui-FAQ-___style__cross-ball___1Mutj:hover {\r\n    filter: grayscale(0.1) opacity(0.8);\r\n    -webkit-filter: grayscale(0.1) opacity(0.8);\r\n}\r\n\r\n.ui-FAQ-___style__question___3KU2d {\r\n    font-weight: bold;\r\n    display: block;\r\n    margin-top: 1%;\r\n}\r\n\r\n.ui-FAQ-___style__answer___KxEAc {\r\n    display: block;\r\n    padding-bottom: 1%;\r\n    border-bottom: #cccccc 1px solid;\r\n}",""]),e.locals={"faq-card":"ui-FAQ-___style__faq-card___kG3d9","cross-ball":"ui-FAQ-___style__cross-ball___1Mutj",question:"ui-FAQ-___style__question___3KU2d",answer:"ui-FAQ-___style__answer___KxEAc"}},function(t,e,r){e=t.exports=r(5)(),e.push([t.i,".ui-MapEditor-___style__edit-map-button___250xP[disabled] {\r\n    cursor: not-allowed;\r\n}",""]),e.locals={"edit-map-button":"ui-MapEditor-___style__edit-map-button___250xP"}},function(t,e,r){e=t.exports=r(5)(),e.push([t.i,".ui-SvgOverlay-___style__overlay___2kdYy {\r\n    width: 100%;\r\n    height: 100%;\r\n    position: relative;\r\n    z-index: 5;\r\n    /*will-change: transform;*/ /*blurs fonts */\r\n}",""]),e.locals={overlay:"ui-SvgOverlay-___style__overlay___2kdYy"}},function(t,e,r){e=t.exports=r(5)(),e.push([t.i,".ui-TextPlate-___style__plate-box___3BeUy {\r\n    color: #000000;\r\n    text-anchor: end;\r\n    text-align: right;\r\n    font-family: Corbel, Candara, Calibri, Ubuntu, sans-serif;\r\n    font-weight: bold;\r\n    opacity: 1;\r\n    -webkit-user-select: none;\r\n    user-select: none;\r\n    \r\n    white-space: nowrap;\r\n    /*border-radius: 2px;*/\r\n    box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);\r\n    /*filter: url(#shadow);*/\r\n    background-color: white; /* for div */\r\n    padding: 1px 3px 1px 3px;\r\n    line-height: 1.3em;\r\n    display: inline-block;\r\n    /*float: left;*/\r\n}",""]),e.locals={"plate-box":"ui-TextPlate-___style__plate-box___3BeUy"}},function(t,e,r){"use strict";t.exports=r(48)},function(t,e,r){"use strict";var n=function(){function t(t){var e=this;this.left=new Map(t),this.right=new Map,this.left.forEach(function(t){return e.right.set(t)})}return t.prototype.clear=function(){this.left.clear(),this.right.clear()},t.prototype.delete=function(t){var e=this.left.get(t);return!!this.right.has(e)&&(this.right.delete(e),this.left.delete(t))},t.prototype.entries=function(){return this.left.entries()},t.prototype.forEach=function(t,e){this.left.forEach(t,e)},t.prototype.get=function(t){return this.left.get(t)},t.prototype.has=function(t){return this.left.has(t)},t.prototype.keys=function(){return this.left.keys()},t.prototype.set=function(t,e){var r=this.left.get(t),n=this.right.get(e);return this.left.has(t)&&this.right.delete(r),this.right.has(e)&&this.left.delete(n),this.left.set(t,e),this.right.set(e,t),this},Object.defineProperty(t.prototype,"size",{get:function(){return this.left.size},enumerable:!0,configurable:!0}),t.prototype.values=function(){return this.left.values()},t.prototype[Symbol.iterator]=function(){return this.left[Symbol.iterator]()},Object.defineProperty(t.prototype,Symbol.toStringTag,{get:function(){return this.left[Symbol.toStringTag]},enumerable:!0,configurable:!0}),t.prototype.deleteValue=function(t){var e=this.right.get(t);return!!this.left.has(e)&&(this.left.delete(e),this.right.delete(t))},t.prototype.getKey=function(t){return this.right.get(t)},t.prototype.hasValue=function(t){return this.right.has(t)},t}();e.BiMap=n;var o=function(){function t(t){if(this.left=new WeakMap,this.right=new WeakMap,void 0!==t)for(var e=0,r=t;e<r.length;e++){var n=r[e],o=n[0],i=n[1];this.left.set(o,i),this.right.set(i,o)}}return t.prototype.clear=function(){console.error("method clear is deprecated")},t.prototype.delete=function(t){var e=this.left.get(t);return!!this.right.has(e)&&(this.right.delete(e),this.left.delete(t))},t.prototype.get=function(t){return this.left.get(t)},t.prototype.has=function(t){return this.left.has(t)},t.prototype.set=function(t,e){var r=this.left.get(t),n=this.right.get(e);return this.left.has(t)&&this.right.delete(r),this.right.has(e)&&this.left.delete(n),this.left.set(t,e),this.right.set(e,t),this},Object.defineProperty(t.prototype,Symbol.toStringTag,{get:function(){return this.left[Symbol.toStringTag]},enumerable:!0,configurable:!0}),t.prototype.deleteValue=function(t){var e=this.right.get(t);return!!this.left.has(e)&&(this.left.delete(e),this.right.delete(t))},t.prototype.getKey=function(t){return this.right.get(t)},t.prototype.hasValue=function(t){return this.right.has(t)},t}();e.WeakBiMap=o},function(t,e){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function o(t){if(c===setTimeout)return setTimeout(t,0);if((c===r||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function i(t){if(f===clearTimeout)return clearTimeout(t);if((f===n||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function a(){m&&h&&(m=!1,h.length?p=h.concat(p):v=-1,p.length&&s())}function s(){if(!m){var t=o(a);m=!0;for(var e=p.length;e;){for(h=p,p=[];++v<e;)h&&h[v].run();v=-1,e=p.length}h=null,m=!1,i(t)}}function u(t,e){this.fun=t,this.array=e}function l(){}var c,f,d=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:r}catch(t){c=r}try{f="function"==typeof clearTimeout?clearTimeout:n}catch(t){f=n}}();var h,p=[],m=!1,v=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];p.push(new u(t,e)),1!==p.length||m||o(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=l,d.addListener=l,d.once=l,d.off=l,d.removeListener=l,d.removeAllListeners=l,d.emit=l,d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},,function(t,e,r){var n=r(42);"string"==typeof n&&(n=[[t.i,n,""]]);r(6)(n,{});n.locals&&(t.exports=n.locals)},function(t,e,r){var n=r(43);"string"==typeof n&&(n=[[t.i,n,""]]);r(6)(n,{});n.locals&&(t.exports=n.locals)},function(t,e,r){var n=r(44);"string"==typeof n&&(n=[[t.i,n,""]]);r(6)(n,{});n.locals&&(t.exports=n.locals)},function(t,e,r){var n=r(45);"string"==typeof n&&(n=[[t.i,n,""]]);r(6)(n,{});n.locals&&(t.exports=n.locals)},function(t,e,r){var n=r(46);"string"==typeof n&&(n=[[t.i,n,""]]);r(6)(n,{});n.locals&&(t.exports=n.locals)},function(t,e){},function(t,e,r){"use strict";(function(t){var e=this&&this.__awaiter||function(e,r,n,o){return new(n||(n=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new n(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,r||[])).next())})},n=this&&this.__generator||function(t,e){function r(t){return function(e){return n([t,e])}}function n(r){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&r[0]?"return":r[0]?"throw":"next"])&&!(a=a.call(i,r[1])).done)return a;switch(i=0,a&&(r=[0,a.value]),r[0]){case 0:case 1:a=r;break;case 4:return s.label++,{value:r[1],done:!1};case 5:s.label++,i=r[1],r=[0];continue;case 7:r=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===r[0]||2===r[0])){s=0;continue}if(3===r[0]&&(!a||r[1]>a[0]&&r[1]<a[3])){s.label=r[1];break}if(6===r[0]&&s.label<a[1]){s.label=a[1],a=r;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(r);break}a[2]&&s.ops.pop(),s.trys.pop();continue}r=e.call(t,s)}catch(t){r=[6,t],i=0}finally{o=a=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:r(0),throw:r(1),return:r(2)}},o=this,i=r(3),a=r(7),s=r(4),u=r(20);L.Icon.Default.imagePath="http://cdn.leafletjs.com/leaflet/v0.7.7/images",L.Browser.ie&&alert("Does not work in IE (yet)");var l=location.search.match(/city=(\w+)/),c=l?l[1]:"spb";!function(){return e(o,void 0,void 0,function(){var t,e,r,o,l;return n(this,function(n){switch(n.label){case 0:return[4,a.getConfig()];case 1:for(t=n.sent(),e=s.updateDictionary(t.url.dictionary),r=0,o=Object.keys(t.url);r<o.length;r++)l=o[r],t.url[l]=t.url[l].replace(/\{city\}/g,c);return document.title=s.translate((c&&"spb"!==c?i.capitalize(c):"St Petersburg")+" metro plan proposal"),[4,e];case 2:return n.sent(),document.title=s.translate(document.title),new u.default(t),[2]}})})}()}).call(e,r(2))}],[57]);
//# sourceMappingURL=app.js.map