webpackJsonp([0],[function(t,e,n){"use strict";(function(t){function r(t,e){var n=t.size;if(n!==e.size)return!1;for(var r=t.values(),o=r.next();!o.done;o=r.next())if(!e.has(o.value))return!1;return!0}function o(t,e){var n=new Set;return t.forEach(function(t){e.has(t)&&n.add(t)}),n}function i(t,e){var n=t.indexOf(e);n<0||(t[n]=t[t.length-1],t.pop())}function a(t){for(var e=t.toString(),n=e.length%3,r=n>0?[e.slice(0,n)]:[],o=e.length%3;o<e.length;o+=3)r.push(e.substr(o,3));return r.join("'")}function s(t,e){return O.point(+t.x.toFixed(e),+t.y.toFixed(e))}function u(t,e){return void 0===e&&(e=10),t.toString(e).split(".")[1]||"0"}function l(t){var e=Math.random().toString(36).slice(2);return t&&t(e)?l(t):e}function c(t,e){var n=t.getContainer().getBoundingClientRect(),r=O.point(e.clientX-n.left,e.clientY-n.top);return t.containerPointToLatLng(r)}function f(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t?t.apply(void 0,e):void 0}function d(t,e,n){t.addEventListener(e,function r(o){t.removeEventListener(e,r),n(o)})}function h(t){function e(){removeEventListener("keydown",n),removeEventListener("backbutton",r)}var n=function(n){27===n.keyCode&&(e(),t(n))},r=function(n){e(),t(n)};addEventListener("keydown",n),addEventListener("backbutton",r)}function p(){for(var t=document.querySelectorAll(U),e=0;e<t.length;++e){var n=t[e];n.style.opacity=null,"t"!==n.id[1]&&(n.style.filter=null)}}function m(t,e){var n=document.createEvent("MouseEvents");n.initEvent(e,!0,!0),t.dispatchEvent(n)}function v(t){var e=t.name,n=t.altNames,r=M(),o=[e];return r&&n[r]&&o.push(n[r]),n.en&&o.push(n.en),o}function g(t){var e=t.map(v);return console.log("pl",e),[0,1,2].map(function(n){return t.map(function(t,r){return e[r][n]})}).map(function(t){return B.uniq(t).reduce(function(t,e){return t+" / "+e})}).filter(function(t){return void 0!==t})}function y(t,e){var n=e.map(function(e){return t.distanceTo(e)}),r=e[1].subtract(e[0]).multiplyBy(n[0]/(n[0]+n[1])).add(e[0]),o=t.subtract(r);return e.map(function(t){return s(t.add(o),2)})}function b(t){var e=t.style,n=e.transform;n&&(e.transform=n.replace(/translate3d\s*\((.+?,\s*.+?),\s*.+?\s*\)/i,"translate($1)"))}function w(t,e){var n=0;setInterval(function(){return document.title=t[++n%t.length]},e)}function _(t,e,n){var r=t.getBoundingClientRect();if(!n){var o=document.documentElement;n=O.point(o.clientWidth/2,o.clientHeight/2)}var i=O.point(n.x-r.left,n.y-r.top),a=O.point(i.x/r.width,i.y/r.height),s=t.style;s.transformOrigin=100*a.x+"% "+100*a.y+"%",s.transform="scale("+e+")"}function x(t,n,r,o){return void 0===r&&(r=100),void 0===o&&(o=100),A(this,void 0,void 0,function(){var i,a;return C(this,function(s){switch(s.label){case 0:i=0,s.label=1;case 1:return i<o?(a=t(),!n||n(a)?[2,a]:[4,e.delay(r)]):[3,4];case 2:s.sent(),s.label=3;case 3:return++i,[3,1];case 4:throw new Error("rejected")}})})}function k(t,e,n){void 0===e&&(e=100),void 0===n&&(n=100);var r=t.slice(1),o="#"===t[0]?function(){return document.getElementById(r)}:function(){return document.querySelector(t)};return x(o,function(t){return null!==t},e,n)}function L(t){for(var e;e=t.firstChild;)t.removeChild(e)}function E(t){void 0===t&&(t=document);var e=t.querySelectorAll('[style*="translate3d"]');console.log("fixing font",t,e);for(var n=0,r=e;n<r.length;n++){var o=r[n];b(o)}}function M(){var t=window.location.search.match(/city=(\w+)/),e=t?t[1]:"spb",n={spb:"fi",qazan:"tt",helsinki:"se"};return n[e]}function S(t,e){var n=t.get(e);if(void 0===n)throw console.error("in map",t,":",e,"->",n),new Error("key or val is undefined");return n}function T(t){var e=document.getElementById(t);if(!e)throw new Error("no element with id="+t+" exists");return e}var A=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,n)).next())})},C=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},O=n(1),B=n(3),P=n(37);e.algorithm=P;var j=n(39);e.decorators=j;var R=n(10);e.geo=R;var N=n(11);e.math=N;var I=n(36);e.Mediator=I.default;var F=n(41);e.sfx=F;var G=n(12);e.svg=G;var D=n(40);e.file=D;var z=n(38);e.color=z;var U=["paths-inner","paths-outer","transfers-inner","transfers-outer","station-circles"].map(function(t){return"#"+t+" > *"}).join(", ");e.setsEqual=r,e.intersection=o,e.deleteFromArray=i,e.formatInteger=a,e.roundPoint=s,e.getFraction=u,e.generateId=l,e.mouseToLatLng=c,e.callMeMaybe=f,e.once=d,e.onceEscapePress=h,e.resetStyle=p,e.triggerMouseEvent=m,e.getPlatformNames=v,e.getPlatformNamesZipped=g,e.midPointsToEnds=y,e.trim3d=b,e.flashTitle=w,e.scaleOverlay=_,e.delay=function(e){return new t(function(t,n){return setTimeout(t,e)})},e.tryGet=x,e.tryGetElement=k,e.removeAllChildren=L,e.fixFontRendering=E,e.getSecondLanguage=M,e.tryGetFromMap=S,e.byId=T}).call(e,n(2))},,function(t,e,n){(function(e,r,o){!function(e,n){t.exports=n()}(this,function(){"use strict";function t(t){return"function"==typeof t||"object"==typeof t&&null!==t}function r(t){return"function"==typeof t}function i(t){K=t}function a(t){Q=t}function s(){return function(){return e.nextTick(d)}}function u(){return"undefined"!=typeof Z?function(){Z(d)}:f()}function l(){var t=0,e=new $(d),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function c(){var t=new MessageChannel;return t.port1.onmessage=d,function(){return t.port2.postMessage(0)}}function f(){var t=setTimeout;return function(){return t(d,1)}}function d(){for(var t=0;t<J;t+=2){var e=nt[t],n=nt[t+1];e(n),nt[t]=void 0,nt[t+1]=void 0}J=0}function h(){try{var t=n(55);return Z=t.runOnLoop||t.runOnContext,u()}catch(t){return f()}}function p(t,e){var n=arguments,r=this,o=new this.constructor(v);void 0===o[ot]&&R(o);var i=r._state;return i?!function(){var t=n[i-1];Q(function(){return B(i,o,t,r._result)})}():T(r,o,t,e),o}function m(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(v);return L(n,t),n}function v(){}function g(){return new TypeError("You cannot resolve a promise with itself")}function y(){return new TypeError("A promises callback cannot return that same promise.")}function b(t){try{return t.then}catch(t){return ut.error=t,ut}}function w(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}function _(t,e,n){Q(function(t){var r=!1,o=w(n,e,function(n){r||(r=!0,e!==n?L(t,n):M(t,n))},function(e){r||(r=!0,S(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&o&&(r=!0,S(t,o))},t)}function x(t,e){e._state===at?M(t,e._result):e._state===st?S(t,e._result):T(e,void 0,function(e){return L(t,e)},function(e){return S(t,e)})}function k(t,e,n){e.constructor===t.constructor&&n===p&&e.constructor.resolve===m?x(t,e):n===ut?S(t,ut.error):void 0===n?M(t,e):r(n)?_(t,e,n):M(t,e)}function L(e,n){e===n?S(e,g()):t(n)?k(e,n,b(n)):M(e,n)}function E(t){t._onerror&&t._onerror(t._result),A(t)}function M(t,e){t._state===it&&(t._result=e,t._state=at,0!==t._subscribers.length&&Q(A,t))}function S(t,e){t._state===it&&(t._state=st,t._result=e,Q(E,t))}function T(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+at]=n,o[i+st]=r,0===i&&t._state&&Q(A,t)}function A(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,a=0;a<e.length;a+=3)r=e[a],o=e[a+n],r?B(n,r,o,i):o(i);t._subscribers.length=0}}function C(){this.error=null}function O(t,e){try{return t(e)}catch(t){return lt.error=t,lt}}function B(t,e,n,o){var i=r(n),a=void 0,s=void 0,u=void 0,l=void 0;if(i){if(a=O(n,o),a===lt?(l=!0,s=a.error,a=null):u=!0,e===a)return void S(e,y())}else a=o,u=!0;e._state!==it||(i&&u?L(e,a):l?S(e,s):t===at?M(e,a):t===st&&S(e,a))}function P(t,e){try{e(function(e){L(t,e)},function(e){S(t,e)})}catch(e){S(t,e)}}function j(){return ct++}function R(t){t[ot]=ct++,t._state=void 0,t._result=void 0,t._subscribers=[]}function N(t,e){this._instanceConstructor=t,this.promise=new t(v),this.promise[ot]||R(this.promise),H(e)?(this._input=e,this.length=e.length,this._remaining=e.length,this._result=new Array(this.length),0===this.length?M(this.promise,this._result):(this.length=this.length||0,this._enumerate(),0===this._remaining&&M(this.promise,this._result))):S(this.promise,I())}function I(){return new Error("Array Methods must be provided an Array")}function F(t){return new N(this,t).promise}function G(t){var e=this;return new e(H(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(new TypeError("You must pass an array to race."))})}function D(t){var e=this,n=new e(v);return S(n,t),n}function z(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function U(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function V(t){this[ot]=j(),this._result=this._state=void 0,this._subscribers=[],v!==t&&("function"!=typeof t&&z(),this instanceof V?P(this,t):U())}function W(){var t=void 0;if("undefined"!=typeof o)t=o;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw new Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var n=null;try{n=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===n&&!e.cast)return}t.Promise=V}var q=void 0;q=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var H=q,J=0,Z=void 0,K=void 0,Q=function(t,e){nt[J]=t,nt[J+1]=e,J+=2,2===J&&(K?K(d):rt())},Y="undefined"!=typeof window?window:void 0,X=Y||{},$=X.MutationObserver||X.WebKitMutationObserver,tt="undefined"==typeof self&&"undefined"!=typeof e&&"[object process]"==={}.toString.call(e),et="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,nt=new Array(1e3),rt=void 0;rt=tt?s():$?l():et?c():void 0===Y?h():f();var ot=Math.random().toString(36).substring(16),it=void 0,at=1,st=2,ut=new C,lt=new C,ct=0;return N.prototype._enumerate=function(){for(var t=this.length,e=this._input,n=0;this._state===it&&n<t;n++)this._eachEntry(e[n],n)},N.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===m){var o=b(t);if(o===p&&t._state!==it)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===V){var i=new n(v);k(i,t,o),this._willSettleAt(i,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},N.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===it&&(this._remaining--,t===st?S(r,n):this._result[e]=n),0===this._remaining&&M(r,this._result)},N.prototype._willSettleAt=function(t,e){var n=this;T(t,void 0,function(t){return n._settledAt(at,e,t)},function(t){return n._settledAt(st,e,t)})},V.all=F,V.race=G,V.resolve=m,V.reject=D,V._setScheduler=i,V._setAsap=a,V._asap=Q,V.prototype={constructor:V,then:p,catch:function(t){return this.then(null,t)}},V.polyfill=W,V.Promise=V,V})}).call(e,n(48),n(2),n(13))},,function(t,e,n){"use strict";(function(t){function r(t){return u(this,void 0,void 0,function(){var n,r,o,i,a,s;return l(this,function(u){switch(u.label){case 0:return[4,c.getJSON(t)];case 1:for(n=u.sent(),r=Object.keys(n),o=0,i=r;o<i.length;o++)a=i[o],s=n[a],f.set(a.toLowerCase(),e.userLanguage in s?s[e.userLanguage]:a);return d=new RegExp(r.join("|"),"ig"),[2]}})})}function o(t){var e=f.get(t.toLowerCase());return void 0===e?t:t.toUpperCase()===t?e.toUpperCase():e}function i(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];return t.map(function(t){return t.replace(d,o)}).map(function(t,n){return t+(e[n]||"")}).join("")}function a(t,n){return 0===t?"":""+t+(t>1&&"en"===e.userLanguage?n+"s":n)}function s(t){if(void 0===t)return"";if(t<60)return Math.round(t)+" seconds";if(t<3570){var e=Math.round(t/60);return a(e,"min")}var n=Math.floor(t/3600),r=Math.floor((t-3600*n)/60);return(n>0?n+(o=["%hour%"],o.raw=["%hour%"],i(o)):"")+" "+a(r,"min");var o}var u=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,n)).next())})},l=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},c=n(7);e.userLanguage=navigator.language.slice(0,2).toLowerCase();var f=new Map,d=new RegExp(Object.keys(f).join("|"),"ig");e.updateDictionary=r,e.translate=o,e.tr=i,e.formatTime=s}).call(e,n(2))},function(t,e){t.exports=function(){var t=[];return t.toString=function(){for(var t=[],e=0;e<this.length;e++){var n=this[e];n[2]?t.push("@media "+n[2]+"{"+n[1]+"}"):t.push(n[1])}return t.join("")},t.i=function(e,n){"string"==typeof e&&(e=[[null,e,""]]);for(var r={},o=0;o<this.length;o++){var i=this[o][0];"number"==typeof i&&(r[i]=!0)}for(o=0;o<e.length;o++){var a=e[o];"number"==typeof a[0]&&r[a[0]]||(n&&!a[2]?a[2]=n:n&&(a[2]="("+a[2]+") and ("+n+")"),t.push(a))}},t}},function(t,e){function n(t,e){for(var n=0;n<t.length;n++){var r=t[n],o=d[r.id];if(o){o.refs++;for(var i=0;i<o.parts.length;i++)o.parts[i](r.parts[i]);for(;i<r.parts.length;i++)o.parts.push(u(r.parts[i],e))}else{for(var a=[],i=0;i<r.parts.length;i++)a.push(u(r.parts[i],e));d[r.id]={id:r.id,refs:1,parts:a}}}}function r(t){for(var e=[],n={},r=0;r<t.length;r++){var o=t[r],i=o[0],a=o[1],s=o[2],u=o[3],l={css:a,media:s,sourceMap:u};n[i]?n[i].parts.push(l):e.push(n[i]={id:i,parts:[l]})}return e}function o(t,e){var n=m(),r=y[y.length-1];if("top"===t.insertAt)r?r.nextSibling?n.insertBefore(e,r.nextSibling):n.appendChild(e):n.insertBefore(e,n.firstChild),y.push(e);else{if("bottom"!==t.insertAt)throw new Error("Invalid value for parameter 'insertAt'. Must be 'top' or 'bottom'.");n.appendChild(e)}}function i(t){t.parentNode.removeChild(t);var e=y.indexOf(t);e>=0&&y.splice(e,1)}function a(t){var e=document.createElement("style");return e.type="text/css",o(t,e),e}function s(t){var e=document.createElement("link");return e.rel="stylesheet",o(t,e),e}function u(t,e){var n,r,o;if(e.singleton){var u=g++;n=v||(v=a(e)),r=l.bind(null,n,u,!1),o=l.bind(null,n,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(n=s(e),r=f.bind(null,n),o=function(){i(n),n.href&&URL.revokeObjectURL(n.href)}):(n=a(e),r=c.bind(null,n),o=function(){i(n)});return r(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;r(t=e)}else o()}}function l(t,e,n,r){var o=n?"":r.css;if(t.styleSheet)t.styleSheet.cssText=b(e,o);else{var i=document.createTextNode(o),a=t.childNodes;a[e]&&t.removeChild(a[e]),a.length?t.insertBefore(i,a[e]):t.appendChild(i)}}function c(t,e){var n=e.css,r=e.media;if(r&&t.setAttribute("media",r),t.styleSheet)t.styleSheet.cssText=n;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(n))}}function f(t,e){var n=e.css,r=e.sourceMap;r&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(r))))+" */");var o=new Blob([n],{type:"text/css"}),i=t.href;t.href=URL.createObjectURL(o),i&&URL.revokeObjectURL(i)}var d={},h=function(t){var e;return function(){return"undefined"==typeof e&&(e=t.apply(this,arguments)),e}},p=h(function(){return/msie [6-9]\b/.test(window.navigator.userAgent.toLowerCase())}),m=h(function(){return document.head||document.getElementsByTagName("head")[0]}),v=null,g=0,y=[];t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");e=e||{},"undefined"==typeof e.singleton&&(e.singleton=p()),"undefined"==typeof e.insertAt&&(e.insertAt="bottom");var o=r(t);return n(o,e),function(t){for(var i=[],a=0;a<o.length;a++){var s=o[a],u=d[s.id];u.refs--,i.push(u)}if(t){var l=r(t);n(l,e)}for(var a=0;a<i.length;a++){var u=i[a];if(0===u.refs){for(var c=0;c<u.parts.length;c++)u.parts[c]();delete d[u.id]}}}};var b=function(){var t=[];return function(e,n){return t[e]=n,t.filter(Boolean).join("\n")}}()},function(t,e,n){"use strict";(function(t,r){function o(){for(var t=document.styleSheets,e="",n=0,r=t.length;n<r;++n){var o=t[n];console.log(o.cssText);var i=o.cssRules;if(i)for(var a=0;a<i.length;++a)e+=i[a].cssText;else console.log(o)}return console.log("css text ready"),e}function i(){return a(this,void 0,void 0,function(){var t,e,n,r,o,i,a;return s(this,function(s){switch(s.label){case 0:return t=document.getElementById("scheme"),[4,u.tryGet(function(){return t.sheet},function(t){return null!==t})];case 1:for(e=s.sent(),n=new Map,r=0,o=e.cssRules;r<o.length;r++)i=o[r],i instanceof CSSStyleRule&&(a=i.selectorText.match(/^.(M\d+|L|E)$/),a&&a[1]?n.set(a[1],i.style):"#paths-outer > .L"===i.selectorText&&n.set("light-rail-path",i.style));return console.log(n),[2,n]}})})}var a=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,n)).next())})},s=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},u=n(0);e.getJSON=function(t){return r(t).then(function(t){return t.json()})},e.getContent=function(t){return r(t).then(function(t){return t.text()})},e.getConfig=function(){return r("res/mapconfig.json").then(function(t){return t.json()})},e.getStyleRulesAsText=o,e.getLineRules=i}).call(e,n(2),n(19))},,function(t,e,n){"use strict";var r=function(){function t(t,e){if(t===e)throw new Error("source is the same as target: "+t);this._source=t,this._target=e}return Object.defineProperty(t.prototype,"source",{get:function(){return this._source},set:function(t){this._source=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!0,configurable:!0}),t.prototype.isOf=function(t,e){return this._source===t&&this._target===e||this._source===e&&this._target===t},t.prototype.has=function(t){return this._source===t||this._target===t},t.prototype.other=function(t){if(this._source===t)return this._target;if(this._target===t)return this._source;throw new Error("span does not have vertex")},t.prototype.isAdjacent=function(t){return this.has(t._source)||this.has(t._target)},t.prototype.invert=function(){t=[this._target,this._source],this._source=t[0],this._target=t[1];var t},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function r(t,e){if(e.length<1)throw new Error("an objects array must contain at least 1 object");for(var n=e[0],r=t.distanceTo(n.location||n),o=1,i=e.length;o<i;++o){var a=e[o],s=t.distanceTo(a.location||a);s<r&&(n=e[o],r=s)}return n}function o(t,e,n,r){void 0===r&&(r=!1);var o=e.map(function(e){return{item:e,distance:t.distanceTo(e.location)}}).filter(function(t){return t.distance<=n});return(r?o.sort(function(t,e){return t.distance-e.distance}):o).map(function(t){return t.item})}function i(t){for(var e=0,n=0,r=0,o=t;r<o.length;r++){var i=o[r],a=i.lat,u=i.lng;e+=a,n+=u}return s.latLng(e/t.length,n/t.length)}function a(t,e,n,r){void 0===n&&(n=1e-5);var o=i(t),a=e(o);u.callMeMaybe(r,o);for(var l=10;l>n;l*=.61803398875)for(var c=l,f=-c;f<=c;f+=l)for(var d=-c;d<=c;d+=l){var h=s.latLng(o.lat+f,o.lng+d),p=e(h);p<a&&(o=h,a=p,u.callMeMaybe(r,o))}return o}var s=n(1),u=n(0);e.findClosestObject=r,e.findObjectsWithinRadius=o,e.getCenter=i,e.calculateGeoMean=a},function(t,e,n){"use strict";function r(t,e){return t.x*e.x+t.y*e.y}function o(t,e){return r(t,e)/t.distanceTo(e)}function i(t){return t.reduce(function(t,e){return t.add(e)}).divideBy(t.length)}function a(t){if(3!==t.length)throw new Error("must have 3 vertices");var e=t[0],n=t[1].subtract(e),o=t[2].subtract(e),i=r(n,n),a=r(o,o);return c.point(o.y*i-n.y*a,n.x*a-o.x*i).divideBy(2*(n.x*o.y-n.y*o.x)).add(e)}function s(t,e,n){return c.point(t.x+e*Math.cos(n),t.y+e*Math.sin(n))}function u(t){var e=Math.abs(t.x),n=Math.abs(t.y);return t.divideBy(e<n?n:e)}function l(t,e,n){var r=e*e/n;return r<t?e/n*2+(t-r)/e:2*Math.sqrt(t/n)}var c=n(1);e.dot=r,e.angle=o,e.getCenter=i,e.getCircumcenter=a,e.polarToCartesian=s,e.vectorToGradCoordinates=u,e.timeToTravel=l},function(t,e,n){"use strict";function r(t){return document.createElementNS("http://www.w3.org/2000/svg",t)}function o(t,e){var n=r("circle");return n.setAttribute("r",e.toString()),n.setAttribute("cy",t.y.toString()),n.setAttribute("cx",t.x.toString()),n}function i(t,e){var n=r("line");return n.setAttribute("x1",t.x.toString()),n.setAttribute("y1",t.y.toString()),n.setAttribute("x2",e.x.toString()),n.setAttribute("y2",e.y.toString()),n}function a(t,e,n){var o=r("path");return c(o,t,e,n),o}function s(t){var e=[],n=/\D([\d\.]+).*?,.*?([\d\.]+)/g,r=t.getAttribute("d");if(r){for(var o;null!==(o=n.exec(r));)e.push(v.point(Number(o[1]),Number(o[2])));return e}}function u(t,e){if(4!==e.length)throw new Error("there should be 4 points");var n=["M"].concat(e.map(function(t){return t.x+","+t.y}));n.splice(2,0,"C"),t.setAttribute("d",n.join(" "))}function l(t){var e=[],n=/\D([\d\.]+)/g,r=t.getAttribute("d");if(r){for(var o;null!==(o=n.exec(r));)e.push(Number(o[1]));return e}}function c(t,e,n,r){var o=g.getCircumcenter([e,n,r]),i=Math.atan2(e.y-o.y,e.x-o.x),a=Math.atan2(n.y-o.y,n.x-o.x),s=a-i,u=s<=Math.PI||s>-Math.PI?0:1,l=e.subtract(o),c=n.subtract(o),f=l.x*c.y-c.x*l.y<0?0:1,d=g.dot(r.subtract(e),r.subtract(n));d<0&&(f=1-f,u=1-u);var h=o.distanceTo(e),p=["M",e.x,e.y,"A",h,h,0,u,f,n.x,n.y].join(" ");t.setAttribute("d",p)}function f(t){var e=r("path");return u(e,t),e}function d(t,e){var n=o(t,e),r=n.cloneNode(!0);return[n,r]}function h(t,e,n){var r=a(t,e,n),o=r.cloneNode(!0);return[r,o]}function p(t,e){var n=e.clone();return t.x===e.x?n.x+=.01:t.y===e.y&&(n.y+=.01),[i(t,n),i(t,n)]}function m(t){var e=v.point(+t.getAttribute("cx"),+t.getAttribute("cy")),n=~~t.getAttribute("r"),r=v.point(0+n,4+n);return e.subtract(r)}var v=n(1),g=n(11);e.createSVGElement=r,e.makeCircle=o,e.makeLine=i,e.makeArc=a,e.getBezierPathPoints=s,e.setBezierPath=u,e.getCircularPath=l,e.setCircularPath=c,e.makeCubicBezier=f,e.makeTransferRing=d,e.makeTransferArc=h,e.makeTransferLine=p,e.circleOffset=m;var y;!function(t){function e(){var t=r("filter");return t.id="shadow",t.setAttribute("width","200%"),t.setAttribute("height","200%"),t.innerHTML='\n            <feOffset result="offOut" in="SourceAlpha" dx="0" dy="4" />\n            <feColorMatrix result="matrixOut" in="offOut" type="matrix" values=\n                "0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0.5 0"/>\n            <feGaussianBlur result="blurOut" in="matrixOut" stdDeviation="2" />\n\n            <feBlend in="SourceGraphic" in2="blurOut" mode="normal" />\n        ',t}function n(){var t=r("filter");return t.id="black-glow",t.innerHTML='<feColorMatrix type="matrix" values=\n                "0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0   0\n                0 0 0 0.3 0"/>\n            <feGaussianBlur stdDeviation="2.5" result="coloredBlur"/>\n            <feMerge>\n                <feMergeNode in="coloredBlur"/>\n                <feMergeNode in="SourceGraphic"/>\n            </feMerge>',t}function o(){var t=r("filter");return t.id="opacity",t.innerHTML='<feComponentTransfer>\n            <feFuncA type="table" tableValues="0 0.5">\n        </feComponentTransfer>',t}function i(){var t=r("filter");return t.id="gray",t.innerHTML='<feColorMatrix type="matrix"\n               values="0.2126 0.7152 0.0722 0 0\n                       0.2126 0.7152 0.0722 0 0\n                       0.2126 0.7152 0.0722 0 0\n                       0 0 0 1 0"/>',t}function a(t){t.appendChild(e()),t.appendChild(n()),t.appendChild(o()),t.appendChild(i())}function s(t){var e=t.getBoundingClientRect(),n=getComputedStyle(t),r=2*parseFloat(n.strokeWidth||t.style.strokeWidth||"0");e.height>=r&&e.width>=r&&(t.style.filter="url(#black-glow)")}t.makeDrop=e,t.makeGlow=n,t.makeOpacity=o,t.makeGray=i,t.appendAll=a,t.applyDrop=s}(y=e.Filters||(e.Filters={}));var b;!function(t){function e(t){var e=r("linearGradient");if("innerHTML"in e)return e.innerHTML='<stop style="stop-color:'+t[0]+'" /><stop style="stop-color:'+t[1]+'" />',e;var n=r("stop");n.style.stopColor=t[0];var o=r("stop");return o.style.stopColor=t[1],e.appendChild(n),e.appendChild(o),e}function n(t,n,r){void 0===r&&(r=0);var a=e(n);return i(a,r),o(a,t),a}function o(t,e){var n="rotate("+180*Math.atan2(e.y,e.x)/Math.PI+", 0.5, 0.5)";t.setAttribute("gradientTransform",n)}function i(t,e){t.firstChild.setAttribute("offset",e.toString()),t.lastChild.setAttribute("offset",(1-e).toString())}t.makeUndirectedLinear=e,t.makeLinear=n,t.setDirection=o,t.setOffset=i}(b=e.Gradients||(e.Gradients={}))},,,function(t,e,n){"use strict";var r=n(47),o={platformBindings:new WeakMap,dummyBindings:new r.WeakBiMap,outerEdgeBindings:new r.WeakBiMap,innerEdgeBindings:new r.WeakBiMap,gradientBindings:new WeakMap};Object.defineProperty(e,"__esModule",{value:!0}),e.default=Object.freeze(o)},function(t,e,n){"use strict";var r=n(1),o=n(0),i=n(21);e.Platform=i.default;var a=n(23);e.Station=a.default;var s=n(9);e.Edge=s.default;var u=n(22);e.Span=u.default;var l=n(24);e.Transfer=l.default;var c=function(){function t(t){var e=this,n=function(t){return r.latLng(t.lat,t.lng)};this.platforms=t.platforms.map(function(t){return new i.default(t.name,n(t.location),t.altNames)}),this.stations=[],this.routes=t.routes,this.lines=t.lines,this.transfers=t.transfers.map(function(t){return new l.default(e.platforms[t.source],e.platforms[t.target])});var o=function(t){return t.routes.map(function(t){return e.routes[t]})};this.spans=t.spans.map(function(t){return new u.default(e.platforms[t.source],e.platforms[t.target],o(t))}),console.time("restore");for(var s=new Set(this.transfers),c=new Set(this.platforms);s.size>0;){var f=s.values().next().value,d=(new Set).add(f.source).add(f.target);s.delete(f);for(var h=d.values(),p=h.next().value;void 0!==p;p=h.next().value){for(var m=new Set,v=s.values(),g=v.next().value;void 0!==g;g=v.next().value)g.source===p?(d.add(g.target),m.add(g)):g.target===p&&(d.add(g.source),m.add(g));m.forEach(function(t){return s.delete(t)}),c.delete(p)}var y=new a.default(Array.from(d));this.stations.push(y)}c.forEach(function(t){return e.stations.push(new a.default([t]))}),console.timeEnd("restore")}return t.prototype.toJSON=function(){var t=this;return JSON.stringify({platforms:this.platforms.map(function(t){return{name:t.name,altNames:t.altNames,location:t.location}}),transfers:this.transfers.map(function(e){return{source:t.platforms.indexOf(e.source),target:t.platforms.indexOf(e.target)}}),lines:this.lines,spans:this.spans.map(function(e){return{source:t.platforms.indexOf(e.source),target:t.platforms.indexOf(e.target),routes:e.routes.map(function(e){return t.routes.indexOf(e)})}}),routes:this.routes},function(t,e){return t.startsWith("_")?void 0:e})},t.prototype.deletePlatform=function(t){console.log("removing platform",t);for(var e=0,n=t.transfers;e<n.length;e++){var r=n[e];o.deleteFromArray(this.transfers,r)}if(t.transfers.length=0,1===t.spans.length){var i=t.spans[0],a=i.other(t);o.deleteFromArray(a.spans,i),o.deleteFromArray(this.spans,i)}else if(2===t.spans.length){var s=t.spans,u=s[0],l=s[1],c=l.other(t);if(!c)throw new Error("span does not have other end");if(2===t.passingRoutes().size){var f=u.other(t);o.deleteFromArray(f.spans,u),o.deleteFromArray(this.spans,u)}else u.source===t?u.source=c:u.target=c;o.deleteFromArray(c.spans,l),o.deleteFromArray(this.spans,l)}else for(var d=0,h=t.spans;d<h.length;d++){var i=h[d],a=i.other(t);o.deleteFromArray(a.spans,i),o.deleteFromArray(this.spans,i)}var p=t.station;1===p.platforms.length?o.deleteFromArray(this.stations,p):o.deleteFromArray(p.platforms,t),o.deleteFromArray(this.platforms,t)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=c},function(t,e,n){"use strict";var r=n(28);e.RedCircle=r.default,e.start=L.icon({iconUrl:"https://proxy-antonv.rhcloud.com/?url=http://map.project-osrm.org/images/marker-start-icon-2x.png",iconSize:[20,56],iconAnchor:[10,28]}),e.end=L.icon({iconUrl:"https://proxy-antonv.rhcloud.com/?url=http://map.project-osrm.org/images/marker-end-icon-2x.png",iconSize:[20,56],iconAnchor:[10,28]}),e.red=L.icon({iconUrl:"https://proxy-antonv.rhcloud.com/?url=http://harrywood.co.uk/maps/examples/leaflet/marker-icon-red.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:"https://proxy-antonv.rhcloud.com/?url=http://cdn.leafletjs.com/leaflet/v0.7.7/images/marker-shadow.png",shadowRetinaUrl:"marker-shadow-@2x.png",shadowSize:[41,41],shadowAnchor:[12,41]})},function(t,e,n){"use strict";function r(t){var e=t.name,n=t.altNames,r=n.fi,o=n.en,i=o?[e,r,o]:r?[e,r]:[e],a=i.join("|"),s=window.location.search.match(/city=(\w+)/),u=s?s[1]:"spb",c="spb"===u?"fi":"helsinki"===u?"se":"defaultForeign";l.prompt((d=["New name"],
d.raw=["New name"],f.tr(d)),a,function(n,r){var o=r.split("|");if(t.name=o[0],t.altNames[c]=o[1],t.altNames.en=o[2],r===a)return l.warning((h=["Name was not changed"],h.raw=["Name was not changed"],f.tr(h)));var s=i.slice(1).join(", "),u=o.slice(1).join(", ");l.success((p=[""," (",") renamed to "," (",")"],p.raw=[""," (",") renamed to "," (",")"],f.tr(p,e,s,o[0],u)));var d=t.station;if(!(d.platforms.length<2)){l.confirm((m=["Rename the entire station?"],m.raw=["Rename the entire station?"],f.tr(m)),function(){for(var t=0,e=d.platforms;t<e.length;t++){var n=e[t];n.name=o[0],n.altNames.fi=o[1],n.altNames.en=o[2]}l.success((i=["The entire station was renamed to ",""],i.raw=["The entire station was renamed to ",""],f.tr(i,r)));var i});var h,p,m}},function(){return l.warning((t=["Name change cancelled"],t.raw=["Name change cancelled"],f.tr(t)));var t});var d}function o(t,e){for(var n=void 0===e?void 0:Array.from(e).map(function(t){return t.line+t.branch}).join("|"),r=new Set,o=prompt("routes",n)||"",i=0,a=o.split("|");i<a.length;i++){var s=a[i],u="M"===s[0]?s.match(/(M\d{0,2})(\w?)/):s.match(/([EL])(.{0,2})/);if(u){var l=u[1],c=u[2],f=t.routes.find(function(t){return t.line===l&&t.branch===c});void 0===f&&(console.log("creating new route"),f={line:l,branch:c},t.routes.push(f)),r.add(f)}else console.error("incorrect route",s)}return r}function i(t,e){var n=0;console.log(e.length),addEventListener("keydown",function(r){r.shiftKey&&r.ctrlKey&&76===r.keyCode&&(r.preventDefault(),t.removeLayer(e[n]),++n===e.length&&(n=0),t.addLayer(e[n]),t.invalidateSize(!1))})}function a(t,e){var n=e.filter(function(t){return t.spans[0].routes[0].line.startsWith("M")}).map(function(t){return t.location}),r=function(t){return n.reduce(function(e,n){return e+t.distanceTo(n)},0)},o=u.polyline([],{color:"red"}),i=c.calculateGeoMean(n,r,1,function(t){return o.addLatLng(t)});t.addLayer(o);for(var a=5e3;a<2e4;a+=5e3)u.circle(i,a-250,{weight:1}).addTo(t),u.circle(i,a+250,{weight:1}).addTo(t);var s=(e.filter(function(t){return t.spans[0].routes[0].line.startsWith("E")}).map(function(t){return t.location}),e.find(function(t){return"Glavnyj voxal"===t.name&&t.spans[0].routes[0].line.startsWith("E")}));if(s){var l=s.location;u.circle(l,3e4).addTo(t),u.circle(l,45e3).addTo(t)}}function s(t,e){for(var n=0,r=e;n<r.length;n++){var o=r[n];t.addLayer(o).removeLayer(o)}}var u=n(1),l=n(8),c=n(10),f=n(4),d=n(29);e.MapEditor=d.default;var h=n(27);e.FAQ=h.default;var p=n(32);e.TextPlate=p.default;var m=n(30);e.RoutePlanner=m.default;var v=n(25);e.ContextMenu=v.default;var g=n(26);e.DistanceMeasure=g.default;var y=n(31);e.SvgOverlay=y.default;var b=n(17);e.Icons=b;var w=n(35);e.tileLayers=w,e.platformRenameDialog=r,e.askRoutes=o,e.addLayerSwitcher=i,e.drawZones=a,e.cacheIcons=s},function(t,e,n){(function(e,n){(function(){!function(t){"use strict";function n(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function r(t){return"string"!=typeof t&&(t=String(t)),t}function o(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return y.iterable&&(e[Symbol.iterator]=function(){return e}),e}function i(t){this.map={},t instanceof i?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function a(t){return t.bodyUsed?e.reject(new TypeError("Already read")):void(t.bodyUsed=!0)}function s(t){return new e(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function u(t){var e=new FileReader,n=s(e);return e.readAsArrayBuffer(t),n}function l(t){var e=new FileReader,n=s(e);return e.readAsText(t),n}function c(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function f(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function d(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"==typeof t)this._bodyText=t;else if(y.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(y.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(y.arrayBuffer&&y.blob&&w(t))this._bodyArrayBuffer=f(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!y.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!_(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=f(t)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):y.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},y.blob&&(this.blob=function(){var t=a(this);if(t)return t;if(this._bodyBlob)return e.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return e.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return e.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?a(this)||e.resolve(this._bodyArrayBuffer):this.blob().then(u)}),this.text=function(){var t=a(this);if(t)return t;if(this._bodyBlob)return l(this._bodyBlob);if(this._bodyArrayBuffer)return e.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return e.resolve(this._bodyText)},y.formData&&(this.formData=function(){return this.text().then(m)}),this.json=function(){return this.text().then(JSON.parse)},this}function h(t){var e=t.toUpperCase();return x.indexOf(e)>-1?e:t}function p(t,e){e=e||{};var n=e.body;if("string"==typeof t)this.url=t;else{if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new i(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new i(e.headers)),this.method=h(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function m(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),o=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(o))}}),e}function v(t){var e=new i;return t.split("\r\n").forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var o=n.join(":").trim();e.append(r,o)}}),e}function g(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new i(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var y={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(y.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],w=function(t){return t&&DataView.prototype.isPrototypeOf(t)},_=ArrayBuffer.isView||function(t){return t&&b.indexOf(Object.prototype.toString.call(t))>-1};i.prototype.append=function(t,e){t=n(t),e=r(e);var o=this.map[t];this.map[t]=o?o+","+e:e},i.prototype.delete=function(t){delete this.map[n(t)]},i.prototype.get=function(t){return t=n(t),this.has(t)?this.map[t]:null},i.prototype.has=function(t){return this.map.hasOwnProperty(n(t))},i.prototype.set=function(t,e){this.map[n(t)]=r(e)},i.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},i.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),o(t)},i.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),o(t)},i.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),o(t)},y.iterable&&(i.prototype[Symbol.iterator]=i.prototype.entries);var x=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this,{body:this._bodyInit})},d.call(p.prototype),d.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},g.error=function(){var t=new g(null,{status:0,statusText:""});return t.type="error",t};var k=[301,302,303,307,308];g.redirect=function(t,e){if(k.indexOf(e)===-1)throw new RangeError("Invalid status code");return new g(null,{status:e,headers:{location:t}})},t.Headers=i,t.Request=p,t.Response=g,t.fetch=function(t,n){return new e(function(e,r){var o=new p(t,n),i=new XMLHttpRequest;i.onload=function(){var t={status:i.status,statusText:i.statusText,headers:v(i.getAllResponseHeaders()||"")};t.url="responseURL"in i?i.responseURL:t.headers.get("X-Request-URL");var n="response"in i?i.response:i.responseText;e(new g(n,t))},i.onerror=function(){r(new TypeError("Network request failed"))},i.ontimeout=function(){r(new TypeError("Network request failed"))},i.open(o.method,o.url,!0),"include"===o.credentials&&(i.withCredentials=!0),"responseType"in i&&y.blob&&(i.responseType="blob"),o.headers.forEach(function(t,e){i.setRequestHeader(e,t)}),i.send("undefined"==typeof o._bodyInit?null:o._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!=typeof self?self:this),t.exports=n.fetch}).call(n)}).call(e,n(2),n(13))},function(t,e,n){"use strict";(function(t){var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,n)).next())})},i=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},a=n(1),s=n(3),u=n(16),l=n(18),c=n(0),f=n(7),d=n(15),h=n(4),p=c.geo,m=c.sfx,v=c.svg,g=c.math,y=c.algorithm,b=c.Mediator,w=c.color,_=c.file,x=c.tryGetFromMap,k=l.tileLayers,L=k.mapbox,E=k.mapnik,M=k.osmFrance,S=k.openMapSurfer,T=k.cartoDBNoLabels,A=k.wikimapia,C=m.Scale,O=g.getCenter,B=y.findCycle,P=[{event:"routefrom",text:"Route from here"},{event:"routeto",text:"Route to here"},{event:"clearroute",text:"Clear route"},{event:"showheatmap",text:"Show heatmap",extra:{disabled:!0}}],j=function(e){function n(t){var n=e.call(this)||this;return n.whiskers=new WeakMap,n.platformsOnSVG=new WeakMap,n.config=t,n.makeMap(),n}return r(n,e),n.prototype.getMap=function(){return this.map},n.prototype.getNetwork=function(){return this.network},n.prototype.makeMap=function(){return o(this,void 0,void 0,function(){var e,n,r,o,s,d,m,g,y,b,w,_,x,k,C=this;return i(this,function(i){switch(i.label){case 0:return e=this.config,document.getElementById("scheme").href=e.url.scheme,n=this.getGraph(),r=f.getLineRules(),o=new t(function(t){return L.once("load",t)}),s=new l.FAQ(e.url.data),e.center=[0,0],d=Object.assign({},e),"1"===a.version[0]&&(d.wheelPxPerZoomLevel=75,d.inertiaMaxSpeed=1500,d.fadeAnimation=!1),this.map=a.map(e.containerId,d).addControl(a.control.scale({imperial:!1})),m=this.map.getPanes().mapPane.style,m.visibility="hidden",l.addLayerSwitcher(this.map,[L,E,M,S,T,A]),addEventListener("keydown",function(t){t.shiftKey&&t.ctrlKey&&82===t.keyCode&&C.getGraph().then(function(t){return C.resetNetwork(t)})}),this.addContextMenu(),[4,n];case 1:return g=i.sent(),this.network=new u.default(g),y=p.getCenter(this.network.platforms.map(function(t){return t.location})),e.center=[y.lat,y.lng],b=a.latLngBounds(this.network.platforms.map(function(t){return t.location})),this.overlay=new l.SvgOverlay(b).addTo(this.map),w=this.overlay.defs,v.Filters.appendAll(w),_=w.textContent,0===(_||"").length&&alert((k=["Your browser doesn't seem to have capabilities to display some features of the map. Consider using Chrome or Firefox for the best experience."],k.raw=["Your browser doesn't seem to have capabilities to display some features of the map. Consider using Chrome or Firefox for the best experience."],h.tr(k))),[4,r];case 2:return x=i.sent(),this.lineRules=x,this.resetMapView(),this.map.addLayer(L),this.map.on("overlayupdate",function(t){C.redrawNetwork()}),this.initNetwork(),this.map.invalidateSize(!1),this.addMapListeners(),(new l.RoutePlanner).addTo(this),(new l.DistanceMeasure).addTo(this.map),a.Browser.mobile||new l.MapEditor(e.detailedZoom).addTo(this),[4,s.whenAvailable];case 3:return i.sent(),s.addTo(this.map),[4,o];case 4:return i.sent(),c.fixFontRendering(),this.map.on("layeradd layerremove",function(t){return c.fixFontRendering()}),m.visibility="",[2]}})})},n.prototype.subscribe=function(t,n){var r=this;e.prototype.subscribe.call(this,t,n),this.map.on(t,function(t){return r.publish(t)})},n.prototype.addContextMenu=function(){var t=this;this.contextMenu=new l.ContextMenu(P);for(var e=0,n=P;e<n.length;e++){var r=n[e];this.map.on(r.event,function(e){console.log(e),t.publish(e)})}this.contextMenu.addTo(this.map)},n.prototype.addMapListeners=function(){var t=this,e=function(t){var e=t;return d.default.outerEdgeBindings.getKey(e)||d.default.innerEdgeBindings.getKey(e)},n=function(t){return d.default.dummyBindings.getKey(t)},r=this,o=r.map,i=r.contextMenu;o.on("distancemeasureinit",function(t){i.insertItem("measuredistance","Measure distance")}),o.on("clearmeasurements",function(t){i.removeItem("clearmeasurements"),i.insertItem("measuredistance","Measure distance")}),o.on("zoomstart",function(e){t.plate.hide()}),this.subscribe("measuredistance",function(t){i.removeItem("measuredistance"),i.insertItem("clearmeasurements","Clear measurements")}),this.subscribe("platformrename",function(e){var r=n(e.relatedTarget);t.plate.show(v.circleOffset(e.relatedTarget),c.getPlatformNames(r)),l.platformRenameDialog(r)}),this.subscribe("platformmovestart",function(e){t.plate.disabled=!0}),this.subscribe("platformmove",function(t){var e=n(t.relatedTarget);e.location=c.mouseToLatLng(o,t)}),this.subscribe("platformmoveend",function(e){var r=n(e.relatedTarget);t.plate.disabled=!1,t.plate.show(v.circleOffset(e.relatedTarget),c.getPlatformNames(r))}),this.subscribe("platformadd",function(n){console.log(n);var r=n.detail,i=c.mouseToLatLng(o,r),a=new u.Platform((d=["New station"],d.raw=["New station"],h.tr(d)),i,{});if(t.network.platforms.push(a),void 0!==r.relatedTarget){var s=e(r.relatedTarget),l=s.source===a?"target":"source",f=new u.Span(a,s[l],s.routes);s[l]=a,t.network.spans.push(f)}t.overlay.extendBounds(i),t.resetNetwork(JSON.parse(t.network.toJSON()));var d}),this.subscribe("platformdelete",function(e){var r=n(e.relatedTarget);t.network.deletePlatform(r),t.redrawNetwork()}),this.subscribe("spanroutechange",function(n){if(void 0!==n.relatedTarget){var r=e(n.relatedTarget),o=l.askRoutes(t.network,new Set(r.routes));r.routes=Array.from(o),t.resetNetwork(JSON.parse(t.network.toJSON()))}}),this.subscribe("spaninvert",function(n){if(void 0!==n.relatedTarget){var r=e(n.relatedTarget);r.invert(),t.resetNetwork(JSON.parse(t.network.toJSON()))}}),this.subscribe("spanend",function(e){var n=d.default.dummyBindings.getKey(e.detail.source),r=d.default.dummyBindings.getKey(e.detail.target);console.log(n,r),i.removeItem("spanend");var o=n.passingRoutes(),a=r.passingRoutes(),s=o.size,f=a.size,h=s>0&&0===f?1===s?o:l.askRoutes(t.network,o):f>0&&0===s?1===f?a:l.askRoutes(t.network,a):l.askRoutes(t.network,c.intersection(o,a));t.network.spans.push(new u.Span(n,r,Array.from(h))),t.resetNetwork(JSON.parse(t.network.toJSON()))}),this.subscribe("spandelete",function(n){if(void 0!==n.relatedTarget){var r=e(n.relatedTarget);c.deleteFromArray(t.network.spans,r),t.resetNetwork(JSON.parse(t.network.toJSON()))}}),this.subscribe("transferend",function(e){var n=d.default.dummyBindings.getKey(e.detail.source),r=d.default.dummyBindings.getKey(e.detail.target);console.log(n,r),i.removeItem("transferend"),t.network.transfers.push(new u.Transfer(n,r)),t.resetNetwork(JSON.parse(t.network.toJSON()))}),this.subscribe("transferdelete",function(e){if(void 0!==e.relatedTarget){var n=e.relatedTarget,r=d.default.outerEdgeBindings.getKey(n)||d.default.innerEdgeBindings.getKey(n);c.deleteFromArray(t.network.transfers,r),t.resetNetwork(JSON.parse(t.network.toJSON()))}}),this.subscribe("editmapstart",function(e){o.getZoom()<t.config.detailedZoom&&o.setZoom(t.config.detailedZoom);var n=function(t){var e=t.parentElement;if(!e)return!1;var n=e.id;return"paths-outer"===n||"paths-inner"===n};i.insertItem("platformaddclick","New station",function(t){return!n(t)});var r=function(t){var e=t.parentElement;return!!e&&"dummy-circles"===e.id};i.insertItem("platformrename","Rename station",r),i.insertItem("platformdelete","Delete station",r),i.insertItem("spanstart","Span from here",r),i.insertItem("transferstart","Transfer from here",r),i.insertItem("spanroutechange","Change route",n),i.insertItem("spaninvert","Invert span",n),i.insertItem("platformaddtolineclick","Add station to line",n),i.insertItem("spandelete","Delete span",n),i.insertItem("transferdelete","Delete transfer",function(t){var e=t.parentElement;if(!e)return!1;var n=e.id;return"transfers-outer"===n||"transfers-inner"===n})}),this.subscribe("editmapend",function(t){i.removeItem("platformaddclick"),i.removeItem("platformrename"),i.removeItem("platformdelete"),i.removeItem("spanstart"),i.removeItem("transferstart"),i.removeItem("platformaddtolineclick"),i.removeItem("spanroutechange"),i.removeItem("spandelete"),i.removeItem("transferdelete")}),this.subscribe("mapsave",function(e){_.downloadText("graph.json",t.network.toJSON())})},n.prototype.initNetwork=function(){for(var t=this.overlay.origin,e=["paths-outer","paths-inner","transfers-outer","station-circles","transfers-inner","dummy-circles"],n=0,r=e;n<r.length;n++){var o=r[n],i=v.createSVGElement("g");i.id=o,t.appendChild(i)}this.plate=new l.TextPlate,t.insertBefore(this.plate.element,document.getElementById("dummy-circles")),this.redrawNetwork(),this.addStationListeners()},n.prototype.resetMapView=function(){var t=this.config,e=t.center,n=t.zoom,r={pan:{animate:!1},zoom:{animate:!1}};return e?(this.map.setView(e,n+1,r),void this.map.setView(e,n,r)):void console.error("cannot set map to center")},n.prototype.getGraph=function(){return f.getJSON(this.config.url.graph)},n.prototype.resetNetwork=function(t){this.network=new u.default(t),this.redrawNetwork()},n.prototype.cleanElements=function(){for(var t=0,e=this.overlay.origin.childNodes;t<e.length;t++){var n=e[t];n!==this.plate.element&&c.removeAllChildren(n)}},n.prototype.addBindings=function(){for(var t=this.network.platforms,e=d.default.platformBindings,n=d.default.dummyBindings,r=0,o=t;r<o.length;r++){var i=o[r];this.platformToModel(i,[x(e,i),x(n,i)])}},n.prototype.redrawNetwork=function(){var t=this;console.time("pre"),this.cleanElements(),this.updatePlatformsPositionOnOverlay(),console.timeEnd("pre"),console.time("preparation");for(var e=this.config.detailedZoom,n=this.map.getZoom(),r=n>9?n:n>8?9.5:9,o=.5*(r-7),i=.75*o,a=r<e?1.25*o:o,u=r<e?.4*a:.6*a,l=2*a,f=.9*o,h=1.25*u,p={"station-circles":u,"dummy-circles":0,"transfers-outer":f+h/2,"transfers-inner":f-h/2,"paths-outer":o,"paths-inner":o/2},m=a+u/2,g=new Map,y=0,b=Object.keys(p);y<b.length;y++){var w=b[y];g.set(w,document.createDocumentFragment()),c.byId(w).style.strokeWidth=p[w]+"px"}var _=x(this.lineRules,"light-rail-path");_.strokeWidth=i+"px";var k=Math.max(.5*(n+10),11),L=s.get(this.plate,"element.firstChild.firstChild.style");L&&(L.fontSize=k+"px");var E=new Map;console.timeEnd("preparation"),console.time("circle preparation");for(var M=x(g,"station-circles"),S=x(g,"dummy-circles"),T=0,A=this.network.stations;T<A.length;T++){for(var C=A[T],O=[],P=0,j=C.platforms;P<j.length;P++){var R=j[P],N=x(this.platformsOnSVG,R);if(n>9){var I=v.makeCircle(N,a);n>=e&&this.colorizePlatformCircle(I,R.passingLines());var F=v.makeCircle(N,l);M.appendChild(I),d.default.platformBindings.set(R,I),S.appendChild(F),d.default.dummyBindings.set(R,F)}this.whiskers.set(R,this.makeWhiskers(R))}var G=B(this.network,C);if(G.length>0){for(var D=0,z=C.platforms;D<z.length;D++){var R=z[D];if(G.includes(R)){var U=x(this.platformsOnSVG,R);O.push(U)}}E.set(C,G)}}if(console.timeEnd("circle preparation"),console.time("transfer preparation"),n>=e)for(var V=x(g,"transfers-outer"),W=x(g,"transfers-inner"),q=this.overlay.defs,H=0,J=this.network.transfers;H<J.length;H++){var Z=J[H],K=Z.source,Q=Z.target,Y=x(this.platformsOnSVG,Z.source),X=x(this.platformsOnSVG,Z.target),$=E.get(K.station),tt=void 0!==$&&$.includes(K)&&$.includes(Q)?this.makeTransferArc(Z,$):v.makeTransferLine(Y,X);d.default.outerEdgeBindings.set(Z,tt[0]),d.default.innerEdgeBindings.set(Z,tt[1]);var et=[K,Q].map(function(e){return t.getPlatformColor(e)}),nt=m/Y.distanceTo(X),rt=X.subtract(Y),ot=d.default.gradientBindings.get(Z);void 0===ot?(ot=v.Gradients.makeLinear(rt,et,nt),ot.id=c.generateId(function(t){return null!==document.getElementById(t)}),d.default.gradientBindings.set(Z,ot),q.appendChild(ot)):(v.Gradients.setDirection(ot,rt),v.Gradients.setOffset(ot,nt)),tt[0].style.stroke="url(#"+ot.id+")",V.appendChild(tt[0]),W.appendChild(tt[1])}console.timeEnd("transfer preparation"),console.time("span preparation");for(var it=x(g,"paths-outer"),at=x(g,"paths-inner"),st=0,ut=this.network.spans;st<ut.length;st++){var lt=ut[st],ct=this.makePath(lt),ft=ct[0],dt=ct[1];it.appendChild(ft),dt&&at.appendChild(dt)}console.timeEnd("span preparation"),console.time("appending"),g.forEach(function(t,e){return c.byId(e).appendChild(t)}),this.addBindings(),console.timeEnd("appending")},n.prototype.updatePlatformsPositionOnOverlay=function(t){void 0===t&&(t=this.map.getZoom());for(var e=t<this.config.detailedZoom,n=0,r=this.network.stations;n<r.length;n++)for(var o=r[n],i=e?this.overlay.latLngToSvgPoint(o.getCenter()):void 0,a=0,s=o.platforms;a<s.length;a++){var u=s[a],l=i||this.overlay.latLngToSvgPoint(u.location);this.platformsOnSVG.set(u,l)}},n.prototype.getPlatformColor=function(t){return w.mean(this.linesToColors(t.passingLines()))},n.prototype.linesToColors=function(t){var e=this,n=[];return t.forEach(function(t){var r=x(e.lineRules,"M"===t[0]?t:t[0]).stroke;r&&n.push(r)}),n},n.prototype.colorizePlatformCircle=function(t,e){if(0!==e.size){if(1===e.size){var n=e.values().next().value;return void t.classList.add("M"===n[0]?n:n[0])}t.style.stroke=w.mean(this.linesToColors(e))}},n.prototype.makeWhiskers=function(t){var e=this,n=x(this.platformsOnSVG,t),r=new Map;if(0===t.spans.length)return r;if(1===t.spans.length)return r.set(t.spans[0],n);if(2===t.spans.length){if(2===t.passingLines().size)return r.set(t.spans[0],n).set(t.spans[1],n);var o=function(n){return x(e.platformsOnSVG,n.other(t))},i=t.spans.map(function(t){return o(t).add(n).divideBy(2)}),a=c.midPointsToEnds(n,i);return r.set(t.spans[0],a[0]).set(t.spans[1],a[1])}for(var s=[[],[]],u=[[],[]],l=0,f=t.spans;l<f.length;l++){var d=f[l],h=d.other(t),p=x(this.platformsOnSVG,h),m=d.source===t?0:1;s[m].push(p),u[m].push(d)}var v=function(t){return 1===t.length?t[0]:0===t.length?n:O(t)},g=s.map(function(t){return v(t).add(n).divideBy(2)}),y=c.midPointsToEnds(n,g);return u[0].forEach(function(t){return r.set(t,y[0])}),u[1].forEach(function(t){return r.set(t,y[1])}),r},n.prototype.makeTransferArc=function(t,e){var n=this,r=t.source,o=t.target,i=x(this.platformsOnSVG,t.source),a=x(this.platformsOnSVG,t.target),u=function(t){return v.makeTransferArc(i,a,x(n.platformsOnSVG,t))};if(3===e.length){var l=s.difference(e,[r,o])[0];return u(l)}if(r===e[2]&&o===e[3]||r===e[3]&&o===e[2])return v.makeTransferLine(i,a);for(var c=[],f=0,d=this.network.transfers;f<d.length;f++){var h=d[f];h!==t&&(t.has(h.source)?c.push(h.target):t.has(h.target)&&c.push(h.source))}var p;if(2===c.length){if(c[0]!==c[1])throw Error("FFFFUC");p=c[0]}else{if(3!==c.length)throw new Error("111FUUFF");p=c[0]===c[1]?c[2]:c[0]===c[2]?c[1]:c[0]}return u(p)},n.prototype.makePath=function(t){var e=t.routes,n="",r="",o="";if(e.length>0){var i=t.routes[0].line.match(/([MEL])(\d{0,2})/);if(!i)throw new Error("match failed for "+t.source.name+"-"+t.target.name);n=i[0],r=i[1],o=i[2]}else console.error(t,"span has no routes!");var a=[x(this.platformsOnSVG,t.source),x(x(this.whiskers,t.source),t),x(x(this.whiskers,t.target),t),x(this.platformsOnSVG,t.target)],s=v.makeCubicBezier(a);if("E"===r){s.classList.add("E");var u=s.cloneNode(!0);return d.default.outerEdgeBindings.set(t,s),d.default.innerEdgeBindings.set(t,u),[s,u]}return void 0!==n&&s.classList.add(n),void 0!==r?s.classList.add(r):s.style.stroke="black",d.default.outerEdgeBindings.set(t,s),[s]},n.prototype.addStationListeners=function(){var t=this,e=function(e){t.plate.hide(),C.unscaleAll()},n=c.byId("dummy-circles");n.addEventListener("mouseover",function(e){var n=e.target,r=d.default.dummyBindings.getKey(n),o=r.station,i=t.map.getZoom()<t.config.detailedZoom&&o.platforms.length>1?o.getNames():c.getPlatformNames(r);t.highlightStation(o,i)}),n.addEventListener("mouseout",e);var r=function(e){var n=e.target,r=d.default.outerEdgeBindings.getKey(n)||d.default.innerEdgeBindings.getKey(n),o=c.getPlatformNamesZipped([r.source,r.target]);t.highlightStation(r.source.station,o)},o=c.byId("transfers-outer"),i=c.byId("transfers-inner");o.addEventListener("mouseover",r),i.addEventListener("mouseover",r),o.addEventListener("mouseout",e),i.addEventListener("mouseout",e)},n.prototype.highlightStation=function(t,e){var n,r,o=1.25;if(1===t.platforms.length)r=t.platforms[0],n=x(d.default.platformBindings,r),C.scaleCircle(n,o,!0);else{var i=this.map.getZoom()<this.config.detailedZoom?void 0:this.network.transfers;C.scaleStation(t,o,i),r=t.platforms.reduce(function(t,e){return t.location.lat<e.location.lat?e:t}),n=x(d.default.platformBindings,r)}this.plate.show(v.circleOffset(n),e)},n.prototype.platformToModel=function(t,e){var n=this,r=t.location;Object.defineProperty(t,"location",{get:function(){return t._location},set:function(r){t._location=r;for(var o=n.map.getZoom()<n.config.detailedZoom?t.station.getCenter():r,i=n.overlay.latLngToSvgPoint(o),a=0,s=e;a<s.length;a++){var u=s[a];u.setAttribute("cx",i.x.toString()),u.setAttribute("cy",i.y.toString())}n.whiskers.set(t,n.makeWhiskers(t)),n.platformsOnSVG.set(t,i);for(var l=new Set(t.spans),c=0,f=t.spans;c<f.length;c++){var h=f[c],p=h.other(t);n.whiskers.set(p,n.makeWhiskers(p)),p.spans.forEach(function(t){return l.add(t)})}l.forEach(function(t){var e=[x(n.platformsOnSVG,t.source),x(x(n.whiskers,t.source),t),x(x(n.whiskers,t.target),t),x(n.platformsOnSVG,t.target)],r=d.default.outerEdgeBindings.get(t),o=d.default.innerEdgeBindings.get(t);v.setBezierPath(r,e),o&&v.setBezierPath(o,e)});for(var m=0,g=t.transfers;m<g.length;m++){var y=g[m];y[y.source===t?"source":"target"]=t}}}),t._location=r},n.prototype.transferToModel=function(t,e){var n=this,r=[t.source,t.target],o=e[0].tagName;["source","target"].forEach(function(i,a){Object.defineProperty(t,i,{get:function(){return t["_"+i]},set:function(r){t["_"+i]=r;var u=x(d.default.platformBindings,r),l=parseFloat(getComputedStyle(u).strokeWidth||""),c=+u.getAttribute("r")/2+l,f=x(n.platformsOnSVG,r);if("line"===o){for(var h=a+1,p=t.other(r),m=0,g=e;m<g.length;m++){var y=g[m];y.setAttribute("x"+h,f.x.toString()),y.setAttribute("y"+h,f.y.toString())}var b=x(d.default.gradientBindings,t),w=x(n.platformsOnSVG,p),_="source"===i?w.subtract(f):f.subtract(w);v.Gradients.setDirection(b,_);var k=c/f.distanceTo(w);v.Gradients.setOffset(b,k)}else{if("path"!==o)throw new TypeError("wrong element type for transfer");for(var L=[],E=0,M=n.network.transfers;E<M.length;E++){var S=M[E];if(t.isAdjacent(S)&&(L.push(S),3===L.length))break}for(var T=new Set,A=0,C=L;A<C.length;A++){var O=C[A];T.add(O.source).add(O.target)}var B=Array.from(T).map(function(t){return n.platformsOnSVG.get(t)});T.forEach(function(t){return B.push(n.platformsOnSVG.get(t))});for(var P=L.map(function(t){return d.default.outerEdgeBindings.get(t)}),j=L.map(function(t){return d.default.innerEdgeBindings.get(t)}),R=0;R<3;++R){var N=L[R],I=P[R],F=j[R],G=x(n.platformsOnSVG,N.source),D=x(n.platformsOnSVG,N.target),z=s.difference(B,[G,D])[0];z&&(v.setCircularPath(I,G,D,z),F.setAttribute("d",I.getAttribute("d")));var b=x(d.default.gradientBindings,N);v.Gradients.setDirection(b,D.subtract(G));var k=c/G.distanceTo(D);v.Gradients.setOffset(b,k)}}}}),t["_"+i]=r[a]})},n}(b);Object.defineProperty(e,"__esModule",{value:!0}),e.default=j}).call(e,n(2))},function(t,e,n){"use strict";var r=function(){function t(t,e,n,r){void 0===n&&(n={}),this.spans=[],this.transfers=[],this.name=t,this.altNames=n,this.location=e,this.elevation=r}return Object.defineProperty(t.prototype,"station",{get:function(){return this._station},enumerable:!0,configurable:!0}),t.prototype.passingRoutes=function(){for(var t=new Set,e=0,n=this.spans;e<n.length;e++)for(var r=n[e],o=0,i=r.routes;o<i.length;o++){var a=i[o];t.add(a)}return t},t.prototype.passingLines=function(){for(var t=new Set,e=0,n=this.spans;e<n.length;e++)for(var r=n[e],o=0,i=r.routes;o<i.length;o++){var a=i[o];t.add(a.line)}return t},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(0),i=n(9),a=function(t){function e(e,n,r){var o=t.call(this,e,n)||this;return e.spans.push(o),n.spans.push(o),o.routes=r,o}return r(e,t),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(t){void 0!==this._source&&o.deleteFromArray(this._source.spans,this),this._source=t,t.spans.push(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){void 0!==this._target&&o.deleteFromArray(this._target.spans,this),this._target=t,t.spans.push(this)},enumerable:!0,configurable:!0}),e}(i.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){"use strict";var r=n(0),o=function(){function t(t){this.platforms=t;for(var e=0,n=t;e<n.length;e++){var r=n[e];r._station=this}}return t.prototype.getNames=function(){return r.getPlatformNamesZipped(this.platforms)},t.prototype.getCenter=function(){return r.geo.getCenter(this.platforms.map(function(t){return t.location;
}))},t.prototype.passingLines=function(){for(var t=new Set,e=0,n=this.platforms;e<n.length;e++)for(var r=n[e],o=0,i=r.spans;o<i.length;o++)for(var a=i[o],s=0,u=a.routes;s<u.length;s++){var l=u[s];t.add(l.line)}return t},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=o},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(0),i=n(9),a=function(t){function e(e,n){var r=t.call(this,e,n)||this;return e.transfers.push(r),n.transfers.push(r),r}return r(e,t),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(t){void 0!==this._source&&o.deleteFromArray(this._source.transfers,this),this._source=t,t.transfers.push(this)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){void 0!==this._target&&o.deleteFromArray(this._target.transfers,this),this._target=t,t.transfers.push(this)},enumerable:!0,configurable:!0}),e}(i.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){"use strict";var r=n(1),o=n(3),i=n(0),a=n(4),s=n(50),u=function(){function t(t){console.log("adding context menu"),this.items=t,this.container=document.createElement("div"),this.container.classList.add(s.contextmenu),this.container.addEventListener("contextmenu",function(t){t.preventDefault(),t.target.click()}),console.log("context menu ready")}return t.prototype.addTo=function(t){return this.onAdd(t),this},t.prototype.onAdd=function(t){var e=this;if(this.map=t,void 0===t)throw new Error("cannot add map editor to metro map: leaflet map is missing");var n=t.getPanes().mapPane,o=t.getContainer(),i=function(t){return e.handler(t)},a=function(t){return e.hide()};n.addEventListener("contextmenu",i,!1),o.addEventListener("mousedown",a),o.addEventListener("touchstart",a),r.Browser.mobile||t.on("movestart",a),document.body.appendChild(this.container)},t.prototype.onRemove=function(t){},t.prototype.handler=function(t){var e=this;t.preventDefault(),console.log("target",t.target,t.target.parentNode),i.removeAllChildren(this.container);for(var n=0,r=this.items;n<r.length;n++){var o=r[n];if(void 0===o.trigger||o.trigger(t.target)){var s=document.createElement("div");void 0!==o.extra&&o.extra.disabled?s.setAttribute("disabled",""):s.setAttribute("data-event",o.event),s.textContent=a.translate(o.text),this.container.appendChild(s)}else console.log(o.trigger(t.target))}this.container.onclick=function(n){console.log(n);var r=n.target,o=r.getAttribute("data-event");o&&(e.hide(),e.map.fireEvent(o,{clientX:p,clientY:m,relatedTarget:t.target}))};var u=this.container.getBoundingClientRect(),l=u.width,c=u.height,f=document.documentElement,d=f.clientWidth,h=f.clientHeight,p=t.clientX,m=t.clientY,v=p+l>d?d-l:p,g=m+c>h?m-c:m;this.container.style.transform="translate("+v+"px, "+g+"px)",this.show()},t.prototype.insertItem=function(t,e,n,r,o){var i={event:t,text:e,trigger:n,extra:r};void 0===o||o<0?this.items.push(i):this.items.splice(o,0,i)},t.prototype.removeItem=function(t,e){if(void 0===e&&(e=!1),e)return void o.remove(this.items,function(e){return e.event===t});var n=this.items.findIndex(function(e){return e.event===t});void 0===n||n<0||this.items.splice(n,1)},t.prototype.show=function(){this.container.style.visibility=null,r.Browser.mobile&&this.map.dragging.disable()},t.prototype.hide=function(){this.container.style.visibility="hidden",r.Browser.mobile&&this.map.dragging.enable()},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=u},function(t,e,n){"use strict";var r=n(1),o=n(0),i=n(17),a=function(){function t(){var t=this;this.polyline=r.polyline([],{color:"red"}),this.markers=r.featureGroup().on("layeradd layerremove",function(t){return o.fixFontRendering()}),this.dashedLine=r.polyline([],{color:"red",opacity:.5,dashArray:"0,9"}),this.makeMarker=function(e){if(0===e.originalEvent.button){var n=function(e){t.dashedLine.setStyle({opacity:0}),t.updateDistances()},o=r.marker(e.latlng,{draggable:!0}).setIcon(i.RedCircle).bindPopup("").on("mouseover",function(e){return t.hideDashedLine()}).on("mouseout",function(e){return t.showDashedLine()}).on("drag",n).on("click",t.onCircleClick.bind(t));t.markers.addLayer(o),t.updateDistances()}},this.resetDashedLine=function(e){t.dashedLine.getLatLngs()[1]=e.latlng,t.dashedLine.redraw()}}return t.prototype.onAdd=function(t){var e=this;this.map=t;return t.fireEvent("distancemeasureinit"),t.on("measuredistance",function(n){return e.measureDistance(o.mouseToLatLng(t,n))}),t.on("clearmeasurements",function(t){return e.clearMeasurements()}),this},t.prototype.onRemove=function(t){},t.prototype.addTo=function(t){return this.onAdd(t),this},t.prototype.updateDistances=function(){var t=this.polyline.getLatLngs(),e=this.markers.getLayers(),n=e.length;t[0]=e[0].setPopupContent("0").getLatLng();for(var r=1,o=0;r<n;++r){var i=e[r].getLatLng();t[r]=i,o+=e[r-1].getLatLng().distanceTo(i);var a=Math.round(o),s=a<1e3?a+" m":(a<1e4?a/1e3:Math.round(a/10)/100)+" km";e[r].setPopupContent(s)}t.length>n&&(t.length=n),this.dashedLine.getLatLngs()[0]=t[t.length-1],this.polyline.redraw(),n>1&&e[n-1].openPopup()},t.prototype.showDashedLine=function(){this.dashedLine.setStyle({opacity:.5})},t.prototype.hideDashedLine=function(){this.dashedLine.setStyle({opacity:0})},t.prototype.onCircleClick=function(t){if(0===t.originalEvent.button){if(this.markers.removeLayer(t.target),0===this.markers.getLayers().length)return void this.map.fire("clearmeasurements");this.updateDistances(),this.map.hasLayer(this.dashedLine)||this.showDashedLine()}},t.prototype.measureDistance=function(t){var e=this;this.dashedLine.addLatLng(t).addLatLng(t),this.map.addLayer(this.polyline.setLatLngs([])).addLayer(this.markers).addLayer(this.dashedLine.setLatLngs([])).on("click",this.makeMarker).on("mousemove",this.resetDashedLine).fire("click",{latlng:t,originalEvent:{button:0}}),o.onceEscapePress(function(t){return e.map.fire("clearmeasurements")})},t.prototype.clearMeasurements=function(){this.map.removeLayer(this.polyline).removeLayer(this.markers.clearLayers()).removeLayer(this.dashedLine).off("mousemove",this.resetDashedLine).off("click",this.makeMarker)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){"use strict";(function(t){var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(14),i=n(34),a=n(0),s=n(51),u=function(e){function n(n){var r=e.call(this)||this,i=t(n).then(function(t){return t.json()}),a=document.createElement("button");a.textContent="FAQ",a.classList.add("leaflet-control"),a.classList.add(s["faq-button"]),a.addEventListener("click",function(t){return r.showFAQ()}),r.button=a,r.card=document.createElement("div"),r.card.classList.add(s["faq-card"]),L.Browser.mobile&&new o(r.card).on("swipeleft swiperight",function(t){return r.hideFAQ()});var u=/\[\[(.+?)\|(.*?)\]\]/g,l='<a href="$1" target="_blank">$2</a>',c=s.question,f=s.answer,d=function(t){return'\n            <div>\n                <span class="'+c+'">'+t.q+'</span>\n                <span class="'+f+'">'+t.a+"</span>\n            </div>\n        "};return r._whenAvailable=i.then(function(t){r.card.innerHTML+=t.faq.map(d).join("").replace(u,l)}),r}return r(n,e),n.prototype.addTo=function(t){var e=this;this.map=t,this.whenAvailable.then(function(t){var n=document.querySelector(".leaflet-right.leaflet-top");return document.body.appendChild(e.card),n?void n.appendChild(e.button):void console.error("cannot append to .leaflet-right.leaflet-top")})},n.prototype.showFAQ=function(){var t=this,e=this.card.style;e.display="inline",e.transform="scale(0.1)",e.opacity="0",this.card.getBoundingClientRect(),e.transform=null,e.opacity=null,this.button.disabled=!0,L.Browser.mobile||(this.map.getContainer().classList.add("dimmed"),this.map.once("mousedown",function(e){return t.hideFAQ()}),a.once(window,"keydown",function(e){27===e.keyCode&&t.map.fireEvent("mousedown")}))},n.prototype.hideFAQ=function(){var t=this;console.log("hiding"),this.card.getBoundingClientRect(),this.card.style.transform="scale(0.1)",this.card.style.opacity="0",L.Browser.mobile||this.map.getContainer().classList.remove("dimmed"),a.once(this.card,"transitionend",function(e){return t.card.style.display=null}),this.button.disabled=!1},n}(i.DeferredWidget);Object.defineProperty(e,"__esModule",{value:!0}),e.default=u}).call(e,n(19))},function(t,e,n){"use strict";var r=n(0),o=r.svg.createSVGElement("svg");o.setAttribute("width","100"),o.setAttribute("height","100");var i=r.svg.makeCircle(L.point(50,50),40);i.style.stroke="red",i.style.strokeWidth="20px",i.style.fill="white",o.appendChild(i);var a=5;Object.defineProperty(e,"__esModule",{value:!0}),e.default=L.icon({iconUrl:r.file.svgToDataUrl(o),iconSize:[2*a,2*a],iconAnchor:[a,a],popupAnchor:[0,-a]})},function(t,e,n){"use strict";var r=n(4),o=n(0),i=n(52),a=function(){function t(t){var e=this,n=document.createElement("button");n.textContent="Edit Map",n.classList.add("leaflet-control"),n.classList.add(i["edit-map-button"]),n.onclick=function(t){return e.editMapClick()},this.button=n}return Object.defineProperty(t.prototype,"editMode",{get:function(){return this._editMode},set:function(t){var e=this;if(t){var n=o.byId("dummy-circles");this.button.textContent=(i=["Save map"],i.raw=["Save map"],r.tr(i)),this.button.onclick=function(t){return e.saveMapClick()},n.onmousedown=n.onclick=function(){return!1},this.metroMap.publish(new Event("editmapstart"))}else this.button.textContent=(a=["Edit map"],a.raw=["Edit map"],r.tr(a)),this.button.onclick=function(t){return e.editMapClick()},this.metroMap.publish(new Event("editmapend"));this._editMode=t;var i,a},enumerable:!0,configurable:!0}),t.prototype.addTo=function(t){var e=t.getMap();if(void 0===e)throw new Error("cannot add map editor to metro map: map is missing");this.metroMap=t;var n=document.querySelector(".leaflet-right.leaflet-top");return n?(n.appendChild(this.button),this.editMode=!1):console.error("cannot append to .leaflet-right.leaflet-top"),this},t.prototype.editMapClick=function(){this.editMode=!0,this.addMapListeners()},t.prototype.saveMapClick=function(){this.metroMap.publish(new Event("mapsave")),this.editMode=!1},t.prototype.addMapListeners=function(){var t=this;console.log("adding edit map listeners");var e,n,r,i=this.metroMap.getMap(),a=o.byId("dummy-circles");o.byId("paths-outer"),o.byId("paths-inner");a.addEventListener("mousedown",function(o){if(2!==o.button&&r){var a={source:r,target:o.target};console.log(a),t.metroMap.publish(new CustomEvent("span"===n?"spanend":"transferend",{detail:a})),r=null,n=void 0}else 0===o.button?(i.dragging.disable(),e=o.target,t.metroMap.publish(new MouseEvent("platformmovestart",{relatedTarget:o.target}))):1===o.button&&(console.log("foo",o.target),t.metroMap.publish(new MouseEvent("spanstart",{relatedTarget:o.target})))}),i.on("mousemove",function(n){if(e){var r=n.originalEvent,o=r.clientX,i=r.clientY,a={relatedTarget:e,clientX:o,clientY:i};t.metroMap.publish(new MouseEvent("platformmove",a))}}).on("mouseup",function(n){if(e){i.dragging.enable();var r={relatedTarget:e};t.metroMap.publish(new MouseEvent("platformmoveend",r)),e=null}}),this.metroMap.subscribe("spanstart",function(t){n="span",r=t.relatedTarget}),this.metroMap.subscribe("transferstart",function(t){n="transfer",r=t.relatedTarget}),this.metroMap.subscribe("platformaddclick",function(e){var n=e.clientX,r=e.clientY;t.metroMap.publish(new CustomEvent("platformadd",{detail:{clientX:n,clientY:r}}))}),this.metroMap.subscribe("platformaddtolineclick",function(e){t.metroMap.publish(new CustomEvent("platformadd",{detail:e}))})},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){"use strict";var r=n(1),o=n(8),i=n(0),a=n(18),s=i.sfx,u=i.algorithm.shortestRoute,l=function(){function t(){this.fromMarker=r.marker([0,0],{draggable:!0,icon:a.Icons.start}),this.toMarker=r.marker([0,0],{draggable:!0,icon:a.Icons.end}),this.addMarkerListeners()}return t.prototype.addTo=function(t){var e=this;this.metroMap=t;var n=t.getMap(),r=n.getCenter();return this.fromMarker.setLatLng(r),this.toMarker.setLatLng(r),a.cacheIcons(n,[this.fromMarker,this.toMarker]),t.subscribe("routefrom routeto",this.handleFromTo.bind(this)),t.subscribe("clearroute",function(t){return e.clearRoute()}),n.on("zoomstart",function(t){return s.Animation.terminateAnimations()}),addEventListener("keydown",function(e){27===e.keyCode&&t.publish(new Event("clearroute"))}),this},t.prototype.handleFromTo=function(t){var e=this.metroMap.getMap(),n=i.mouseToLatLng(e,t),r="routefrom"===t.type?this.fromMarker:this.toMarker;r.setLatLng(n),e.hasLayer(r)||e.addLayer(r);var o=r===this.fromMarker?this.toMarker:this.fromMarker;e.hasLayer(o)&&(i.fixFontRendering(),this.visualizeRouteBetween(this.fromMarker.getLatLng(),this.toMarker.getLatLng()))},t.prototype.addMarkerListeners=function(){for(var t=this,e=0,n=[this.fromMarker,this.toMarker];e<n.length;e++){var r=n[e];r.on("drag",function(e){return t.visualizeShortestRoute(!1)}).on("dragend",function(e){i.fixFontRendering(),t.visualizeShortestRoute()})}},t.prototype.visualizeShortestRoute=function(t){void 0===t&&(t=!0);var e=this.metroMap.getMap();e.hasLayer(this.fromMarker)&&e.hasLayer(this.toMarker)&&this.visualizeRouteBetween(this.fromMarker.getLatLng(),this.toMarker.getLatLng(),t)},t.prototype.visualizeRouteBetween=function(t,e,n){void 0===n&&(n=!0),i.resetStyle(),o.dismissAll(),s.visualizeRoute(u(this.metroMap.getNetwork().platforms,t,e),n)},t.prototype.clearRoute=function(){var t=this.metroMap.getMap(),e=s.Animation.terminateAnimations();t.removeLayer(this.fromMarker).removeLayer(this.toMarker),this.fromMarker.off("drag").off("dragend"),this.toMarker.off("drag").off("dragend"),o.dismissAll(),e.then(i.resetStyle)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=l},function(t,e,n){"use strict";var r=this&&this.__extends||function(t,e){function n(){this.constructor=t}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)},o=n(1),i=n(33),a=n(12),s=n(53),u=function(t){function e(e,n){void 0===n&&(n=o.point(100,100));var r=t.call(this,e,n)||this;return r.overlayContainer=a.createSVGElement("svg"),r.overlayContainer.classList.add(s.overlay),r.defs=a.createSVGElement("defs"),r.overlayContainer.appendChild(r.defs),r.origin=a.createSVGElement("g"),r.origin.id="origin",r.origin.setAttribute("transform","translate("+r.margin.x+", "+r.margin.y+")"),r.overlayContainer.appendChild(r.origin),r}return r(e,t),e}(i.default);Object.defineProperty(e,"__esModule",{value:!0}),e.default=u},function(t,e,n){"use strict";var r=n(0),o=n(54),i=function(){function t(){this.element=r.svg.createSVGElement("g"),this._disabled=!1,this._editable=!1;var t=document.createElement("div");t.classList.add(o["plate-box"]);var e=r.svg.createSVGElement("foreignObject");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width","100%"),e.setAttribute("height","100%"),e.appendChild(t);var n=this.element;n.id="station-plate",n.style.display="none",n.appendChild(e)}return Object.defineProperty(t.prototype,"disabled",{get:function(){return this._disabled},set:function(t){t?this.hide():getSelection().removeAllRanges(),this._disabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editable",{get:function(){return this._editable},set:function(t){for(var e=t?"true":"false",n=this.element.childNodes[1].children[1],r=n.children,o=0,i=r;o<i.length;o++){var a=i[o];a.contentEditable=e}},enumerable:!0,configurable:!0}),t.prototype.show=function(t,e){if(!this.disabled&&"none"===this.element.style.display){var n=this.element.firstChild,r=n.firstChild;r.innerHTML=e.join("<br>"),this.element.setAttribute("transform","translate("+t.x+", "+t.y+")"),this.element.style.display=null;var o=r.getBoundingClientRect(),i=o.width,a=o.height;n.setAttribute("transform","translate("+-i+", "+-a+")"),console.log(n.getBoundingClientRect()),console.log(r.getBoundingClientRect())}},t.prototype.hide=function(){this.element.style.display="none"},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=i},function(t,e,n){"use strict";function r(t,e){void 0===e&&(e=250),setTimeout(function(){return i.fixFontRendering(t)},e)}var o=n(1),i=n(0),a=function(){function t(t,e){void 0===e&&(e=o.point(100,100)),this.margin=e.round(),this.bounds=t}return t.prototype.addTo=function(t){return this.onAdd(t),this},t.prototype.onAdd=function(t){this.map=t,this.minZoom=t.getMinZoom(),this.maxZoom=t.getMaxZoom(),this.updateOverlayPositioning();var e=t.getPanes(),n=e.objectsPane,r=e.markerPane,i=e.mapPane;("1"===o.version[0]?i:n).insertBefore(this.overlayContainer,r),this.addMapMovementListeners()},t.prototype.onRemove=function(t){var e=t.getPanes(),n=e.objectsPane,r=e.mapPane;("1"===o.version[0]?r:n).removeChild(this.overlayContainer),this.map.clearAllEventListeners()},t.prototype.addMapMovementListeners=function(){var t,e=this,n=this.map,a=n.getPanes(),s=a.mapPane,u=a.tilePane,l=a.overlayPane,c=this.overlayContainer,f=c.style,d=c.classList;n.on("zoomstart",function(t){d.add("leaflet-zoom-animated"),console.log("zoomstart",t),n.dragging.disable()}).on("zoomanim",function(n){console.log("zoomanim",n);var r=n,o=r.scale,a=r.origin;1!==o&&i.scaleOverlay(e.overlayContainer,o,t||a),t=null}).on("zoomend",function(t){console.log("zoomend",t),d.remove("leaflet-zoom-animated"),f.transform=null,f.transformOrigin=null,e.updateOverlayPositioning(),n.fireEvent("overlayupdate",e),n.dragging.enable()}).on("moveend",function(t){i.fixFontRendering(),"1"===o.version[0]?r(u.firstElementChild):l.hasChildNodes()&&r(l,0)});var h=function(e){return t=o.DomEvent.getMousePosition(e)};s.addEventListener("wheel",h);var p=document.querySelector(".leaflet-control-container");p?p.addEventListener("wheel",h):console.error("cannot append wheel to leaflet-control-container"),n.zoomControl.getContainer().addEventListener("mousedown",function(e){return t=o.point(innerWidth/2,innerHeight/2).round()},!0),n.on("dblclick",function(e){return t=o.DomEvent.getMousePosition(e.originalEvent)}),document.addEventListener("keydown",function(e){return t=o.point(innerWidth/2,innerHeight/2)})},t.prototype.updateOverlayPositioning=function(){var t=this.bounds.getNorthWest(),e=this.bounds.getSouthEast(),n=this,r=n.map,i=n.margin;this.topLeft=r.project(t).round();var a=o.bounds(r.latLngToLayerPoint(t),r.latLngToLayerPoint(e)),s=this.overlayContainer.style,u=a.min.subtract(i);s.left=u.x+"px",s.top=u.y+"px";var l=a.getSize().add(i).add(i);s.width=l.x+"px",s.height=l.y+"px"},t.prototype.extendBounds=function(t){this.bounds.extend(t),this.updateOverlayPositioning()},t.prototype.latLngToSvgPoint=function(t){return this.map.project(t).round().subtract(this.topLeft)},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=a},function(t,e,n){"use strict";var r=function(){function t(){}return Object.defineProperty(t.prototype,"whenAvailable",{get:function(){return this._whenAvailable},enumerable:!0,configurable:!0}),t}();e.DeferredWidget=r},function(t,e,n){"use strict";var r=n(1);e.mapbox=r.tileLayer("https://{s}.tiles.mapbox.com/v3/inker.mlo91c41/{z}/{x}/{y}.png",{detectRetina:!1,attribution:'Map data &copy; <a href="https://openstreetmap.org">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://mapbox.com">Mapbox</a>'}),e.mapnik=r.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.osmFrance=r.tileLayer("http://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",{attribution:'&copy; Openstreetmap France | &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.openMapSurfer=r.tileLayer("http://korona.geog.uni-heidelberg.de/tiles/roads/x={x}&y={y}&z={z}",{attribution:'Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.hyddaBase=r.tileLayer("https://{s}.tile.openstreetmap.se/hydda/base/{z}/{x}/{y}.png",{detectRetina:!0,attribution:'Tiles courtesy of <a href="http://openstreetmap.se/" target="_blank">OpenStreetMap Sweden</a> &mdash; Map data &copy; <a href="http://server.ts.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.esriGrey=r.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ",detectRetina:!0}),e.cartoDB=r.tileLayer("http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'}),e.cartoDBNoLabels=r.tileLayer("http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'}),e.wikimapia=r.tileLayer("http://i{hash}.wikimapia.org/?x={x}&y={y}&zoom={z}",{hash:function(t){return t.x%4+t.y%4*4}})},function(t,e,n){"use strict";var r=function(){function t(){this.eventListeners=new Map}return t.prototype.subscribe=function(t,e){for(var n=0,r=t.split(/\s+/);n<r.length;n++){var o=r[n],i=this.eventListeners.get(o);void 0===i?this.eventListeners.set(o,[e]):i.push(e)}},t.prototype.unsubscribe=function(t,e){var n=this.eventListeners.get(t);if(void 0!==n){var r=n.indexOf(e);r<0||n.splice(r,1)}},t.prototype.publish=function(t){console.log("event as seen from the dispatcher",t);var e=this.eventListeners.get(t.type);if(void 0===e)return console.log("no event listeners registered for "+t.type),!1;for(var n=0,r=e;n<r.length;n++){var o=r[n];o(t)}return!0},t}();Object.defineProperty(e,"__esModule",{value:!0}),e.default=r},function(t,e,n){"use strict";function r(t,e){if(e.platforms.length<3)return[];var n=e.platforms;if(3===n.length){for(var r=0,o=e.platforms;r<o.length;r++){var i=o[r];if(2!==t.transfers.filter(function(t){return t.has(i)}).length)return[]}return n}if(4===n.length){var a=(t.platforms,t.transfers),u=n.map(function(t){return{platform:t,degree:a.filter(function(e){return e.has(t)}).length}}).sort(function(t,e){return t.degree-e.degree}),l=u.map(function(t){return t.degree}),c=u.map(function(t){return t.platform});if(s.isEqual(l,[2,2,3,3]))return c;if(s.isEqual(l,[1,2,2,3]))return c.slice(1)}return[]}function o(t,e,n){for(var r=new Map,o=new Map,a=0,s=t;a<s.length;a++){var b=s[a],w=b.spans.some(function(t){return t.routes[0].line.startsWith("E")}),_=f(e,b.location),x=_/d;r.set(b,x+(w?y:g)),_=f(b.location,n),x=_/d,o.set(b,x)}for(var k=l.findClosestObject(e,t),L=new Set(t),E=new Map;L.size>0;){var M=1/0;L.forEach(function(t){var e=c.tryGetFromMap(r,t);e<M&&(k=t,M=e)}),L.delete(k);for(var S=[],T=[],A=0,C=k.spans;A<C.length;A++){var O=C[A],B=O.other(k);if(L.has(B)){S.push(B);var _=f(k.location,B.location),P=0,j=O.routes[0].line.startsWith("E")?v:m,R=u.timeToTravel(_,h,p);T.push(R+j+P)}}for(var N=0,I=k.station.platforms;N<I.length;N++){var B=I[N];if(L.has(B)){S.push(B);var w=B.spans.some(function(t){return t.routes[0].line.startsWith("E")}),_=f(k.location,B.location)/2;T.push(_/d+(w?y:g))}}for(var F=0,G=S.length;F<G;++F){var B=S[F],D=r.get(k)+T[F];D<r.get(B)&&(r.set(B,D),E.set(B,k))}r.get(k)+o.get(k)}var z=1/0;r.forEach(function(t,e){var n=r.get(e)+o.get(e);n<z&&(z=n,k=e)});var U=f(e,n)/d;if(U<z)return{time:{walkTo:U}};for(var V=[],W=[k],q=E.get(k);void 0!==q&&void 0!==q;q=E.get(k)){for(var H=void 0,J=0,Z=k.spans;J<Z.length;J++){var O=Z[J];if(O.has(q)){H=O;break}}if(void 0===H)for(var K=0,Q=k.transfers;K<Q.length;K++){var Y=Q[K];if(Y.has(q)){H=Y;break}}if(void 0===H){var X=i(q,k),$=X.transfers,tt=X.midPlatforms;V.push.apply(V,$.reverse()),W.push.apply(W,tt)}else V.push(H);W.push(q),k=q}W.reverse(),V.reverse();var et=o.get(W[W.length-1]),nt=c.tryGetFromMap(r,W[0]);return{platforms:W,edges:V,time:{walkTo:nt,metro:z-et-nt,walkFrom:et,total:z}}}function i(t,e){if(t.station!==e.station)throw new Error("platforms ("+t.name+" & "+e.name+" must be on the same station");for(var n=t.station,r=n.platforms,o=new Set(r),i=new Map,a=new Map,s=0,u=r;s<u.length;s++){var l=u[s];i.set(l,1/0)}i.set(t,0);for(var d=t;o.size>0;){var h=1/0;o.forEach(function(t){var e=c.tryGetFromMap(i,t);e<h&&(d=t,h=e)}),o.delete(d);for(var p=d.transfers.map(function(t){return t.other(d)}),m=0,v=p;m<v.length;m++){var g=v[m];if(g&&o.has(g)){var y=f(d.location,g.location),b=i.get(d)+y;b<i.get(g)&&(i.set(g,b),a.set(g,d))}}}var w=[],_=[];d=e;for(var x=function(){var t=a.get(d);if(!t)return"break";var e=d.transfers.find(function(e){return e.has(t)});return e?(w.push(e),d=t,void _.push(d)):(console.error("cannot find transfer node"),"continue")};;){var k=x();if("break"===k)break}return _.pop(),{transfers:w.reverse(),midPlatforms:_.reverse()}}var a=n(1),s=n(3),u=n(11),l=n(10),c=n(0);e.findCycle=r;var f=function(t,e){return a.LatLng.prototype.distanceTo.call(t,e)},d=1,h=20,p=.7,m=25,v=40,g=240,y=360;e.shortestRoute=o},function(t,e,n){"use strict";function r(t){var e=t.match(/[0-9a-f]{1,2}/gi);return e?e.map(function(t){return parseInt(t,16)}):[]}function o(t){var e=t.match(/rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)/i);return e?e.slice(1).map(Number):[]}function i(t){var e=function(t,e){return(e.startsWith("#")?r:o)(e).map(function(e,n){return t[n]+e})},n=t.reduce(e,[0,0,0]).map(function(e){return Math.floor(e/t.length)}),i=n[0],a=n[1],s=n[2];return"rgb("+i+", "+a+", "+s+")"}e.mean=i},function(t,e,n){"use strict";function r(t,e,n){var r=n.value;return n.value=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];console.time(e),r.apply(this,t),console.timeEnd(e)},n}function o(t,e,n){var r=n.value;if(null===r)throw new Error(e+" is not a method");var o=new Map;n.value=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=JSON.stringify(t),i=o.get(n);if(void 0!==i)return i;var a=r.apply(this,t);return o.set(n,a),a}}e.time=r,e.MemoizeWithParameters=o},function(t,e,n){"use strict";(function(t){function r(t,e){var n=document.createElement("a");n.href=e,n.download=t,n.click()}function o(t,e){var n=URL.createObjectURL(e);r(t,n),URL.revokeObjectURL(n)}function i(t,e){o(t,new Blob([e],{type:"octet/stream"}))}function a(t,e,n){s(e,n).then(function(e){return r(t,e)})}function s(t,e){return u(t).then(function(t){return t.toDataURL("image/"+e)})}function u(e){return new t(function(t,n){var r=c(e,!0);r.onload=function(e){var o=document.createElement("canvas");o.width=r.width,o.height=r.height;var i=o.getContext("2d");return i?(i.drawImage(r,0,0),void t(o)):n(new Error("2d context does not exist on canvas"))}})}function l(t){var e=s(t,"png"),n=document.createElement("img");return n.width=parseInt(t.getAttribute("width")||"")||parseInt(t.style.width||""),n.height=parseInt(t.getAttribute("height")||"")||parseInt(t.style.height||""),e.then(function(t){return n.src=t,n})}function c(t,e){void 0===e&&(e=!1),e&&(t=d(t));var n=document.createElement("img");return n.width=parseInt(t.getAttribute("width")||"")||parseInt(t.style.width||""),n.height=parseInt(t.getAttribute("height")||"")||parseInt(t.style.height||""),n.src=f(t),n}function f(t){return"data:image/svg+xml;base64,"+btoa((new XMLSerializer).serializeToString(t))}function d(t){for(var e=t.cloneNode(!0),n=e.querySelectorAll("[id^=dummy]"),r=0,o=n.length;r<o;++r){var i=n[r],a=i.parentNode;a&&a.removeChild(i)}e.style.left=e.style.top="";var s=e.querySelector("#station-plate");if(s){var u=s.parentNode;u&&u.removeChild(s)}var l=document.createElement("style");l.textContent=h.getStyleRulesAsText();var c=e.querySelector("defs");return c&&c.insertBefore(l,c.firstChild),e}var h=n(7);e.download=r,e.downloadBlob=o,e.downloadText=i,e.downloadSvgAsPicture=a,e.svgToPictureDataUrl=s,e.svgToCanvas=u,e.svgToPicture=l,e.svgToImg=c,e.svgToDataUrl=f}).call(e,n(2))},function(t,e,n){"use strict";(function(t){function r(t,e){return void 0===e&&(e=!0),s(this,void 0,void 0,function(){var n,r,a,s,c,f,d,p,g,y,b;return u(this,function(u){switch(u.label){case 0:return n=t.platforms,r=void 0===n?[]:n,a=t.edges,s=t.time,c=h.formatTime(s.walkTo),void 0===a?[2,l.success((y=[""," on foot!"],y.raw=[""," on foot!"],h.tr(y,c)))]:[4,v.terminateAnimations()];case 1:for(u.sent(),f=0,d=document.querySelectorAll(m);f<d.length;f++)p=d[f].style,p.filter=null,p.opacity="0.25";return e?[4,v.animateRoute(r,a,1)]:(o(a),i(r),[2]);case 2:return g=u.sent(),g&&l.message((b=["TIME:<br>"," on foot<br>"," by metro<br>"," on foot<br>TOTAL: ",""],b.raw=["TIME:<br>"," on foot<br>"," by metro<br>"," on foot<br>TOTAL: ",""],h.tr(b,c,h.formatTime(s.metro),h.formatTime(s.walkFrom),h.formatTime(s.total))),10),[2]}})})}function o(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],o=c.default.outerEdgeBindings.get(r);if(void 0!==o){o.style.opacity=null;var i=c.default.innerEdgeBindings.get(r);void 0!==i&&(i.style.opacity=null),r instanceof f.Span&&d.Filters.applyDrop(o)}}}function i(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],o=c.default.platformBindings.get(r);o&&(o.style.opacity=null)}}var a,s=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,n)).next())})},u=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},l=n(8),c=n(15),f=n(16),d=n(12),h=n(4),p=n(0),m=["paths-inner","paths-outer","transfers-inner","transfers-outer","station-circles"].map(function(t){return"#"+t+" *"}).join(", ");!function(t){function e(t,e,n){if(void 0===n&&(n=!1),!n)return void(t.style.transform="scale("+e+")");o.add(t);var r=t.getAttribute("r");r&&t.setAttribute("data-r",r),t.setAttribute("r",(+r*e).toString())}function n(t,n,r){for(var o=parseFloat(p.byId("transfers-outer").style.strokeWidth||""),a=parseFloat(p.byId("transfers-inner").style.strokeWidth||""),s=0,u=t.platforms;s<u.length;s++){var l=u[s],f=p.tryGetFromMap(c.default.platformBindings,l);if(e(f,n,!0),r&&!(t.platforms.length<2))for(var d=0,h=r;d<h.length;d++){var m=h[d];if(m.has(l)){var v=c.default.outerEdgeBindings.get(m),g=c.default.innerEdgeBindings.get(m);i.add(v),i.add(g),v.style.strokeWidth=o*n+"px",g.style.strokeWidth=a*n+"px"}}}}function r(){o.forEach(function(t){var e=t.getAttribute("data-r");null!==e&&t.setAttribute("r",e)}),i.forEach(function(t){return t.style.strokeWidth=null}),i.clear(),o.clear()}var o=new Set,i=new Set;t.scaleCircle=e,t.scaleStation=n,t.unscaleAll=r}(a=e.Scale||(e.Scale={}));var v,g=L.Browser.webkit&&!L.Browser.mobile;!function(e){function n(){return null===s?t.resolve(!0):(i=!1,
s)}function r(e,r,a){return void 0===a&&(a=1),s=n().then(function(n){return new t(function(t,n){return function n(s){if(!i)return t(!1);var u=p.tryGetFromMap(c.default.platformBindings,e[s]);if(u.style.opacity=null,g&&o(u,s<r.length?1.5:3,200),s===r.length)return t(!0);var l=c.default.outerEdgeBindings.get(r[s]);if(!l)return n(s+1);var f=c.default.innerEdgeBindings.get(r[s]),h=l.cloneNode(!0),m=void 0===f?void 0:f.cloneNode(!0),v=p.byId("paths-outer");v.appendChild(h);var y=p.byId("paths-inner");m&&y.appendChild(m);var b;if(h instanceof SVGPathElement)b=h.getTotalLength();else{var w=L.point(+h.getAttribute("x1"),+h.getAttribute("y1")),_=L.point(+h.getAttribute("x2"),+h.getAttribute("y2"));b=w.distanceTo(_)}var x=r[s],k=x.source===e[s]?b:-b,E=b/a;d.Filters.applyDrop(h);for(var M=0,S=void 0===m?[h]:[h,m];M<S.length;M++){var T=S[M],A=T.style;A.transition=null,A.opacity=null,A.strokeDasharray=b+" "+b,A.strokeDashoffset=k.toString(),T.getBoundingClientRect(),A.transition="stroke-dashoffset "+E+"ms linear",A.strokeDashoffset="0"}h.addEventListener("transitionend",function(t){l.style.opacity=null,"t"!==h.id.charAt(1)&&d.Filters.applyDrop(l),v.removeChild(h),m&&(f.style.opacity=null,y.removeChild(m)),n(s+1)})}(0)}).then(function(t){return s=null,i=!0,t})})}function o(t,e,n){t.getBoundingClientRect(),t.style.transition="transform "+n/2+"ms linear",a.scaleCircle(t,e),t.addEventListener("transitionend",function t(e){this.removeEventListener("transitionend",t),this.style.transform="scale(1)",this.addEventListener("transitionend",function t(e){this.removeEventListener("transitionend",t),this.style.transition=null,this.style.transform=null})})}var i=!0,s=null;e.terminateAnimations=n,e.animateRoute=r,e.pulsateCircle=o}(v=e.Animation||(e.Animation={})),e.visualizeRoute=r,e.rehighlightEdges=o,e.rehighlightPlatforms=i}).call(e,n(2))},function(t,e,n){e=t.exports=n(5)(),e.push([t.i,'.ui-ContextMenu-___style__contextmenu___2-NHv {\n    position: fixed;\n    left: 0;\n    top: 0;\n    z-index: 10000;\n    background-color: white;\n    box-shadow: 0 14px 28px rgba(0,0,0,0.25), 0 10px 10px rgba(0,0,0,0.22);\n    font-family: "Segoe UI", Tahoma, Ubuntu, Cambay, Roboto, sans-serif;\n    font-size: 0.7em;\n    margin-left: 1px; /* so that the first element is not automatically selected */\n    border-collapse: collapse;\n    transform-origin: 0 0;\n    -moz-user-select: none;\n    -khtml-user-select: none;\n    -webkit-user-select: none;\n    -ms-user-select: none;\n    user-select: none;\n}\n\n@media only screen and (max-device-width: 400px) and (-webkit-min-device-pixel-ratio: 2) {\n    .ui-ContextMenu-___style__contextmenu___2-NHv {\n        font-size: 1.2em;\n    }\n} \n\n.ui-ContextMenu-___style__contextmenu___2-NHv div {\n    padding: 5px;\n    cursor: default;\n}\n\n.ui-ContextMenu-___style__contextmenu___2-NHv div[disabled] {\n    color: grey;\n    /*cursor: not-allowed*/\n}\n\n.ui-ContextMenu-___style__contextmenu___2-NHv div:not([disabled]):hover {\n    background-color: #82B1FF;\n    /*color: #ffffff;*/\n}',""]),e.locals={contextmenu:"ui-ContextMenu-___style__contextmenu___2-NHv"}},function(t,e,n){e=t.exports=n(5)(),e.push([t.i,"\n.ui-FAQ-___style__faq-card___2WxV6 {\n    position: absolute;\n    top: 5%;\n    bottom: 5%;\n    right: 5%;\n    left: 5%;\n    width: 50%;\n    margin: 0 auto;\n    padding: 1%;\n    display: none;\n    background-color: white;\n    border-radius: 4px;\n    box-shadow: 0 19px 38px rgba(0,0,0,0.30), 0 15px 12px rgba(0,0,0,0.22);\n    font-family: Roboto, Calibri, Helvetica, sans-serif;\n    overflow-y: scroll;\n    transition-property: transform opacity;\n    transition-duration:  200ms;\n}\n\n@media only screen and (max-width: 1000px) {\n    .ui-FAQ-___style__faq-card___2WxV6 {\n        max-width: 500px;\n        width: 90%;\n    }\n}\n\n.ui-FAQ-___style__cross-ball___1f_gh {\n    float: right;\n    height: 12mm;\n    width: 12mm;\n    line-height: 12mm;\n    border-radius: 50%;\n    background: #E91E63;\n    color: white;\n    /*font-size: 12mm;*/\n    font-weight: bold;\n    text-align: center;\n    /* not selectabled */\n    -webkit-user-select: none;\n    user-select: none;\n    cursor: pointer;\n}\n\n.ui-FAQ-___style__cross-ball___1f_gh:hover {\n    filter: grayscale(0.1) opacity(0.8);\n    -webkit-filter: grayscale(0.1) opacity(0.8);\n}\n\n.ui-FAQ-___style__question___262kz {\n    font-weight: bold;\n    display: block;\n    margin-top: 1%;\n}\n\n.ui-FAQ-___style__answer___1tIjU {\n    display: block;\n    padding-bottom: 1%;\n    border-bottom: #cccccc 1px solid;\n}",""]),e.locals={"faq-card":"ui-FAQ-___style__faq-card___2WxV6","cross-ball":"ui-FAQ-___style__cross-ball___1f_gh",question:"ui-FAQ-___style__question___262kz",answer:"ui-FAQ-___style__answer___1tIjU"}},function(t,e,n){e=t.exports=n(5)(),e.push([t.i,".ui-MapEditor-___style__edit-map-button___12ie8[disabled] {\n    cursor: not-allowed;\n}",""]),e.locals={"edit-map-button":"ui-MapEditor-___style__edit-map-button___12ie8"}},function(t,e,n){e=t.exports=n(5)(),e.push([t.i,".ui-SvgOverlay-___style__overlay___21Ych {\n    width: 100%;\n    height: 100%;\n    position: relative;\n    z-index: 5;\n    /*will-change: transform;*/ /*blurs fonts */\n}",""]),e.locals={overlay:"ui-SvgOverlay-___style__overlay___21Ych"}},function(t,e,n){e=t.exports=n(5)(),e.push([t.i,".ui-TextPlate-___style__plate-box___21m-n {\n    color: #000000;\n    text-anchor: end;\n    text-align: right;\n    font-family: Corbel, Candara, Calibri, Ubuntu, sans-serif;\n    font-weight: bold;\n    opacity: 1;\n    -webkit-user-select: none;\n    user-select: none;\n    \n    white-space: nowrap;\n    /*border-radius: 2px;*/\n    box-shadow: 0 3px 6px rgba(0,0,0,0.16), 0 3px 6px rgba(0,0,0,0.23);\n    /*filter: url(#shadow);*/\n    background-color: white; /* for div */\n    padding: 1px 3px 1px 3px;\n    line-height: 1.3em;\n    display: inline-block;\n    /*float: left;*/\n}",""]),e.locals={"plate-box":"ui-TextPlate-___style__plate-box___21m-n"}},function(t,e,n){"use strict";var r=function(){function t(t){var e=this;this.left=new Map(t),this.right=new Map,this.left.forEach(function(t){return e.right.set(t)})}return t.prototype.clear=function(){this.left.clear(),this.right.clear()},t.prototype.delete=function(t){var e=this.left.get(t);return!!this.right.has(e)&&(this.right.delete(e),this.left.delete(t))},t.prototype.entries=function(){return this.left.entries()},t.prototype.forEach=function(t,e){this.left.forEach(t,e)},t.prototype.get=function(t){return this.left.get(t)},t.prototype.has=function(t){return this.left.has(t)},t.prototype.keys=function(){return this.left.keys()},t.prototype.set=function(t,e){var n=this.left.get(t),r=this.right.get(e);return this.left.has(t)&&this.right.delete(n),this.right.has(e)&&this.left.delete(r),this.left.set(t,e),this.right.set(e,t),this},Object.defineProperty(t.prototype,"size",{get:function(){return this.left.size},enumerable:!0,configurable:!0}),t.prototype.values=function(){return this.left.values()},t.prototype[Symbol.iterator]=function(){return this.left[Symbol.iterator]()},Object.defineProperty(t.prototype,Symbol.toStringTag,{get:function(){return this.left[Symbol.toStringTag]},enumerable:!0,configurable:!0}),t.prototype.deleteValue=function(t){var e=this.right.get(t);return!!this.left.has(e)&&(this.left.delete(e),this.right.delete(t))},t.prototype.getKey=function(t){return this.right.get(t)},t.prototype.hasValue=function(t){return this.right.has(t)},t}();e.BiMap=r;var o=function(){function t(t){if(this.left=new WeakMap,this.right=new WeakMap,void 0!==t)for(var e=0,n=t;e<n.length;e++){var r=n[e],o=r[0],i=r[1];this.left.set(o,i),this.right.set(i,o)}}return t.prototype.delete=function(t){var e=this.left.get(t);return!!this.right.has(e)&&(this.right.delete(e),this.left.delete(t))},t.prototype.get=function(t){return this.left.get(t)},t.prototype.has=function(t){return this.left.has(t)},t.prototype.set=function(t,e){var n=this.left.get(t),r=this.right.get(e);return this.left.has(t)&&this.right.delete(n),this.right.has(e)&&this.left.delete(r),this.left.set(t,e),this.right.set(e,t),this},Object.defineProperty(t.prototype,Symbol.toStringTag,{get:function(){return this.left[Symbol.toStringTag]},enumerable:!0,configurable:!0}),t.prototype.deleteValue=function(t){var e=this.right.get(t);return!!this.left.has(e)&&(this.left.delete(e),this.right.delete(t))},t.prototype.getKey=function(t){return this.right.get(t)},t.prototype.hasValue=function(t){return this.right.has(t)},t}();e.WeakBiMap=o},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function o(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function i(t){if(f===clearTimeout)return clearTimeout(t);if((f===r||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(t);try{return f(t)}catch(e){try{return f.call(null,t)}catch(e){return f.call(this,t)}}}function a(){m&&h&&(m=!1,h.length?p=h.concat(p):v=-1,p.length&&s())}function s(){if(!m){var t=o(a);m=!0;for(var e=p.length;e;){for(h=p,p=[];++v<e;)h&&h[v].run();v=-1,e=p.length}h=null,m=!1,i(t)}}function u(t,e){this.fun=t,this.array=e}function l(){}var c,f,d=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{f="function"==typeof clearTimeout?clearTimeout:r}catch(t){f=r}}();var h,p=[],m=!1,v=-1;d.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new u(t,e)),1!==p.length||m||o(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=l,d.addListener=l,d.once=l,d.off=l,d.removeListener=l,d.removeAllListeners=l,d.emit=l,d.binding=function(t){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function(t){throw new Error("process.chdir is not supported")},d.umask=function(){return 0}},,function(t,e,n){var r=n(42);"string"==typeof r&&(r=[[t.i,r,""]]);n(6)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){var r=n(43);"string"==typeof r&&(r=[[t.i,r,""]]);n(6)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){var r=n(44);"string"==typeof r&&(r=[[t.i,r,""]]);n(6)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){var r=n(45);"string"==typeof r&&(r=[[t.i,r,""]]);n(6)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){var r=n(46);"string"==typeof r&&(r=[[t.i,r,""]]);n(6)(r,{});r.locals&&(t.exports=r.locals)},function(t,e){},function(t,e,n){"use strict";(function(t){var e=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,n)).next())})},r=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}},o=this,i=n(3),a=n(7),s=n(4),u=n(20);L.Icon.Default.imagePath="http://cdn.leafletjs.com/leaflet/v0.7.7/images",L.Browser.ie&&alert("Does not work in IE (yet)");var l=location.search.match(/city=(\w+)/),c=l?l[1]:"spb";!function(){return e(o,void 0,void 0,function(){var t,e,n,o,l;return r(this,function(r){switch(r.label){case 0:return[4,a.getConfig()];case 1:for(t=r.sent(),e=s.updateDictionary(t.url.dictionary),n=0,o=Object.keys(t.url);n<o.length;n++)l=o[n],t.url[l]=t.url[l].replace(/\{city\}/g,c);return document.title=s.translate((c&&"spb"!==c?i.capitalize(c):"St Petersburg")+" metro plan proposal"),[4,e];case 2:return r.sent(),document.title=s.translate(document.title),new u.default(t),[2]}})})}()}).call(e,n(2))}],[56]);
//# sourceMappingURL=app.js.map