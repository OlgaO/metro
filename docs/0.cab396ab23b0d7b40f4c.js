webpackJsonp([0,1],Array(23).concat([function(t,e,n){"use strict";(function(t){var r=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,n||[])).next())})},o=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}};Object.defineProperty(e,"__esModule",{value:!0});var i=n(1),a=n(75),s=n(3),u=n(51),c=n(10),l=n(21),d=n(7),f=n(22),h=n(2),p=u.tileLayers,m=p.mapbox,v=p.mapnik,g=p.osmFrance,y=p.openMapSurfer,b=p.cartoDBNoLabels,w=p.wikimapia,_=h.sfx.Scale,k=h.math.mean,E=h.algorithm.findCycle,S=[{event:"routefrom",text:"Route from here"},{event:"routeto",text:"Route to here"},{event:"clearroute",text:"Clear route"},{event:"showheatmap",text:"Show heatmap",extra:{disabled:!0}}],x=function(){function e(t){this.mediator=new h.Mediator,this.moving=!1,this.contextMenu=new u.ContextMenu(S),this.whiskers=new WeakMap,this.platformsOnSVG=new WeakMap,this.plate=new u.TextPlate,this.config=t,this.makeMap()}return e.prototype.getMap=function(){return this.map},e.prototype.getNetwork=function(){return this.network},e.prototype.makeMap=function(){return r(this,void 0,void 0,function(){var e,n,r,a,s,l,p,_,k,E,S,x,T,M,L,C=this;return o(this,function(o){switch(o.label){case 0:return o.trys.push([0,4,,5]),e=this.config,n=h.dom.tryGetElement("#scheme").then(function(t){return t.href=e.url.scheme,c.getLineRules()}),r=this.getGraph(),a=new t(function(t){return m.once("load",t)}),s=c.getJSON(e.url.data),e.center=[0,0],l=Object.assign({},e),"1"===i.version[0]&&(l.wheelPxPerZoomLevel=75,l.inertiaMaxSpeed=1500,l.fadeAnimation=!1),this.map=i.map(e.containerId,l).addControl(i.control.scale({imperial:!1})),p=this.map.getPanes().mapPane.style,p.visibility="hidden",u.addLayerSwitcher(this.map,[m,v,g,y,b,w]),addEventListener("keydown",function(t){t.shiftKey&&t.ctrlKey&&82===t.keyCode&&C.getGraph().then(function(t){return C.resetNetwork(t)})}),this.addContextMenu(),[4,r];case 1:return _=o.sent(),this.network=new f.default(_),k=h.geo.getCenter(this.network.platforms.map(function(t){return t.location})),e.center=[k.lat,k.lng],E=i.latLngBounds(this.network.platforms.map(function(t){return t.location})),this.overlay=new u.SvgOverlay(E,i.point(200,200)).addTo(this.map),S=this.overlay.defs,h.svg.filters.appendAll(S),x=S.textContent,0===(x||"").length&&alert((L=["Your browser doesn't seem to have capabilities to display some features of the map. Consider using Chrome or Firefox for the best experience."],L.raw=["Your browser doesn't seem to have capabilities to display some features of the map. Consider using Chrome or Firefox for the best experience."],d.tr(L))),T=this,[4,n];case 2:return T.lineRules=o.sent(),this.resetMapView(),this.map.addLayer(m),this.map.on("overlayupdate",function(t){C.moving=!0,C.redrawNetwork(),C.moving=!1}),this.initNetwork(),this.map.invalidateSize(!1),this.addMapListeners(),(new u.RoutePlanner).addTo(this),(new u.DistanceMeasure).addTo(this.map),s.then(function(t){return new u.FAQ(t.faq).addTo(C)}),[4,a];case 3:return o.sent(),p.visibility="",this.runUnblur(),[3,5];case 4:return M=o.sent(),console.error(M),[3,5];case 5:return[2]}})})},e.prototype.runUnblur=function(){var t=this,e='[style*="transition"]';this.map.on("movestart",function(e){return t.moving=!0}).on("moveend",function(e){return t.moving=!1}),a.default({skipIf:function(){return t.moving||null!==document.querySelector(e)},interval:250})},e.prototype.subscribe=function(t,e){this.mediator.subscribe(t,e),this.map.on(t,this.mediator.publish)},e.prototype.addContextMenu=function(){for(var t=0,e=S;t<e.length;t++){var n=e[t];this.map.on(n.event,this.mediator.publish)}this.contextMenu.addTo(this.map)},e.prototype.addMapListeners=function(){var t=this,e=this,n=e.map,r=e.contextMenu;n.on("distancemeasureinit",function(t){r.insertItem("measuredistance","Measure distance")}),n.on("clearmeasurements",function(t){r.removeItem("clearmeasurements"),r.insertItem("measuredistance","Measure distance")}),n.on("zoomstart",function(e){t.plate.hide()}),this.subscribe("measuredistance",function(t){r.removeItem("measuredistance"),r.insertItem("clearmeasurements","Clear measurements")})},e.prototype.initNetwork=function(){for(var t=this.overlay.origin,e=["paths-outer","paths-inner","transfers-outer","station-circles","transfers-inner","dummy-circles"],n=0,r=e;n<r.length;n++){var o=r[n],i=h.svg.createSVGElement("g");i.id=o,t.appendChild(i)}t.insertBefore(this.plate.element,document.getElementById("dummy-circles")),this.redrawNetwork(),this.addStationListeners()},e.prototype.resetMapView=function(){var t=this.config,e=t.center,n=t.zoom,r={pan:{animate:!1},zoom:{animate:!1}};return e?(this.map.setView(e,n+1,r),void this.map.setView(e,n,r)):void console.error("cannot set map to center")},e.prototype.getGraph=function(){return c.getJSON(this.config.url.graph)},e.prototype.resetNetwork=function(t){this.network=new f.default(t),this.redrawNetwork()},e.prototype.cleanElements=function(){for(var t=this,e=t.overlay,n=t.plate,r=n.element,o=0,i=e.origin.childNodes;o<i.length;o++){var a=i[o];a!==r&&h.dom.removeAllChildren(a)}},e.prototype.redrawNetwork=function(){console.time("pre"),this.cleanElements(),this.updatePlatformsPositionOnOverlay(),console.timeEnd("pre"),console.time("preparation");for(var t=this.config.detailedZoom,e=this.map.getZoom(),n=e>9?e:e>8?9.5:9,r=.5*(n-7),o=.75*r,i=n<t?1.25*r:r,a=n<t?.4*i:.6*i,u=2*i,c=.9*r,d=1.25*a,f={"station-circles":a,"dummy-circles":0,"transfers-outer":c+d/2,"transfers-inner":c-d/2,"paths-outer":r,"paths-inner":r/2},p=i+a/2,m=new Map,v=0,g=Object.keys(f);v<g.length;v++){var y=g[v];m.set(y,document.createDocumentFragment()),h.dom.byId(y).style.strokeWidth=f[y]+"px"}var b=h.tryGetFromMap(this.lineRules,"L");b.strokeWidth=o+"px";var w=Math.max(.5*(e+10),11),_=s.get(this.plate,"element.firstChild.firstChild.style");_&&(_.fontSize=w+"px");var k=new Map;console.timeEnd("preparation"),console.time("circle preparation");for(var S=h.tryGetFromMap(m,"station-circles"),x=h.tryGetFromMap(m,"dummy-circles"),T=0,M=this.network.stations;T<M.length;T++){for(var L=M[T],C=[],I=0,O=L.platforms;I<O.length;I++){var A=O[I],N=h.tryGetFromMap(this.platformsOnSVG,A);if(e>9){var P=h.svg.makeCircle(N,i);e>=t&&this.colorizePlatformCircle(P,A.passingLines());var D=h.svg.makeCircle(N,u);S.appendChild(P),l.default.platformBindings.set(A,P),x.appendChild(D),l.default.dummyBindings.set(A,D)}this.whiskers.set(A,this.makeWhiskers(A))}var R=E(this.network,L);if(R.length>0){for(var B=0,F=L.platforms;B<F.length;B++){var A=F[B];if(R.includes(A)){var j=h.tryGetFromMap(this.platformsOnSVG,A);C.push(j)}}k.set(L,R)}}console.timeEnd("circle preparation"),console.time("transfer preparation");for(var z=h.tryGetFromMap(m,"transfers-outer"),G=h.tryGetFromMap(m,"transfers-inner"),U=0,q=this.network.transfers;U<q.length;U++){var W=q[U],V=W.source,X=W.target,Y=e>=t;if(Y||V.name!==X.name){var Q=k.get(V.station),H=void 0!==Q&&Q.includes(V)&&Q.includes(X)?this.makeTransferArc(W,Q):h.svg.makeTransferLine(h.tryGetFromMap(this.platformsOnSVG,V),h.tryGetFromMap(this.platformsOnSVG,X));l.default.outerEdgeBindings.set(W,H[0]),l.default.innerEdgeBindings.set(W,H[1]),H[0].style.stroke=Y?this.makeGradient(W,p):"#000",z.appendChild(H[0]),G.appendChild(H[1])}}console.timeEnd("transfer preparation"),console.time("span preparation");for(var K=h.tryGetFromMap(m,"paths-outer"),Z=h.tryGetFromMap(m,"paths-inner"),J=0,$=this.network.spans;J<$.length;J++){var tt=$[J],et=this.makePath(tt),nt=et[0],rt=et[1];K.appendChild(nt),rt&&Z.appendChild(rt)}console.timeEnd("span preparation"),console.time("appending"),m.forEach(function(t,e){return h.dom.byId(e).appendChild(t)}),console.timeEnd("appending")},e.prototype.makeGradient=function(t,e){var n=t.source,r=t.target,o=h.tryGetFromMap(this.platformsOnSVG,n),i=h.tryGetFromMap(this.platformsOnSVG,r),a=[this.getPlatformColor(n),this.getPlatformColor(r)],u=e/o.distanceTo(i),c=i.subtract(o),d=l.default.gradientBindings.get(t);return void 0===d?(d=h.svg.gradients.makeLinear(c,a,u),d.id=s.uniqueId("gradient-"),l.default.gradientBindings.set(t,d),this.overlay.defs.appendChild(d)):(h.svg.gradients.setDirection(d,c),h.svg.gradients.setOffset(d,u)),"url(#"+d.id+")"},e.prototype.updatePlatformsPositionOnOverlay=function(t){void 0===t&&(t=this.map.getZoom());var e=this,n=e.config,r=e.network,o=e.overlay,i=e.platformsOnSVG;if(t>=n.detailedZoom)for(var a=0,s=r.stations;a<s.length;a++)for(var u=s[a],c=0,l=u.platforms;c<l.length;c++){var d=l[c],f=o.latLngToOverlayPoint(d.location);i.set(d,f)}else for(var p=function(t){for(var e=new Set,n=o.latLngToOverlayPoint(t.getCenter()),r=t.platforms,a=0,s=r;a<s.length;a++){var u=s[a];e.add(u.name),i.set(u,n)}if(1===e.size)return"continue";if(e.size<1)throw console.error(t),new Error("station has no names");var c=new Map;e.forEach(function(t){var e=r.filter(function(e){return e.name===t}).map(function(t){return t.location}),n=h.geo.getCenter(e);c.set(t,o.latLngToOverlayPoint(n))});for(var l=0,d=r;l<d.length;l++){var u=d[l],f=h.tryGetFromMap(c,u.name);i.set(u,f)}},m=0,v=r.stations;m<v.length;m++){var u=v[m];p(u)}},e.prototype.getPlatformColor=function(t){return h.color.mean(this.linesToColors(t.passingLines()))},e.prototype.linesToColors=function(t){var e=this,n=[];return t.forEach(function(t){var r=h.tryGetFromMap(e.lineRules,"M"===t[0]?t:t[0]).stroke;r&&n.push(r)}),n},e.prototype.colorizePlatformCircle=function(t,e){if(0!==e.size){if(1===e.size){var n=e.values().next().value;return void t.classList.add("M"===n[0]?n:n[0])}t.style.stroke=h.color.mean(this.linesToColors(e))}},e.prototype.makeWhiskers=function(t){var e=this,n=.5,r=h.tryGetFromMap(this.platformsOnSVG,t),o=new Map,i=t.spans;if(0===i.length)return o;if(1===i.length)return o.set(i[0],r);if(2===i.length){if(2===t.passingLines().size)return o.set(i[0],r).set(i[1],r);for(var a=i.map(function(n){return h.tryGetFromMap(e.platformsOnSVG,n.other(t))}),s=a[0],u=a[1],c=h.math.wings(s,r,u,1),l=Math.min(r.distanceTo(s),r.distanceTo(u))*n,d=0;d<2;++d){var f=c[d].multiplyBy(l).add(r);o.set(i[d],f)}return o}for(var p=[[],[]],m=[[],[]],v=new WeakMap,g=0,y=i;g<y.length;g++){var b=y[g],w=b.other(t),_=h.tryGetFromMap(this.platformsOnSVG,w),E=b.source===t?0:1;p[E].push(h.math.normalize(_.subtract(r))),m[E].push(b),v.set(b,r.distanceTo(_))}for(var S=p.map(function(t){return k(t).add(r)}),x=S[0],T=S[1],M=h.math.wings(x,r,T,1),d=0;d<2;++d)for(var L=M[d],C=0,I=m[d];C<I.length;C++){var b=I[C],l=h.tryGetFromMap(v,b)*n,f=L.multiplyBy(l).add(r);o.set(b,f)}return o},e.prototype.makeTransferArc=function(t,e){var n=this.platformsOnSVG,r=t.source,o=t.target,i=h.tryGetFromMap(n,r),a=h.tryGetFromMap(n,o),u=function(t){return h.svg.makeTransferArc(i,a,h.tryGetFromMap(n,t))};if(3===e.length){var c=s.difference(e,[r,o])[0];return u(c)}if(r===e[2]&&o===e[3]||r===e[3]&&o===e[2])return h.svg.makeTransferLine(i,a);for(var l=[],d=0,f=this.network.transfers;d<f.length;d++){var p=f[d];p!==t&&(t.has(p.source)?l.push(p.target):t.has(p.target)&&l.push(p.source))}var m;if(2===l.length){if(l[0]!==l[1])throw Error("FFFFUC");m=l[0]}else{if(3!==l.length)throw new Error("111FUUFF");m=l[0]===l[1]?l[2]:l[0]===l[2]?l[1]:l[0]}return u(m)},e.prototype.makePath=function(t){var e=t.routes,n=t.source,r=t.target,o="",i="",a="";if(e.length>0){var s=e[0].line.match(/([MEL])(\d{0,2})/);if(!s)throw new Error("match failed for "+n.name+"-"+r.name);o=s[0],i=s[1],a=s[2]}else console.error(t,"span has no routes!");var u=[h.tryGetFromMap(this.platformsOnSVG,n),h.tryGetFromMap(h.tryGetFromMap(this.whiskers,n),t),h.tryGetFromMap(h.tryGetFromMap(this.whiskers,r),t),h.tryGetFromMap(this.platformsOnSVG,r)],c=h.svg.makeCubicBezier(u);if("E"===i){c.classList.add("E");var d=c.cloneNode(!0);return l.default.outerEdgeBindings.set(t,c),l.default.innerEdgeBindings.set(t,d),[c,d]}return void 0!==o&&c.classList.add(o),void 0!==i?c.classList.add(i):c.style.stroke="black",l.default.outerEdgeBindings.set(t,c),[c]},e.prototype.addStationListeners=function(){var t=this,e=function(e){t.plate.hide(),_.unscaleAll()},n=h.dom.byId("dummy-circles");n.addEventListener("mouseover",function(e){var n=e.target,r=l.default.dummyBindings.getKey(n),o=r.station;t.highlightStation(o,h.getPlatformNames(r),[r.name])}),n.addEventListener("mouseout",e);var r=function(e){var n=e.target,r=l.default.outerEdgeBindings.getKey(n)||l.default.innerEdgeBindings.getKey(n),o=h.getPlatformNamesZipped([r.source,r.target]);t.highlightStation(r.source.station,o,[r.source.name,r.target.name])},o=h.dom.byId("transfers-outer"),i=h.dom.byId("transfers-inner");o.addEventListener("mouseover",r),i.addEventListener("mouseover",r),o.addEventListener("mouseout",e),i.addEventListener("mouseout",e)},e.prototype.highlightStation=function(t,e,n){for(var r=1.25,o=t.platforms.filter(function(t){return n.includes(t.name)}),i=0,a=o;i<a.length;i++){var u=a[i],c=h.tryGetFromMap(l.default.platformBindings,u);_.scaleCircle(c,r,!0)}if(this.map.getZoom()>=this.config.detailedZoom)for(var d=function(t){var e=o.some(function(e){return t.has(e)})&&n.includes(t.source.name)&&n.includes(t.target.name);e&&_.scaleTransfer(t,r)},f=0,p=this.network.transfers;f<p.length;f++){var m=p[f];d(m)}var v=s.maxBy(o,function(t){return t.location.lat}),g=h.tryGetFromMap(l.default.platformBindings,v);this.plate.show(h.svg.circleOffset(g),e)},e}();e.default=x}).call(e,n(0))},,function(t,e,n){"use strict";(function(t){var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),o=this&&this.__awaiter||function(e,n,r,o){return new(r||(r=t))(function(t,i){function a(t){try{u(o.next(t))}catch(t){i(t)}}function s(t){try{u(o.throw(t))}catch(t){i(t)}}function u(e){e.done?t(e.value):new r(function(t){t(e.value)}).then(a,s)}u((o=o.apply(e,n||[])).next())})},i=this&&this.__generator||function(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(o)throw new TypeError("Generator is already executing.");for(;s;)try{if(o=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return s.label++,{value:n[1],done:!1};case 5:s.label++,i=n[1],n=[0];continue;case 7:n=s.ops.pop(),s.trys.pop();continue;default:if(a=s.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){s=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){s.label=n[1];break}if(6===n[0]&&s.label<a[1]){s.label=a[1],a=n;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(n);break}a[2]&&s.ops.pop(),s.trys.pop();continue}n=e.call(t,s)}catch(t){n=[6,t],i=0}finally{o=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var o,i,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return{next:n(0),throw:n(1),return:n(2)}};Object.defineProperty(e,"__esModule",{value:!0});var a=n(82),s=n(3),u=n(23),c=n(51),l=n(21),d=n(7),f=n(22),h=n(2),p=h.svg.gradients,m=function(t){function e(e){return t.call(this,e)||this}return r(e,t),e.prototype.makeMap=function(){return o(this,void 0,void 0,function(){return i(this,function(e){switch(e.label){case 0:return[4,t.prototype.makeMap.call(this)];case 1:return e.sent(),new c.MapEditor(this.config.detailedZoom).addTo(this),[2]}})})},e.prototype.addMapListeners=function(){var e=this;t.prototype.addMapListeners.call(this);var n=function(t){var e=t;return l.default.outerEdgeBindings.getKey(e)||l.default.innerEdgeBindings.getKey(e)},r=function(t){return l.default.dummyBindings.getKey(t)},o=this,i=o.map,s=o.contextMenu;this.subscribe("platformrename",function(t){var n=r(t.relatedTarget);e.plate.show(h.svg.circleOffset(t.relatedTarget),h.getPlatformNames(n)),c.platformRenameDialog(n)}),this.subscribe("platformmovestart",function(t){e.plate.disabled=!0}),this.subscribe("platformmove",function(t){var e=r(t.relatedTarget);e.location=h.mouseToLatLng(i,t)}),this.subscribe("platformmoveend",function(t){var n=r(t.relatedTarget);e.plate.disabled=!1,e.plate.show(h.svg.circleOffset(t.relatedTarget),h.getPlatformNames(n))}),this.subscribe("platformadd",function(t){var r=t.detail,o=h.mouseToLatLng(i,r),a=new f.Platform((l=["New station"],l.raw=["New station"],d.tr(l)),o,{});if(e.network.platforms.push(a),void 0!==r.relatedTarget){var s=n(r.relatedTarget),u=s.source===a?"target":"source",c=new f.Span(a,s[u],s.routes);s[u]=a,e.network.spans.push(c)}e.overlay.extendBounds(o),e.resetNetwork(JSON.parse(e.network.toJSON()));var l}),this.subscribe("platformdelete",function(t){var n=r(t.relatedTarget);e.network.deletePlatform(n),e.redrawNetwork()}),this.subscribe("spanroutechange",function(t){if(void 0!==t.relatedTarget){var r=n(t.relatedTarget),o=c.askRoutes(e.network,new Set(r.routes));r.routes=Array.from(o),e.resetNetwork(JSON.parse(e.network.toJSON()))}}),this.subscribe("spaninvert",function(t){if(void 0!==t.relatedTarget){var r=n(t.relatedTarget);r.invert(),e.resetNetwork(JSON.parse(e.network.toJSON()))}}),this.subscribe("spanend",function(t){var n=l.default.dummyBindings.getKey(t.detail.source),r=l.default.dummyBindings.getKey(t.detail.target);s.removeItem("spanend");var o=n.passingRoutes(),i=r.passingRoutes(),a=o.size,u=i.size,d=a>0&&0===u?1===a?o:c.askRoutes(e.network,o):u>0&&0===a?1===u?i:c.askRoutes(e.network,i):c.askRoutes(e.network,h.intersection(o,i));e.network.spans.push(new f.Span(n,r,Array.from(d))),e.resetNetwork(JSON.parse(e.network.toJSON()))}),this.subscribe("spandelete",function(t){if(void 0!==t.relatedTarget){var r=n(t.relatedTarget);h.deleteFromArray(e.network.spans,r),e.resetNetwork(JSON.parse(e.network.toJSON()))}}),this.subscribe("transferend",function(t){var n=l.default.dummyBindings.getKey(t.detail.source),r=l.default.dummyBindings.getKey(t.detail.target);console.log(n,r),s.removeItem("transferend"),e.network.transfers.push(new f.Transfer(n,r)),e.resetNetwork(JSON.parse(e.network.toJSON()))}),this.subscribe("transferdelete",function(t){if(void 0!==t.relatedTarget){var n=t.relatedTarget,r=l.default.outerEdgeBindings.getKey(n)||l.default.innerEdgeBindings.getKey(n);h.deleteFromArray(e.network.transfers,r),e.resetNetwork(JSON.parse(e.network.toJSON()))}}),this.subscribe("editmapstart",function(t){i.getZoom()<e.config.detailedZoom&&i.setZoom(e.config.detailedZoom);var n=function(t){var e=t.parentElement;if(!e)return!1;var n=e.id;return"paths-outer"===n||"paths-inner"===n};s.insertItem("platformaddclick","New station",function(t){return!n(t)});var r=function(t){var e=t.parentElement;return!!e&&"dummy-circles"===e.id};s.insertItem("platformrename","Rename station",r),s.insertItem("platformdelete","Delete station",r),s.insertItem("spanstart","Span from here",r),s.insertItem("transferstart","Transfer from here",r),s.insertItem("spanroutechange","Change route",n),s.insertItem("spaninvert","Invert span",n),s.insertItem("platformaddtolineclick","Add station to line",n),s.insertItem("spandelete","Delete span",n),s.insertItem("transferdelete","Delete transfer",function(t){var e=t.parentElement;if(!e)return!1;var n=e.id;return"transfers-outer"===n||"transfers-inner"===n})}),this.subscribe("editmapend",function(t){s.removeItem("platformaddclick"),s.removeItem("platformrename"),s.removeItem("platformdelete"),s.removeItem("spanstart"),s.removeItem("transferstart"),s.removeItem("platformaddtolineclick"),s.removeItem("spanroutechange"),s.removeItem("spandelete"),s.removeItem("transferdelete")}),this.subscribe("mapsave",function(t){a.downloadText("graph.json",e.network.toJSON())})},e.prototype.redrawNetwork=function(){t.prototype.redrawNetwork.call(this),this.addBindings()},e.prototype.addBindings=function(){for(var t=this.network.platforms,e=l.default.platformBindings,n=l.default.dummyBindings,r=0,o=t;r<o.length;r++){var i=o[r];this.platformToModel(i,[h.tryGetFromMap(e,i),h.tryGetFromMap(n,i)])}},e.prototype.platformToModel=function(t,e){var n=this,r=t.location;Object.defineProperty(t,"location",{get:function(){return t._location},set:function(r){t._location=r;for(var o=n.map.getZoom()<n.config.detailedZoom?t.station.getCenter():r,i=n.overlay.latLngToOverlayPoint(o),a=0,s=e;a<s.length;a++){var u=s[a];u.setAttribute("cx",i.x.toString()),u.setAttribute("cy",i.y.toString())}n.whiskers.set(t,n.makeWhiskers(t)),n.platformsOnSVG.set(t,i);for(var c=new Set(t.spans),d=0,f=t.spans;d<f.length;d++){var p=f[d],m=p.other(t);n.whiskers.set(m,n.makeWhiskers(m)),m.spans.forEach(function(t){return c.add(t)})}c.forEach(function(t){var e=[h.tryGetFromMap(n.platformsOnSVG,t.source),h.tryGetFromMap(h.tryGetFromMap(n.whiskers,t.source),t),h.tryGetFromMap(h.tryGetFromMap(n.whiskers,t.target),t),h.tryGetFromMap(n.platformsOnSVG,t.target)],r=l.default.outerEdgeBindings.get(t),o=l.default.innerEdgeBindings.get(t);h.svg.setBezierPath(r,e),o&&h.svg.setBezierPath(o,e)});for(var v=0,g=t.transfers;v<g.length;v++){var y=g[v];y[y.source===t?"source":"target"]=t}}}),t._location=r},e.prototype.transferToModel=function(t,e){var n=this,r=[t.source,t.target],o=e[0].tagName;["source","target"].forEach(function(i,a){Object.defineProperty(t,i,{get:function(){return t["_"+i]},set:function(r){t["_"+i]=r;var u=h.tryGetFromMap(l.default.platformBindings,r),c=parseFloat(getComputedStyle(u).strokeWidth||""),d=+h.dom.attr(u,"r"),f=d/2+c,m=h.tryGetFromMap(n.platformsOnSVG,r);if("line"===o){for(var v=a+1,g=t.other(r),y=0,b=e;y<b.length;y++){var w=b[y];w.setAttribute("x"+v,m.x.toString()),w.setAttribute("y"+v,m.y.toString())}var _=h.tryGetFromMap(l.default.gradientBindings,t),k=h.tryGetFromMap(n.platformsOnSVG,g),E="source"===i?k.subtract(m):m.subtract(k);p.setDirection(_,E);var S=f/m.distanceTo(k);p.setOffset(_,S)}else{if("path"!==o)throw new TypeError("wrong element type for transfer");for(var x=[],T=0,M=n.network.transfers;T<M.length;T++){var L=M[T];if(t.isAdjacent(L)&&(x.push(L),3===x.length))break}for(var C=new Set,I=0,O=x;I<O.length;I++){var A=O[I];C.add(A.source).add(A.target)}var N=Array.from(C).map(function(t){return n.platformsOnSVG.get(t)});C.forEach(function(t){return N.push(n.platformsOnSVG.get(t))});for(var P=x.map(function(t){return l.default.outerEdgeBindings.get(t)}),D=x.map(function(t){return l.default.innerEdgeBindings.get(t)}),R=0;R<3;++R){var B=x[R],F=P[R],j=D[R],z=h.tryGetFromMap(n.platformsOnSVG,B.source),G=h.tryGetFromMap(n.platformsOnSVG,B.target),U=s.difference(N,[z,G])[0];U&&(h.svg.setCircularPath(F,z,G,U),j.setAttribute("d",h.dom.attr(F,"d")));var _=h.tryGetFromMap(l.default.gradientBindings,B);p.setDirection(_,G.subtract(z));var S=f/z.distanceTo(G);p.setOffset(_,S)}}}}),t["_"+i]=r[a]})},e}(u.default);e.default=m}).call(e,n(0))},,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";function r(t,e){var n=d.getSecondLanguage(),r=t.altNames;n?(t.name=e[0],r[n]=e[1],r.en=e[2]):(t.name=e[0],r.en=e[1])}function o(t){var e=t.name,n=t.altNames,o=n.fi,i=n.en,a=i?[e,o,i]:o?[e,o]:[e],s=a.join("|");l.prompt((u=["New name"],u.raw=["New name"],h.tr(u)),s,function(n,o){var i=o.split("|");if(r(t,i),o===s)return l.warning((f=["Name was not changed"],f.raw=["Name was not changed"],h.tr(f)));var u=a.slice(1).join(", "),c=i.slice(1).join(", ");l.success((p=[""," (",") renamed to "," (",")"],p.raw=[""," (",") renamed to "," (",")"],h.tr(p,e,u,i[0],c)));var d=t.station;if(!(d.platforms.length<2)){l.confirm((m=["Rename the entire station?"],m.raw=["Rename the entire station?"],h.tr(m)),function(){for(var t=0,e=d.platforms;t<e.length;t++){var n=e[t];r(n,i)}l.success((a=["The entire station was renamed to ",""],a.raw=["The entire station was renamed to ",""],h.tr(a,o)));var a});var f,p,m}},function(){return l.warning((t=["Name change cancelled"],t.raw=["Name change cancelled"],h.tr(t)));var t});var u}function i(t,e){for(var n=void 0===e?void 0:Array.from(e).map(function(t){return t.line+t.branch}).join("|"),r=new Set,o=prompt("routes",n)||"",i=function(e){var n="M"===e[0]?e.match(/(M\d{0,2})(\w?)/):e.match(/([EL])(.{0,2})/);if(!n)return console.error("incorrect route",e),"continue";var o=n[1],i=n[2],a=t.routes.find(function(t){return t.line===o&&t.branch===i});void 0===a&&(console.log("creating new route"),a={line:o,branch:i},t.routes.push(a)),r.add(a)},a=0,s=o.split("|");a<s.length;a++){var u=s[a];i(u)}return r}function a(t,e){var n=0;addEventListener("keydown",function(r){r.shiftKey&&r.ctrlKey&&76===r.keyCode&&(r.preventDefault(),t.removeLayer(e[n]),++n===e.length&&(n=0),t.addLayer(e[n]),t.invalidateSize(!1))})}function s(t,e){var n=e.filter(function(t){return t.spans[0].routes[0].line.startsWith("M")}).map(function(t){return t.location}),r=function(t){return n.reduce(function(e,n){return e+t.distanceTo(n)},0)},o=c.polyline([],{color:"red"}),i=f.calculateGeoMean(n,r,1,function(t){return o.addLatLng(t)});t.addLayer(o);for(var a=5e3;a<2e4;a+=5e3)c.circle(i,a-250,{weight:1}).addTo(t),c.circle(i,a+250,{weight:1}).addTo(t);var s=(e.filter(function(t){return t.spans[0].routes[0].line.startsWith("E")}).map(function(t){return t.location}),"Glavnyj voxal"),u=e.find(function(t){return t.name===s&&t.spans[0].routes[0].line.startsWith("E")});if(u){var l=u.location;c.circle(l,3e4).addTo(t),c.circle(l,45e3).addTo(t)}}function u(t,e){for(var n=0,r=e;n<r.length;n++){var o=r[n];t.addLayer(o).removeLayer(o)}}Object.defineProperty(e,"__esModule",{value:!0});var c=n(1),l=n(20),d=n(2),f=n(14),h=n(7),p=n(57);e.MapEditor=p.default;var m=n(55);e.FAQ=m.default;var v=n(60);e.TextPlate=v.default;var g=n(58);e.RoutePlanner=g.default;var y=n(53);e.ContextMenu=y.default;var b=n(54);e.DistanceMeasure=b.default;var w=n(59);e.SvgOverlay=w.default;var _=n(52);e.Icons=_;var k=n(62);e.tileLayers=k,e.platformRenameDialog=o,e.askRoutes=i,e.addLayerSwitcher=a,e.drawZones=s,e.cacheIcons=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(56);e.RedCircle=o.default,e.start=r.icon({iconUrl:"https://proxy-antonv.rhcloud.com/?url=http://map.project-osrm.org/images/marker-start-icon-2x.png",iconSize:[20,56],iconAnchor:[10,28]}),e.end=r.icon({iconUrl:"https://proxy-antonv.rhcloud.com/?url=http://map.project-osrm.org/images/marker-end-icon-2x.png",iconSize:[20,56],iconAnchor:[10,28]}),e.red=r.icon({iconUrl:"https://proxy-antonv.rhcloud.com/?url=http://harrywood.co.uk/maps/examples/leaflet/marker-icon-red.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowUrl:"https://proxy-antonv.rhcloud.com/?url=http://cdn.leafletjs.com/leaflet/v0.7.7/images/marker-shadow.png",shadowRetinaUrl:"marker-shadow-@2x.png",shadowSize:[41,41],shadowAnchor:[12,41]})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(3),i=n(2),a=n(7),s=n(77),u=function(){function t(t){this.items=t,this.container=document.createElement("div"),this.container.classList.add(s.contextmenu),this.container.addEventListener("contextmenu",function(t){t.preventDefault(),t.target.click()})}return t.prototype.addTo=function(t){return this.onAdd(t),this},t.prototype.onAdd=function(t){var e=this;if(this.map=t,void 0===t)throw new Error("cannot add map editor to metro map: leaflet map is missing");var n=t.getPanes().mapPane,o=t.getContainer(),i=function(t){return e.handler(t)},a=function(t){return e.hide()};n.addEventListener("contextmenu",i,!1),o.addEventListener("mousedown",a),o.addEventListener("touchstart",a),r.Browser.mobile||t.on("movestart",a),document.body.appendChild(this.container)},t.prototype.onRemove=function(t){},t.prototype.handler=function(t){var e=this;t.preventDefault(),console.log("target",t.target,t.target.parentNode),i.dom.removeAllChildren(this.container);for(var n=0,r=this.items;n<r.length;n++){var o=r[n];if(void 0===o.trigger||o.trigger(t.target)){var s=document.createElement("div");void 0!==o.extra&&o.extra.disabled?s.setAttribute("disabled",""):s.setAttribute("data-event",o.event),s.textContent=a.translate(o.text),this.container.appendChild(s)}else console.log(o.trigger(t.target))}this.container.onclick=function(n){var r=n.target,o=r.getAttribute("data-event");o&&(e.hide(),e.map.fireEvent(o,{clientX:p,clientY:m,relatedTarget:t.target}))};var u=this.container.getBoundingClientRect(),c=u.width,l=u.height,d=document.documentElement,f=d.clientWidth,h=d.clientHeight,p=t.clientX,m=t.clientY,v=p+c>f?f-c:p,g=m+l>h?m-l:m;this.container.style.transform="translate("+v+"px, "+g+"px)",this.show()},t.prototype.insertItem=function(t,e,n,r,o){var i={event:t,text:e,trigger:n,extra:r};void 0===o||o<0?this.items.push(i):this.items.splice(o,0,i)},t.prototype.removeItem=function(t,e){if(void 0===e&&(e=!1),e)return void o.remove(this.items,function(e){return e.event===t});var n=this.items.findIndex(function(e){return e.event===t});n<0||this.items.splice(n,1)},t.prototype.show=function(){this.container.style.visibility=null,r.Browser.mobile&&this.map.dragging.disable()},t.prototype.hide=function(){this.container.style.visibility="hidden",r.Browser.mobile&&this.map.dragging.enable()},t}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(3),i=n(2),a=n(52),s=function(){function t(){var t=this;this.polyline=r.polyline([],{color:"red"}),this.markers=r.featureGroup(),this.dashedLine=r.polyline([],{color:"red",opacity:.5,dashArray:"0,9"}),this.makeMarker=function(e){if(0===e.originalEvent.button){var n=function(e){t.dashedLine.setStyle({opacity:0}),t.updateDistances()},o=r.marker(e.latlng,{draggable:!0}).setIcon(a.RedCircle).bindPopup("").on("mouseover",function(e){return t.hideDashedLine()}).on("mouseout",function(e){return t.showDashedLine()}).on("drag",n).on("click",t.onCircleClick.bind(t));t.markers.addLayer(o),t.updateDistances()}},this.resetDashedLine=function(e){t.dashedLine.getLatLngs()[1]=e.latlng,t.dashedLine.redraw()}}return t.prototype.onAdd=function(t){var e=this;return this.map=t,t.fireEvent("distancemeasureinit"),t.on("measuredistance",function(n){return e.measureDistance(i.mouseToLatLng(t,n))}),t.on("clearmeasurements",function(t){return e.clearMeasurements()}),this},t.prototype.onRemove=function(t){},t.prototype.addTo=function(t){return this.onAdd(t),this},t.prototype.updateDistances=function(){var t=this.polyline.getLatLngs(),e=this.markers.getLayers(),n=e.length;t[0]=e[0].setPopupContent("0").getLatLng();for(var r=1,i=0;r<n;++r){var a=e[r].getLatLng();t[r]=a,i+=e[r-1].getLatLng().distanceTo(a);var s=Math.round(i),u=s<1e3?s+" m":(s<1e4?s/1e3:Math.round(s/10)/100)+" km";e[r].setPopupContent(u)}t.length>n&&(t.length=n),this.dashedLine.getLatLngs()[0]=o.last(t),this.polyline.redraw(),n>1&&o.last(e).openPopup()},t.prototype.showDashedLine=function(){this.dashedLine.setStyle({opacity:.5})},t.prototype.hideDashedLine=function(){this.dashedLine.setStyle({opacity:0})},t.prototype.onCircleClick=function(t){if(0===t.originalEvent.button){if(this.markers.removeLayer(t.target),0===this.markers.getLayers().length)return void this.map.fire("clearmeasurements");this.updateDistances(),
this.map.hasLayer(this.dashedLine)||this.showDashedLine()}},t.prototype.measureDistance=function(t){var e=this;this.dashedLine.addLatLng(t).addLatLng(t),this.map.addLayer(this.polyline.setLatLngs([])).addLayer(this.markers).addLayer(this.dashedLine.setLatLngs([])).on("click",this.makeMarker).on("mousemove",this.resetDashedLine).fire("click",{latlng:t,originalEvent:{button:0}}),i.events.onceEscapePress(function(t){return e.map.fire("clearmeasurements")})},t.prototype.clearMeasurements=function(){this.map.removeLayer(this.polyline).removeLayer(this.markers.clearLayers()).removeLayer(this.dashedLine).off("mousemove",this.resetDashedLine).off("click",this.makeMarker)},t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(69),i=n(13),a=n(78),s=function(){function t(t){var e=this,n=document.createElement("button");n.textContent="FAQ",n.classList.add("leaflet-control"),n.classList.add(a["faq-button"]),n.addEventListener("click",function(t){return e.showFAQ()}),this.button=n,this.card=document.createElement("div"),this.card.classList.add(a["faq-card"]),r.Browser.mobile&&new o(this.card).on("swipeleft swiperight",function(t){return e.hideFAQ()});var i=/\[\[(.+?)\|(.*?)\]\]/g,s='<a href="$1" target="_blank">$2</a>',u=a.question,c=a.answer,l=function(t){return'\n            <div>\n                <span class="'+u+'">'+t.q+'</span>\n                <span class="'+c+'">'+t.a+"</span>\n            </div>\n        "};this.card.innerHTML+=t.map(l).join("").replace(i,s)}return t.prototype.addTo=function(t){this.map=t.getMap();var e=document.querySelector(".leaflet-right.leaflet-top");if(document.body.appendChild(this.card),!e)throw new Error("cannot append to .leaflet-right.leaflet-top");return e.appendChild(this.button),this},t.prototype.showFAQ=function(){var t=this,e=this,n=e.card,o=e.map,a=e.button,s=n.style;s.display="inline",s.transform="scale(0.1)",s.opacity="0",n.getBoundingClientRect(),s.transform=null,s.opacity=null,a.disabled=!0,r.Browser.mobile||(o.getContainer().classList.add("dimmed"),o.once("mousedown",function(e){return t.hideFAQ()}),i.once(window,"keydown").then(function(t){27===t.keyCode&&o.fireEvent("mousedown")}))},t.prototype.hideFAQ=function(){var t=this,e=t.card,n=t.map,o=t.button,a=e.style;e.getBoundingClientRect(),a.transform="scale(0.1)",a.opacity="0",r.Browser.mobile||n.getContainer().classList.remove("dimmed"),i.transitionEnd(e).then(function(t){return a.display=null}),o.disabled=!1},t}();e.default=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(72),o=n(6),i=o.createSVGElement("svg");i.setAttribute("width","100"),i.setAttribute("height","100");var a=o.makeCircle(L.point(50,50),40);a.style.stroke="red",a.style.strokeWidth="20px",a.style.fill="white",i.appendChild(a);var s=5;e.default=L.icon({iconUrl:r.svgToDataUrl(i),iconSize:[2*s,2*s],iconAnchor:[s,s],popupAnchor:[0,-s]})},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(71),o=n(3),i=n(7),a=n(8),s=n(79),u=function(){function t(t){var e=this;this.mapEditorStore=r.createInstance({name:"mapEditor"}),this.backupData=o.throttle(this.mapEditorStore.setItem,1e3);var n=document.createElement("button");n.textContent="Edit Map",n.classList.add("leaflet-control"),n.classList.add(s["edit-map-button"]),n.onclick=function(t){return e.editMapClick()},this.button=n}return Object.defineProperty(t.prototype,"editMode",{get:function(){return this._editMode},set:function(t){var e=this,n=this,r=n.button,o=n.metroMap.mediator;if(t){var s=a.byId("dummy-circles");r.textContent=(u=["Save map"],u.raw=["Save map"],i.tr(u)),r.onclick=function(t){return e.saveMapClick()},s.onmousedown=s.onclick=function(){return!1},o.publish(new Event("editmapstart"))}else r.textContent=(c=["Edit map"],c.raw=["Edit map"],i.tr(c)),r.onclick=function(t){return e.editMapClick()},o.publish(new Event("editmapend"));this._editMode=t;var u,c},enumerable:!0,configurable:!0}),t.prototype.addTo=function(t){var e=t.getMap();if(void 0===e)throw new Error("cannot add map editor to metro map: map is missing");this.metroMap=t;var n=document.querySelector(".leaflet-right.leaflet-top");return n?(n.appendChild(this.button),this.editMode=!1):console.error("cannot append to .leaflet-right.leaflet-top"),this},t.prototype.sendEvent=function(t){this.backupData("map",this.metroMap.getNetwork().toJSON()),this.metroMap.mediator.publish(t)},t.prototype.editMapClick=function(){this.editMode=!0,this.addMapListeners()},t.prototype.saveMapClick=function(){this.sendEvent(new Event("mapsave")),this.editMode=!1},t.prototype.addMapListeners=function(){var t,e,n,r=this,o=this.metroMap.getMap(),i=a.byId("dummy-circles");a.byId("paths-outer"),a.byId("paths-inner");i.addEventListener("mousedown",function(i){if(2!==i.button&&n){var a={source:n,target:i.target};r.sendEvent(new CustomEvent("span"===e?"spanend":"transferend",{detail:a})),n=null,e=void 0}else 0===i.button?(o.dragging.disable(),t=i.target,r.sendEvent(new MouseEvent("platformmovestart",{relatedTarget:i.target}))):1===i.button&&r.sendEvent(new MouseEvent("spanstart",{relatedTarget:i.target}))}),o.on("mousemove",function(e){if(t){var n=e.originalEvent,o=n.clientX,i=n.clientY;r.sendEvent(new MouseEvent("platformmove",{relatedTarget:t,clientX:o,clientY:i}))}}).on("mouseup",function(e){t&&(o.dragging.enable(),r.sendEvent(new MouseEvent("platformmoveend",{relatedTarget:t})),t=null)}),this.metroMap.subscribe("spanstart",function(t){e="span",n=t.relatedTarget}),this.metroMap.subscribe("transferstart",function(t){e="transfer",n=t.relatedTarget}),this.metroMap.subscribe("platformaddclick",function(t){var e=t.clientX,n=t.clientY;r.sendEvent(new CustomEvent("platformadd",{detail:{clientX:e,clientY:n}}))}),this.metroMap.subscribe("platformaddtolineclick",function(t){r.sendEvent(new CustomEvent("platformadd",{detail:t}))})},t}();e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(20),i=n(2),a=n(51),s=i.sfx,u=s.Animation,c=s.visualizeRoute,l=i.algorithm.shortestRoute,d=function(){function t(){var t=this;this.onFromTo=function(e){var n=t.metroMap.getMap(),r=i.mouseToLatLng(n,e),o="routefrom"===e.type?t.fromMarker:t.toMarker;o.setLatLng(r),n.hasLayer(o)||n.addLayer(o);var a=o===t.fromMarker?t.toMarker:t.fromMarker;n.hasLayer(a)&&t.visualizeShortestRoute(!0)},this.clearRoute=function(){var e=t.metroMap.getMap(),n=u.terminateAnimations();e.removeLayer(t.fromMarker).removeLayer(t.toMarker),t.fromMarker.off("drag").off("dragend"),t.toMarker.off("drag").off("dragend"),o.dismissAll(),n.then(i.resetStyle)},this.fromMarker=r.marker([0,0],{draggable:!0,icon:a.Icons.start}),this.toMarker=r.marker([0,0],{draggable:!0,icon:a.Icons.end}),this.addMarkerListeners()}return t.prototype.addTo=function(t){this.metroMap=t;var e=t.mediator,n=t.getMap(),r=n.getCenter();return this.fromMarker.setLatLng(r),this.toMarker.setLatLng(r),a.cacheIcons(n,[this.fromMarker,this.toMarker]),e.subscribe("routefrom",this.onFromTo),e.subscribe("routeto",this.onFromTo),e.subscribe("clearroute",this.clearRoute),n.on("zoomstart",u.terminateAnimations),addEventListener("keydown",function(t){27===t.keyCode&&e.publish(new Event("clearroute"))}),this},t.prototype.addMarkerListeners=function(){for(var t=this,e=0,n=[this.fromMarker,this.toMarker];e<n.length;e++){var r=n[e];r.on("drag",function(e){return t.visualizeShortestRoute(!1)}).on("dragend",function(e){t.visualizeShortestRoute(!0)})}},t.prototype.visualizeShortestRoute=function(t){var e=this.metroMap.getMap();e.hasLayer(this.fromMarker)&&e.hasLayer(this.toMarker)&&this.visualizeRouteBetween(this.fromMarker.getLatLng(),this.toMarker.getLatLng(),t)},t.prototype.visualizeRouteBetween=function(t,e,n){i.resetStyle(),o.dismissAll(),c(l(this.metroMap.getNetwork().platforms,t,e),n)},t}();e.default=d},function(t,e,n){"use strict";var r=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function r(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();Object.defineProperty(e,"__esModule",{value:!0});var o=n(1),i=n(61),a=n(6),s=n(80),u=function(t){function e(e,n){void 0===n&&(n=o.point(100,100));var r=t.call(this,"svg",e,n)||this;r.defs=a.createSVGElement("defs");var i=a.createSVGElement("g");i.setAttribute("transform","translate("+r.margin.x+", "+r.margin.y+")"),r.origin=i;var u=r.overlayContainer;return u.classList.add(s.overlay),u.appendChild(r.defs),u.appendChild(i),r}return r(e,t),e}(i.default);e.default=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),o=n(81),i=function(){function t(){this.element=r.svg.createSVGElement("g"),this._disabled=!1,this._editable=!1;var t=document.createElement("div");t.classList.add(o["plate-box"]);var e=r.svg.createSVGElement("foreignObject");e.setAttribute("x","0"),e.setAttribute("y","0"),e.setAttribute("width","100%"),e.setAttribute("height","100%"),e.appendChild(t);var n=this.element;n.style.display="none",n.appendChild(e)}return Object.defineProperty(t.prototype,"disabled",{get:function(){return this._disabled},set:function(t){t?this.hide():getSelection().removeAllRanges(),this._disabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"editable",{get:function(){return this._editable},set:function(t){for(var e=t?"true":"false",n=this.element.childNodes[1].children[1],r=n.children,o=0,i=r;o<i.length;o++){var a=i[o];a.contentEditable=e}},enumerable:!0,configurable:!0}),t.prototype.show=function(t,e){if(!this.disabled&&"none"===this.element.style.display){var n=this.element.firstChild,r=n.firstChild;r.innerHTML=e.join("<br>"),this.element.setAttribute("transform","translate("+t.x+", "+t.y+")"),this.element.style.display=null;var o=r.getBoundingClientRect(),i=o.width,a=o.height;n.setAttribute("transform","translate("+-i+", "+-a+")")}},t.prototype.hide=function(){this.element.style.display="none"},t}();e.default=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=n(3),i=n(70),a=function(){function t(t,e,n){void 0===n&&(n=r.point(100,100));var o=i.includes(t)&&"svg"!==t?"http://www.w3.org/1999/xhtml":"http://www.w3.org/2000/svg";this.overlayContainer=document.createElementNS(o,t),this.margin=n.round(),this.bounds=e}return t.prototype.addTo=function(t){return this.onAdd(t),this},t.prototype.onAdd=function(t){this.map=t,this.minZoom=t.getMinZoom(),this.maxZoom=t.getMaxZoom(),this.updateOverlayPositioning();var e=t.getPanes(),n=e.objectsPane,o=e.markerPane,i=e.mapPane;("1"===r.version[0]?i:n).insertBefore(this.overlayContainer,o),this.addMapMovementListeners()},t.prototype.onRemove=function(t){var e=t.getPanes(),n=e.objectsPane,o=e.mapPane;("1"===r.version[0]?o:n).removeChild(this.overlayContainer),this.map.clearAllEventListeners()},t.prototype.addMapMovementListeners=function(){var t,e=this,n=this.map,i=this.overlayContainer,a=i.style,s=i.classList;s.add("leaflet-zoom-animated"),n.on("zoomanim",function(n){var r=n,i=r.scale,a=r.target;1!==i&&e.scaleOverlay(i,t||o.get(a,"scrollWheelZoom._lastMousePos")),t=null}).on("zoomend",function(t){a.transform=null,a.transformOrigin=null,e.updateOverlayPositioning(),n.fireEvent("overlayupdate",e)}),n.zoomControl.getContainer().addEventListener("mousedown",function(e){return t=r.point(innerWidth/2,innerHeight/2).round()},!0),n.on("dblclick",function(e){return t=r.DomEvent.getMousePosition(e.originalEvent)})},t.prototype.updateOverlayPositioning=function(){var t=this.bounds.getNorthWest(),e=this.bounds.getSouthEast(),n=this,o=n.map,i=n.margin;this.topLeft=o.project(t).round();var a=r.bounds(o.latLngToLayerPoint(t),o.latLngToLayerPoint(e)),s=this.overlayContainer.style,u=a.min.subtract(i);s.left=u.x+"px",s.top=u.y+"px";var c=a.getSize().add(i).add(i);s.width=c.x+"px",s.height=c.y+"px"},t.prototype.scaleOverlay=function(t,e){var n=this.overlayContainer.getBoundingClientRect(),o=n.left,i=n.top;if(!e){var a=document.documentElement;e=r.point(a.clientWidth/2,a.clientHeight/2)}var s=this.overlayContainer.style;s.transformOrigin=e.x-o+"px "+(e.y-i)+"px",s.transform="scale("+t+")"},t.prototype.extendBounds=function(t){this.bounds.extend(t),this.updateOverlayPositioning()},t.prototype.latLngToOverlayPoint=function(t){return this.map.project(t).round().subtract(this.topLeft)},t}();e.default=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(1),o=r.Browser.retina&&!r.Browser.mobile;e.mapbox=r.tileLayer("https://{s}.tiles.mapbox.com/v3/inker.mlo91c41/{z}/{x}/{y}"+(o?"@2x":"")+".png",{detectRetina:o,attribution:'Map data &copy; <a href="https://openstreetmap.org">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery © <a href="https://mapbox.com">Mapbox</a>'}),e.mapnik=r.tileLayer("http://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.osmFrance=r.tileLayer("http://{s}.tile.openstreetmap.fr/osmfr/{z}/{x}/{y}.png",{attribution:'&copy; Openstreetmap France | &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.openMapSurfer=r.tileLayer("http://korona.geog.uni-heidelberg.de/tiles/roads/x={x}&y={y}&z={z}",{attribution:'Imagery from <a href="http://giscience.uni-hd.de/">GIScience Research Group @ University of Heidelberg</a> &mdash; Map data &copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.hyddaBase=r.tileLayer("https://{s}.tile.openstreetmap.se/hydda/base/{z}/{x}/{y}.png",{attribution:'Tiles courtesy of <a href="http://openstreetmap.se/" target="_blank">OpenStreetMap Sweden</a> &mdash; Map data &copy; <a href="http://server.ts.openstreetmap.org/copyright">OpenStreetMap</a>'}),e.esriGrey=r.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Esri, DeLorme, NAVTEQ"}),e.cartoDB=r.tileLayer("http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'}),e.cartoDBNoLabels=r.tileLayer("http://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png",{attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a> &copy; <a href="http://cartodb.com/attributions">CartoDB</a>'}),e.wikimapia=r.tileLayer("http://i{hash}.wikimapia.org/?x={x}&y={y}&zoom={z}",{hash:function(t){return t.x%4+t.y%4*4}})},function(t,e,n){e=t.exports=n(4)(),e.push([t.i,".ui-ContextMenu-___style__contextmenu___1C6e0{position:fixed;left:0;top:0;z-index:1;background-color:#fff;box-shadow:0 14px 28px rgba(0,0,0,.25),0 10px 10px rgba(0,0,0,.22);font-family:Segoe UI,Tahoma,Ubuntu,Cambay,Roboto,sans-serif;font-size:.7em;margin-left:1px;border-collapse:collapse;-webkit-transform-origin:0 0;transform-origin:0 0;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}@media only screen and (max-device-width:400px) and (-webkit-min-device-pixel-ratio:2){.ui-ContextMenu-___style__contextmenu___1C6e0{font-size:1.2em}}.ui-ContextMenu-___style__contextmenu___1C6e0 div{padding:5px;cursor:default}.ui-ContextMenu-___style__contextmenu___1C6e0 div[disabled]{color:grey}.ui-ContextMenu-___style__contextmenu___1C6e0 div:not([disabled]):hover{background-color:#82b1ff}",""]),e.locals={contextmenu:"ui-ContextMenu-___style__contextmenu___1C6e0"}},function(t,e,n){e=t.exports=n(4)(),e.push([t.i,".ui-FAQ-___style__faq-card___kG3d9{position:absolute;top:5%;bottom:5%;right:5%;left:5%;width:50%;margin:0 auto;padding:1%;display:none;background-color:#fff;border-radius:4px;box-shadow:0 19px 38px rgba(0,0,0,.3),0 15px 12px rgba(0,0,0,.22);font-family:Roboto,Calibri,Helvetica,sans-serif;overflow-y:scroll;-webkit-transition-property:-webkit-transform opacity;transition-property:-webkit-transform opacity;transition-property:transform opacity;transition-property:transform opacity,-webkit-transform opacity;-webkit-transition-duration:.2s;transition-duration:.2s}@media only screen and (max-width:1000px){.ui-FAQ-___style__faq-card___kG3d9{max-width:500px;width:90%}}.ui-FAQ-___style__cross-ball___1Mutj{float:right;height:12mm;width:12mm;line-height:12mm;border-radius:50%;background:#e91e63;color:#fff;font-weight:700;text-align:center;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:pointer}.ui-FAQ-___style__cross-ball___1Mutj:hover{-webkit-filter:grayscale(.1) opacity(.8);filter:grayscale(.1) opacity(.8)}.ui-FAQ-___style__question___3KU2d{font-weight:700;display:block;margin-top:1%}.ui-FAQ-___style__answer___KxEAc{display:block;padding-bottom:1%;border-bottom:1px solid #ccc}",""]),e.locals={"faq-card":"ui-FAQ-___style__faq-card___kG3d9","cross-ball":"ui-FAQ-___style__cross-ball___1Mutj",question:"ui-FAQ-___style__question___3KU2d",answer:"ui-FAQ-___style__answer___KxEAc"}},function(t,e,n){e=t.exports=n(4)(),e.push([t.i,".ui-MapEditor-___style__edit-map-button___250xP[disabled]{cursor:not-allowed}",""]),e.locals={"edit-map-button":"ui-MapEditor-___style__edit-map-button___250xP"}},function(t,e,n){e=t.exports=n(4)(),e.push([t.i,".ui-SvgOverlay-___style__overlay___2kdYy{width:100%;height:100%;position:relative;z-index:1}",""]),e.locals={overlay:"ui-SvgOverlay-___style__overlay___2kdYy"}},function(t,e,n){e=t.exports=n(4)(),e.push([t.i,".ui-TextPlate-___style__plate-box___3BeUy{color:#000;text-anchor:end;text-align:right;font-family:Corbel,Candara,Calibri,Trebuchet MS,Ubuntu,sans-serif;font-weight:700;opacity:1;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;white-space:nowrap;box-shadow:0 3px 6px rgba(0,0,0,.16),0 3px 6px rgba(0,0,0,.23);background-color:#fff;padding:1px 3px;line-height:1.3em;display:inline-block}",""]),e.locals={"plate-box":"ui-TextPlate-___style__plate-box___3BeUy"}},function(t,e){t.exports=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","math","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rb","rp","rt","rtc","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","svg","table","tbody","td","template","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr"]},function(t,e,n){var r;!function(o,i,a,s){"use strict";function u(t,e,n){return setTimeout(h(t,n),e)}function c(t,e,n){return!!Array.isArray(t)&&(l(t,n[e],n),!0)}function l(t,e,n){var r;if(t)if(t.forEach)t.forEach(e,n);else if(t.length!==s)for(r=0;r<t.length;)e.call(n,t[r],r,t),r++;else for(r in t)t.hasOwnProperty(r)&&e.call(n,t[r],r,t)}function d(t,e,n){var r="DEPRECATED METHOD: "+e+"\n"+n+" AT \n";return function(){var e=new Error("get-stack-trace"),n=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",i=o.console&&(o.console.warn||o.console.log);return i&&i.call(o.console,r,n),t.apply(this,arguments)}}function f(t,e,n){var r,o=e.prototype;r=t.prototype=Object.create(o),r.constructor=t,r._super=o,n&&mt(r,n)}function h(t,e){return function(){return t.apply(e,arguments)}}function p(t,e){return typeof t==yt?t.apply(e?e[0]||s:s,e):t}function m(t,e){return t===s?e:t}function v(t,e,n){l(w(e),function(e){t.addEventListener(e,n,!1)})}function g(t,e,n){l(w(e),function(e){t.removeEventListener(e,n,!1)})}function y(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function b(t,e){return t.indexOf(e)>-1}function w(t){return t.trim().split(/\s+/g)}function _(t,e,n){if(t.indexOf&&!n)return t.indexOf(e);for(var r=0;r<t.length;){if(n&&t[r][n]==e||!n&&t[r]===e)return r;r++}return-1}function k(t){return Array.prototype.slice.call(t,0)}function E(t,e,n){for(var r=[],o=[],i=0;i<t.length;){var a=e?t[i][e]:t[i];_(o,a)<0&&r.push(t[i]),o[i]=a,i++}return n&&(r=e?r.sort(function(t,n){return t[e]>n[e]}):r.sort()),r}function S(t,e){for(var n,r,o=e[0].toUpperCase()+e.slice(1),i=0;i<vt.length;){if(n=vt[i],r=n?n+o:e,r in t)return r;i++}return s}function x(){return St++}function T(t){var e=t.ownerDocument||t;return e.defaultView||e.parentWindow||o}function M(t,e){var n=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){p(t.options.enable,[t])&&n.handler(e)},this.init()}function L(t){var e,n=t.options.inputClass;return new(e=n?n:Mt?U:Lt?V:Tt?Y:G)(t,C)}function C(t,e,n){var r=n.pointers.length,o=n.changedPointers.length,i=e&Pt&&r-o===0,a=e&(Rt|Bt)&&r-o===0;n.isFirst=!!i,n.isFinal=!!a,i&&(t.session={}),n.eventType=e,I(t,n),t.emit("hammer.input",n),t.recognize(n),t.session.prevInput=n}function I(t,e){var n=t.session,r=e.pointers,o=r.length;n.firstInput||(n.firstInput=N(e)),o>1&&!n.firstMultiple?n.firstMultiple=N(e):1===o&&(n.firstMultiple=!1);var i=n.firstInput,a=n.firstMultiple,s=a?a.center:i.center,u=e.center=P(r);e.timeStamp=_t(),e.deltaTime=e.timeStamp-i.timeStamp,e.angle=F(s,u),e.distance=B(s,u),O(n,e),e.offsetDirection=R(e.deltaX,e.deltaY);var c=D(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=c.x,e.overallVelocityY=c.y,e.overallVelocity=wt(c.x)>wt(c.y)?c.x:c.y,e.scale=a?z(a.pointers,r):1,e.rotation=a?j(a.pointers,r):0,e.maxPointers=n.prevInput?e.pointers.length>n.prevInput.maxPointers?e.pointers.length:n.prevInput.maxPointers:e.pointers.length,A(n,e);var l=t.element;y(e.srcEvent.target,l)&&(l=e.srcEvent.target),e.target=l}function O(t,e){var n=e.center,r=t.offsetDelta||{},o=t.prevDelta||{},i=t.prevInput||{};e.eventType!==Pt&&i.eventType!==Rt||(o=t.prevDelta={x:i.deltaX||0,y:i.deltaY||0},r=t.offsetDelta={x:n.x,y:n.y}),e.deltaX=o.x+(n.x-r.x),e.deltaY=o.y+(n.y-r.y)}function A(t,e){var n,r,o,i,a=t.lastInterval||e,u=e.timeStamp-a.timeStamp;if(e.eventType!=Bt&&(u>Nt||a.velocity===s)){var c=e.deltaX-a.deltaX,l=e.deltaY-a.deltaY,d=D(u,c,l);r=d.x,o=d.y,n=wt(d.x)>wt(d.y)?d.x:d.y,i=R(c,l),t.lastInterval=e}else n=a.velocity,r=a.velocityX,o=a.velocityY,i=a.direction;e.velocity=n,e.velocityX=r,e.velocityY=o,e.direction=i}function N(t){for(var e=[],n=0;n<t.pointers.length;)e[n]={clientX:bt(t.pointers[n].clientX),clientY:bt(t.pointers[n].clientY)},n++;return{timeStamp:_t(),pointers:e,center:P(e),deltaX:t.deltaX,deltaY:t.deltaY}}function P(t){var e=t.length;if(1===e)return{x:bt(t[0].clientX),y:bt(t[0].clientY)};for(var n=0,r=0,o=0;o<e;)n+=t[o].clientX,r+=t[o].clientY,o++;return{x:bt(n/e),y:bt(r/e)}}function D(t,e,n){return{x:e/t||0,y:n/t||0}}function R(t,e){return t===e?Ft:wt(t)>=wt(e)?t<0?jt:zt:e<0?Gt:Ut}function B(t,e,n){n||(n=Xt);var r=e[n[0]]-t[n[0]],o=e[n[1]]-t[n[1]];return Math.sqrt(r*r+o*o)}function F(t,e,n){n||(n=Xt);var r=e[n[0]]-t[n[0]],o=e[n[1]]-t[n[1]];return 180*Math.atan2(o,r)/Math.PI}function j(t,e){return F(e[1],e[0],Yt)+F(t[1],t[0],Yt)}function z(t,e){return B(e[0],e[1],Yt)/B(t[0],t[1],Yt)}function G(){this.evEl=Ht,this.evWin=Kt,this.pressed=!1,M.apply(this,arguments)}function U(){this.evEl=$t,this.evWin=te,M.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function q(){this.evTarget=ne,this.evWin=re,this.started=!1,M.apply(this,arguments)}function W(t,e){var n=k(t.touches),r=k(t.changedTouches);return e&(Rt|Bt)&&(n=E(n.concat(r),"identifier",!0)),[n,r]}function V(){this.evTarget=ie,this.targetIds={},M.apply(this,arguments)}function X(t,e){var n=k(t.touches),r=this.targetIds;if(e&(Pt|Dt)&&1===n.length)return r[n[0].identifier]=!0,[n,n];var o,i,a=k(t.changedTouches),s=[],u=this.target;if(i=n.filter(function(t){return y(t.target,u)}),e===Pt)for(o=0;o<i.length;)r[i[o].identifier]=!0,o++;for(o=0;o<a.length;)r[a[o].identifier]&&s.push(a[o]),e&(Rt|Bt)&&delete r[a[o].identifier],o++;return s.length?[E(i.concat(s),"identifier",!0),s]:void 0}function Y(){M.apply(this,arguments);var t=h(this.handler,this);this.touch=new V(this.manager,t),this.mouse=new G(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function Q(t,e){t&Pt?(this.primaryTouch=e.changedPointers[0].identifier,H.call(this,e)):t&(Rt|Bt)&&H.call(this,e)}function H(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var n={x:e.clientX,y:e.clientY};this.lastTouches.push(n);var r=this.lastTouches,o=function(){var t=r.indexOf(n);t>-1&&r.splice(t,1)};setTimeout(o,ae)}}function K(t){for(var e=t.srcEvent.clientX,n=t.srcEvent.clientY,r=0;r<this.lastTouches.length;r++){var o=this.lastTouches[r],i=Math.abs(e-o.x),a=Math.abs(n-o.y);if(i<=se&&a<=se)return!0}return!1}function Z(t,e){this.manager=t,this.set(e)}function J(t){if(b(t,he))return he;var e=b(t,pe),n=b(t,me);return e&&n?he:e||n?e?pe:me:b(t,fe)?fe:de}function $(){if(!ce)return!1;var t={},e=o.CSS&&o.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){t[n]=!e||o.CSS.supports("touch-action",n)}),t}function tt(t){this.options=mt({},this.defaults,t||{}),this.id=x(),this.manager=null,this.options.enable=m(this.options.enable,!0),this.state=ge,this.simultaneous={},this.requireFail=[]}function et(t){return t&ke?"cancel":t&we?"end":t&be?"move":t&ye?"start":""}function nt(t){return t==Ut?"down":t==Gt?"up":t==jt?"left":t==zt?"right":""}function rt(t,e){var n=e.manager;return n?n.get(t):t}function ot(){tt.apply(this,arguments)}function it(){ot.apply(this,arguments),this.pX=null,this.pY=null}function at(){ot.apply(this,arguments)}function st(){tt.apply(this,arguments),this._timer=null,this._input=null}function ut(){ot.apply(this,arguments)}function ct(){ot.apply(this,arguments)}function lt(){tt.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function dt(t,e){return e=e||{},e.recognizers=m(e.recognizers,dt.defaults.preset),new ft(t,e)}function ft(t,e){this.options=mt({},dt.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=L(this),this.touchAction=new Z(this,this.options.touchAction),ht(this,!0),l(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function ht(t,e){var n=t.element;if(n.style){var r;l(t.options.cssProps,function(o,i){r=S(n.style,i),e?(t.oldCssProps[r]=n.style[r],n.style[r]=o):n.style[r]=t.oldCssProps[r]||""}),e||(t.oldCssProps={})}}function pt(t,e){var n=i.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}var mt,vt=["","webkit","Moz","MS","ms","o"],gt=i.createElement("div"),yt="function",bt=Math.round,wt=Math.abs,_t=Date.now;mt="function"!=typeof Object.assign?function(t){if(t===s||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(r!==s&&null!==r)for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])}return e}:Object.assign;var kt=d(function(t,e,n){for(var r=Object.keys(e),o=0;o<r.length;)(!n||n&&t[r[o]]===s)&&(t[r[o]]=e[r[o]]),o++;return t},"extend","Use `assign`."),Et=d(function(t,e){return kt(t,e,!0)},"merge","Use `assign`."),St=1,xt=/mobile|tablet|ip(ad|hone|od)|android/i,Tt="ontouchstart"in o,Mt=S(o,"PointerEvent")!==s,Lt=Tt&&xt.test(navigator.userAgent),Ct="touch",It="pen",Ot="mouse",At="kinect",Nt=25,Pt=1,Dt=2,Rt=4,Bt=8,Ft=1,jt=2,zt=4,Gt=8,Ut=16,qt=jt|zt,Wt=Gt|Ut,Vt=qt|Wt,Xt=["x","y"],Yt=["clientX","clientY"];M.prototype={handler:function(){},init:function(){this.evEl&&v(this.element,this.evEl,this.domHandler),this.evTarget&&v(this.target,this.evTarget,this.domHandler),this.evWin&&v(T(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&g(this.element,this.evEl,this.domHandler),this.evTarget&&g(this.target,this.evTarget,this.domHandler),this.evWin&&g(T(this.element),this.evWin,this.domHandler)}};var Qt={mousedown:Pt,mousemove:Dt,mouseup:Rt},Ht="mousedown",Kt="mousemove mouseup";f(G,M,{handler:function(t){var e=Qt[t.type];e&Pt&&0===t.button&&(this.pressed=!0),e&Dt&&1!==t.which&&(e=Rt),this.pressed&&(e&Rt&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:Ot,srcEvent:t}))}});var Zt={pointerdown:Pt,pointermove:Dt,pointerup:Rt,pointercancel:Bt,pointerout:Bt},Jt={2:Ct,3:It,4:Ot,5:At},$t="pointerdown",te="pointermove pointerup pointercancel";o.MSPointerEvent&&!o.PointerEvent&&($t="MSPointerDown",te="MSPointerMove MSPointerUp MSPointerCancel"),f(U,M,{handler:function(t){var e=this.store,n=!1,r=t.type.toLowerCase().replace("ms",""),o=Zt[r],i=Jt[t.pointerType]||t.pointerType,a=i==Ct,s=_(e,t.pointerId,"pointerId");o&Pt&&(0===t.button||a)?s<0&&(e.push(t),s=e.length-1):o&(Rt|Bt)&&(n=!0),s<0||(e[s]=t,this.callback(this.manager,o,{pointers:e,changedPointers:[t],pointerType:i,srcEvent:t}),n&&e.splice(s,1))}});var ee={touchstart:Pt,touchmove:Dt,touchend:Rt,touchcancel:Bt},ne="touchstart",re="touchstart touchmove touchend touchcancel";f(q,M,{handler:function(t){var e=ee[t.type];if(e===Pt&&(this.started=!0),this.started){var n=W.call(this,t,e);e&(Rt|Bt)&&n[0].length-n[1].length===0&&(this.started=!1),this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:Ct,srcEvent:t})}}});var oe={touchstart:Pt,touchmove:Dt,touchend:Rt,touchcancel:Bt},ie="touchstart touchmove touchend touchcancel";f(V,M,{handler:function(t){var e=oe[t.type],n=X.call(this,t,e);n&&this.callback(this.manager,e,{pointers:n[0],changedPointers:n[1],pointerType:Ct,srcEvent:t})}});var ae=2500,se=25;f(Y,M,{handler:function(t,e,n){var r=n.pointerType==Ct,o=n.pointerType==Ot;if(!(o&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(r)Q.call(this,e,n);else if(o&&K.call(this,n))return;this.callback(t,e,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var ue=S(gt.style,"touchAction"),ce=ue!==s,le="compute",de="auto",fe="manipulation",he="none",pe="pan-x",me="pan-y",ve=$();Z.prototype={set:function(t){t==le&&(t=this.compute()),ce&&this.manager.element.style&&ve[t]&&(this.manager.element.style[ue]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return l(this.manager.recognizers,function(e){p(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),J(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,n=t.offsetDirection;if(this.manager.session.prevented)return void e.preventDefault();var r=this.actions,o=b(r,he)&&!ve[he],i=b(r,me)&&!ve[me],a=b(r,pe)&&!ve[pe];if(o){var s=1===t.pointers.length,u=t.distance<2,c=t.deltaTime<250;if(s&&u&&c)return}return a&&i?void 0:o||i&&n&qt||a&&n&Wt?this.preventSrc(e):void 0},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var ge=1,ye=2,be=4,we=8,_e=we,ke=16,Ee=32;tt.prototype={defaults:{},set:function(t){return mt(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(c(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=rt(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return c(t,"dropRecognizeWith",this)?this:(t=rt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(c(t,"requireFailure",this))return this;var e=this.requireFail;return t=rt(t,this),_(e,t)===-1&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(c(t,"dropRequireFailure",this))return this;t=rt(t,this);var e=_(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),
this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){function e(e){n.manager.emit(e,t)}var n=this,r=this.state;r<we&&e(n.options.event+et(r)),e(n.options.event),t.additionalEvent&&e(t.additionalEvent),r>=we&&e(n.options.event+et(r))},tryEmit:function(t){return this.canEmit()?this.emit(t):void(this.state=Ee)},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(Ee|ge)))return!1;t++}return!0},recognize:function(t){var e=mt({},t);return p(this.options.enable,[this,e])?(this.state&(_e|ke|Ee)&&(this.state=ge),this.state=this.process(e),void(this.state&(ye|be|we|ke)&&this.tryEmit(e))):(this.reset(),void(this.state=Ee))},process:function(t){},getTouchAction:function(){},reset:function(){}},f(ot,tt,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,n=t.eventType,r=e&(ye|be),o=this.attrTest(t);return r&&(n&Bt||!o)?e|ke:r||o?n&Rt?e|we:e&ye?e|be:ye:Ee}}),f(it,ot,{defaults:{event:"pan",threshold:10,pointers:1,direction:Vt},getTouchAction:function(){var t=this.options.direction,e=[];return t&qt&&e.push(me),t&Wt&&e.push(pe),e},directionTest:function(t){var e=this.options,n=!0,r=t.distance,o=t.direction,i=t.deltaX,a=t.deltaY;return o&e.direction||(e.direction&qt?(o=0===i?Ft:i<0?jt:zt,n=i!=this.pX,r=Math.abs(t.deltaX)):(o=0===a?Ft:a<0?Gt:Ut,n=a!=this.pY,r=Math.abs(t.deltaY))),t.direction=o,n&&r>e.threshold&&o&e.direction},attrTest:function(t){return ot.prototype.attrTest.call(this,t)&&(this.state&ye||!(this.state&ye)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=nt(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),f(at,ot,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[he]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&ye)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),f(st,tt,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[de]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,o=t.deltaTime>e.time;if(this._input=t,!r||!n||t.eventType&(Rt|Bt)&&!o)this.reset();else if(t.eventType&Pt)this.reset(),this._timer=u(function(){this.state=_e,this.tryEmit()},e.time,this);else if(t.eventType&Rt)return _e;return Ee},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===_e&&(t&&t.eventType&Rt?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=_t(),this.manager.emit(this.options.event,this._input)))}}),f(ut,ot,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[he]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&ye)}}),f(ct,ot,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:qt|Wt,pointers:1},getTouchAction:function(){return it.prototype.getTouchAction.call(this)},attrTest:function(t){var e,n=this.options.direction;return n&(qt|Wt)?e=t.overallVelocity:n&qt?e=t.overallVelocityX:n&Wt&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&n&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&wt(e)>this.options.velocity&&t.eventType&Rt},emit:function(t){var e=nt(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),f(lt,tt,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[fe]},process:function(t){var e=this.options,n=t.pointers.length===e.pointers,r=t.distance<e.threshold,o=t.deltaTime<e.time;if(this.reset(),t.eventType&Pt&&0===this.count)return this.failTimeout();if(r&&o&&n){if(t.eventType!=Rt)return this.failTimeout();var i=!this.pTime||t.timeStamp-this.pTime<e.interval,a=!this.pCenter||B(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,a&&i?this.count+=1:this.count=1,this._input=t;var s=this.count%e.taps;if(0===s)return this.hasRequireFailures()?(this._timer=u(function(){this.state=_e,this.tryEmit()},e.interval,this),ye):_e}return Ee},failTimeout:function(){return this._timer=u(function(){this.state=Ee},this.options.interval,this),Ee},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==_e&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),dt.VERSION="2.0.7",dt.defaults={domEvents:!1,touchAction:le,enable:!0,inputTarget:null,inputClass:null,preset:[[ut,{enable:!1}],[at,{enable:!1},["rotate"]],[ct,{direction:qt}],[it,{direction:qt},["swipe"]],[lt],[lt,{event:"doubletap",taps:2},["tap"]],[st]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var Se=1,xe=2;ft.prototype={set:function(t){return mt(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?xe:Se},recognize:function(t){var e=this.session;if(!e.stopped){this.touchAction.preventDefaults(t);var n,r=this.recognizers,o=e.curRecognizer;(!o||o&&o.state&_e)&&(o=e.curRecognizer=null);for(var i=0;i<r.length;)n=r[i],e.stopped===xe||o&&n!=o&&!n.canRecognizeWith(o)?n.reset():n.recognize(t),!o&&n.state&(ye|be|we)&&(o=e.curRecognizer=n),i++}},get:function(t){if(t instanceof tt)return t;for(var e=this.recognizers,n=0;n<e.length;n++)if(e[n].options.event==t)return e[n];return null},add:function(t){if(c(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(c(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,n=_(e,t);n!==-1&&(e.splice(n,1),this.touchAction.update())}return this},on:function(t,e){if(t!==s&&e!==s){var n=this.handlers;return l(w(t),function(t){n[t]=n[t]||[],n[t].push(e)}),this}},off:function(t,e){if(t!==s){var n=this.handlers;return l(w(t),function(t){e?n[t]&&n[t].splice(_(n[t],e),1):delete n[t]}),this}},emit:function(t,e){this.options.domEvents&&pt(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&ht(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},mt(dt,{INPUT_START:Pt,INPUT_MOVE:Dt,INPUT_END:Rt,INPUT_CANCEL:Bt,STATE_POSSIBLE:ge,STATE_BEGAN:ye,STATE_CHANGED:be,STATE_ENDED:we,STATE_RECOGNIZED:_e,STATE_CANCELLED:ke,STATE_FAILED:Ee,DIRECTION_NONE:Ft,DIRECTION_LEFT:jt,DIRECTION_RIGHT:zt,DIRECTION_UP:Gt,DIRECTION_DOWN:Ut,DIRECTION_HORIZONTAL:qt,DIRECTION_VERTICAL:Wt,DIRECTION_ALL:Vt,Manager:ft,Input:M,TouchAction:Z,TouchInput:V,MouseInput:G,PointerEventInput:U,TouchMouseInput:Y,SingleTouchInput:q,Recognizer:tt,AttrRecognizer:ot,Tap:lt,Pan:it,Swipe:ct,Pinch:at,Rotate:ut,Press:st,on:v,off:g,each:l,merge:Et,extend:kt,assign:mt,inherit:f,bindFn:h,prefixed:S});var Te="undefined"!=typeof o?o:"undefined"!=typeof self?self:{};Te.Hammer=dt,r=function(){return dt}.call(e,n,e,t),!(r!==s&&(t.exports=r))}(window,document,"Hammer")},function(t,e,n){t.exports=n(68)},function(t,e,n){(function(e,n,r){var o,o;!function(e){t.exports=e()}(function(){return function t(e,n,r){function i(s,u){if(!n[s]){if(!e[s]){var c="function"==typeof o&&o;if(!u&&c)return o(s,!0);if(a)return a(s,!0);var l=new Error("Cannot find module '"+s+"'");throw l.code="MODULE_NOT_FOUND",l}var d=n[s]={exports:{}};e[s][0].call(d.exports,function(t){var n=e[s][1][t];return i(n?n:t)},d,d.exports,t,e,n,r)}return n[s].exports}for(var a="function"==typeof o&&o,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,n,r){(function(t){"use strict";function e(){l=!0;for(var t,e,n=d.length;n;){for(e=d,d=[],t=-1;++t<n;)e[t]();n=d.length}l=!1}function r(t){1!==d.push(t)||l||o()}var o,i=t.MutationObserver||t.WebKitMutationObserver;if(i){var a=0,s=new i(e),u=t.document.createTextNode("");s.observe(u,{characterData:!0}),o=function(){u.data=a=++a%2}}else if(t.setImmediate||"undefined"==typeof t.MessageChannel)o="document"in t&&"onreadystatechange"in t.document.createElement("script")?function(){var n=t.document.createElement("script");n.onreadystatechange=function(){e(),n.onreadystatechange=null,n.parentNode.removeChild(n),n=null},t.document.documentElement.appendChild(n)}:function(){setTimeout(e,0)};else{var c=new t.MessageChannel;c.port1.onmessage=e,o=function(){c.port2.postMessage(0)}}var l,d=[];n.exports=r}).call(this,"undefined"!=typeof e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(t,e,n){"use strict";function r(){}function o(t){if("function"!=typeof t)throw new TypeError("resolver must be a function");this.state=y,this.queue=[],this.outcome=void 0,t!==r&&u(this,t)}function i(t,e,n){this.promise=t,"function"==typeof e&&(this.onFulfilled=e,this.callFulfilled=this.otherCallFulfilled),"function"==typeof n&&(this.onRejected=n,this.callRejected=this.otherCallRejected)}function a(t,e,n){p(function(){var r;try{r=e(n)}catch(e){return m.reject(t,e)}r===t?m.reject(t,new TypeError("Cannot resolve promise with itself")):m.resolve(t,r)})}function s(t){var e=t&&t.then;if(t&&"object"==typeof t&&"function"==typeof e)return function(){e.apply(t,arguments)}}function u(t,e){function n(e){i||(i=!0,m.reject(t,e))}function r(e){i||(i=!0,m.resolve(t,e))}function o(){e(r,n)}var i=!1,a=c(o);"error"===a.status&&n(a.value)}function c(t,e){var n={};try{n.value=t(e),n.status="success"}catch(t){n.status="error",n.value=t}return n}function l(t){return t instanceof this?t:m.resolve(new this(r),t)}function d(t){var e=new this(r);return m.reject(e,t)}function f(t){function e(t,e){function r(t){a[e]=t,++s!==o||i||(i=!0,m.resolve(c,a))}n.resolve(t).then(r,function(t){i||(i=!0,m.reject(c,t))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var o=t.length,i=!1;if(!o)return this.resolve([]);for(var a=new Array(o),s=0,u=-1,c=new this(r);++u<o;)e(t[u],u);return c}function h(t){function e(t){n.resolve(t).then(function(t){i||(i=!0,m.resolve(s,t))},function(t){i||(i=!0,m.reject(s,t))})}var n=this;if("[object Array]"!==Object.prototype.toString.call(t))return this.reject(new TypeError("must be an array"));var o=t.length,i=!1;if(!o)return this.resolve([]);for(var a=-1,s=new this(r);++a<o;)e(t[a]);return s}var p=t(1),m={},v=["REJECTED"],g=["FULFILLED"],y=["PENDING"];e.exports=n=o,o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){if("function"!=typeof t&&this.state===g||"function"!=typeof e&&this.state===v)return this;var n=new this.constructor(r);if(this.state!==y){var o=this.state===g?t:e;a(n,o,this.outcome)}else this.queue.push(new i(n,t,e));return n},i.prototype.callFulfilled=function(t){m.resolve(this.promise,t)},i.prototype.otherCallFulfilled=function(t){a(this.promise,this.onFulfilled,t)},i.prototype.callRejected=function(t){m.reject(this.promise,t)},i.prototype.otherCallRejected=function(t){a(this.promise,this.onRejected,t)},m.resolve=function(t,e){var n=c(s,e);if("error"===n.status)return m.reject(t,n.value);var r=n.value;if(r)u(t,r);else{t.state=g,t.outcome=e;for(var o=-1,i=t.queue.length;++o<i;)t.queue[o].callFulfilled(e)}return t},m.reject=function(t,e){t.state=v,t.outcome=e;for(var n=-1,r=t.queue.length;++n<r;)t.queue[n].callRejected(e);return t},n.resolve=l,n.reject=d,n.all=f,n.race=h},{1:1}],3:[function(t,n,r){(function(e){"use strict";"function"!=typeof e.Promise&&(e.Promise=t(2))}).call(this,"undefined"!=typeof e?e:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{2:2}],4:[function(t,e,o){"use strict";function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(){try{if("undefined"!=typeof indexedDB)return indexedDB;if("undefined"!=typeof webkitIndexedDB)return webkitIndexedDB;if("undefined"!=typeof mozIndexedDB)return mozIndexedDB;if("undefined"!=typeof OIndexedDB)return OIndexedDB;if("undefined"!=typeof msIndexedDB)return msIndexedDB}catch(t){}}function s(){try{if(!ut)return!1;var t="undefined"!=typeof openDatabase&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),e="function"==typeof r&&r.toString().indexOf("[native code")!==-1;return(!t||e)&&"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(t){return!1}}function u(){return"function"==typeof openDatabase}function c(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(t){return!1}}function l(t,e){t=t||[],e=e||{};try{return new Blob(t,e)}catch(i){if("TypeError"!==i.name)throw i;for(var n="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,r=new n,o=0;o<t.length;o+=1)r.append(t[o]);return r.getBlob(e.type)}}function d(t,e){e&&t.then(function(t){e(null,t)},function(t){e(t)})}function f(t,e,n){"function"==typeof e&&t.then(e),"function"==typeof n&&t.catch(n)}function h(t){for(var e=t.length,n=new ArrayBuffer(e),r=new Uint8Array(n),o=0;o<e;o++)r[o]=t.charCodeAt(o);return n}function p(t){return new dt(function(e){var n=t.transaction(ft,"readwrite"),r=l([""]);n.objectStore(ft).put(r,"key"),n.onabort=function(t){t.preventDefault(),t.stopPropagation(),e(!1)},n.oncomplete=function(){var t=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);e(n||!t||parseInt(t[1],10)>=43)}}).catch(function(){return!1})}function m(t){return"boolean"==typeof ct?dt.resolve(ct):p(t).then(function(t){return ct=t})}function v(t){var e=lt[t.name],n={};n.promise=new dt(function(t){n.resolve=t}),e.deferredOperations.push(n),e.dbReady?e.dbReady=e.dbReady.then(function(){return n.promise}):e.dbReady=n.promise}function g(t){var e=lt[t.name],n=e.deferredOperations.pop();n&&n.resolve()}function y(t,e){return new dt(function(n,r){if(t.db){if(!e)return n(t.db);v(t),t.db.close()}var o=[t.name];e&&o.push(t.version);var i=ut.open.apply(ut,o);e&&(i.onupgradeneeded=function(e){var n=i.result;try{n.createObjectStore(t.storeName),e.oldVersion<=1&&n.createObjectStore(ft)}catch(n){if("ConstraintError"!==n.name)throw n;console.warn('The database "'+t.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+t.storeName+'" already exists.')}}),i.onerror=function(t){t.preventDefault(),r(i.error)},i.onsuccess=function(){n(i.result),g(t)}})}function b(t){return y(t,!1)}function w(t){return y(t,!0)}function _(t,e){if(!t.db)return!0;var n=!t.db.objectStoreNames.contains(t.storeName),r=t.version<t.db.version,o=t.version>t.db.version;if(r&&(t.version!==e&&console.warn('The database "'+t.name+"\" can't be downgraded from version "+t.db.version+" to version "+t.version+"."),t.version=t.db.version),o||n){if(n){var i=t.db.version+1;i>t.version&&(t.version=i)}return!0}return!1}function k(t){return new dt(function(e,n){var r=new FileReader;r.onerror=n,r.onloadend=function(n){var r=btoa(n.target.result||"");e({__local_forage_encoded_blob:!0,data:r,type:t.type})},r.readAsBinaryString(t)})}function E(t){var e=h(atob(t.data));return l([e],{type:t.type})}function S(t){return t&&t.__local_forage_encoded_blob}function x(t){var e=this,n=e._initReady().then(function(){var t=lt[e._dbInfo.name];if(t&&t.dbReady)return t.dbReady});return f(n,t,t),n}function T(t){function e(){return dt.resolve()}var n=this,r={db:null};if(t)for(var o in t)r[o]=t[o];lt||(lt={});var i=lt[r.name];i||(i={forages:[],db:null,dbReady:null,deferredOperations:[]},lt[r.name]=i),i.forages.push(n),n._initReady||(n._initReady=n.ready,n.ready=x);for(var a=[],s=0;s<i.forages.length;s++){var u=i.forages[s];u!==n&&a.push(u._initReady().catch(e))}var c=i.forages.slice(0);return dt.all(a).then(function(){return r.db=i.db,b(r)}).then(function(t){return r.db=t,_(r,n._defaultConfig.version)?w(r):t}).then(function(t){r.db=i.db=t,n._dbInfo=r;for(var e=0;e<c.length;e++){var o=c[e];o!==n&&(o._dbInfo.db=r.db,o._dbInfo.version=r.version)}})}function M(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new dt(function(e,r){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=i.get(t);a.onsuccess=function(){var t=a.result;void 0===t&&(t=null),S(t)&&(t=E(t)),e(t)},a.onerror=function(){r(a.error)}}).catch(r)});return d(r,e),r}function L(t,e){var n=this,r=new dt(function(e,r){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=i.openCursor(),s=1;a.onsuccess=function(){var n=a.result;if(n){var r=n.value;S(r)&&(r=E(r));var o=t(r,n.key,s++);void 0!==o?e(o):n.continue()}else e()},a.onerror=function(){r(a.error)}}).catch(r)});return d(r,e),r}function C(t,e,n){var r=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=new dt(function(n,o){var i;r.ready().then(function(){return i=r._dbInfo,"[object Blob]"===ht.call(e)?m(i.db).then(function(t){return t?e:k(e)}):e}).then(function(e){var r=i.db.transaction(i.storeName,"readwrite"),a=r.objectStore(i.storeName),s=a.put(e,t);null===e&&(e=void 0),r.oncomplete=function(){void 0===e&&(e=null),n(e)},r.onabort=r.onerror=function(){var t=s.error?s.error:s.transaction.error;o(t)}}).catch(o)});return d(o,n),o}function I(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new dt(function(e,r){n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readwrite"),a=i.objectStore(o.storeName),s=a.delete(t);i.oncomplete=function(){e()},i.onerror=function(){r(s.error)},i.onabort=function(){var t=s.error?s.error:s.transaction.error;r(t)}}).catch(r)});return d(r,e),r}function O(t){var e=this,n=new dt(function(t,n){e.ready().then(function(){var r=e._dbInfo,o=r.db.transaction(r.storeName,"readwrite"),i=o.objectStore(r.storeName),a=i.clear();o.oncomplete=function(){t()},o.onabort=o.onerror=function(){var t=a.error?a.error:a.transaction.error;n(t)}}).catch(n)});return d(n,t),n}function A(t){var e=this,n=new dt(function(t,n){e.ready().then(function(){var r=e._dbInfo,o=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),i=o.count();i.onsuccess=function(){t(i.result)},i.onerror=function(){n(i.error)}}).catch(n)});return d(n,t),n}function N(t,e){var n=this,r=new dt(function(e,r){return t<0?void e(null):void n.ready().then(function(){var o=n._dbInfo,i=o.db.transaction(o.storeName,"readonly").objectStore(o.storeName),a=!1,s=i.openCursor();s.onsuccess=function(){var n=s.result;return n?void(0===t?e(n.key):a?e(n.key):(a=!0,n.advance(t))):void e(null)},s.onerror=function(){r(s.error)}}).catch(r)});return d(r,e),r}function P(t){var e=this,n=new dt(function(t,n){e.ready().then(function(){var r=e._dbInfo,o=r.db.transaction(r.storeName,"readonly").objectStore(r.storeName),i=o.openCursor(),a=[];i.onsuccess=function(){var e=i.result;return e?(a.push(e.key),void e.continue()):void t(a)},i.onerror=function(){n(i.error)}}).catch(n)});return d(n,t),n}function D(t){var e,n,r,o,i,a=.75*t.length,s=t.length,u=0;"="===t[t.length-1]&&(a--,"="===t[t.length-2]&&a--);var c=new ArrayBuffer(a),l=new Uint8Array(c);for(e=0;e<s;e+=4)n=mt.indexOf(t[e]),r=mt.indexOf(t[e+1]),o=mt.indexOf(t[e+2]),i=mt.indexOf(t[e+3]),l[u++]=n<<2|r>>4,l[u++]=(15&r)<<4|o>>2,l[u++]=(3&o)<<6|63&i;return c}function R(t){var e,n=new Uint8Array(t),r="";for(e=0;e<n.length;e+=3)r+=mt[n[e]>>2],r+=mt[(3&n[e])<<4|n[e+1]>>4],r+=mt[(15&n[e+1])<<2|n[e+2]>>6],r+=mt[63&n[e+2]];return n.length%3===2?r=r.substring(0,r.length-1)+"=":n.length%3===1&&(r=r.substring(0,r.length-2)+"=="),r}function B(t,e){var n="";if(t&&(n=At.call(t)),t&&("[object ArrayBuffer]"===n||t.buffer&&"[object ArrayBuffer]"===At.call(t.buffer))){var r,o=yt;t instanceof ArrayBuffer?(r=t,o+=wt):(r=t.buffer,"[object Int8Array]"===n?o+=kt:"[object Uint8Array]"===n?o+=Et:"[object Uint8ClampedArray]"===n?o+=St:"[object Int16Array]"===n?o+=xt:"[object Uint16Array]"===n?o+=Mt:"[object Int32Array]"===n?o+=Tt:"[object Uint32Array]"===n?o+=Lt:"[object Float32Array]"===n?o+=Ct:"[object Float64Array]"===n?o+=It:e(new Error("Failed to get type for BinaryArray"))),e(o+R(r))}else if("[object Blob]"===n){var i=new FileReader;i.onload=function(){var n=vt+t.type+"~"+R(this.result);e(yt+_t+n)},i.readAsArrayBuffer(t)}else try{e(JSON.stringify(t))}catch(n){console.error("Couldn't convert value into a JSON string: ",t),e(null,n)}}function F(t){if(t.substring(0,bt)!==yt)return JSON.parse(t);var e,n=t.substring(Ot),r=t.substring(bt,Ot);if(r===_t&&gt.test(n)){var o=n.match(gt);e=o[1],n=n.substring(o[0].length)}var i=D(n);switch(r){case wt:return i;case _t:return l([i],{type:e});case kt:return new Int8Array(i);case Et:return new Uint8Array(i);case St:return new Uint8ClampedArray(i);case xt:return new Int16Array(i);case Mt:return new Uint16Array(i);case Tt:return new Int32Array(i);case Lt:return new Uint32Array(i);case Ct:return new Float32Array(i);case It:return new Float64Array(i);default:throw new Error("Unkown type: "+r)}}function j(t){var e=this,n={db:null};if(t)for(var r in t)n[r]="string"!=typeof t[r]?t[r].toString():t[r];var o=new dt(function(t,r){try{n.db=openDatabase(n.name,String(n.version),n.description,n.size)}catch(t){return r(t)}n.db.transaction(function(o){o.executeSql("CREATE TABLE IF NOT EXISTS "+n.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){e._dbInfo=n,t()},function(t,e){r(e)})})});return n.serializer=Nt,o}function z(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new dt(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName+" WHERE key = ? LIMIT 1",[t],function(t,n){var r=n.rows.length?n.rows.item(0).value:null;r&&(r=o.serializer.deserialize(r)),e(r)},function(t,e){r(e)})})}).catch(r)});return d(r,e),r}function G(t,e){var n=this,r=new dt(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT * FROM "+o.storeName,[],function(n,r){for(var i=r.rows,a=i.length,s=0;s<a;s++){var u=i.item(s),c=u.value;if(c&&(c=o.serializer.deserialize(c)),c=t(c,u.key,s+1),void 0!==c)return void e(c)}e()},function(t,e){r(e)})})}).catch(r)});return d(r,e),r}function U(t,e,n,r){var o=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var i=new dt(function(i,a){o.ready().then(function(){void 0===e&&(e=null);var s=e,u=o._dbInfo;u.serializer.serialize(e,function(e,c){c?a(c):u.db.transaction(function(n){n.executeSql("INSERT OR REPLACE INTO "+u.storeName+" (key, value) VALUES (?, ?)",[t,e],function(){i(s)},function(t,e){a(e)})},function(e){if(e.code===e.QUOTA_ERR){if(r>0)return void i(U.apply(o,[t,s,n,r-1]));a(e)}})})}).catch(a)});return d(i,n),i}function q(t,e,n){return U.apply(this,[t,e,n,1])}function W(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=new dt(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("DELETE FROM "+o.storeName+" WHERE key = ?",[t],function(){e()},function(t,e){r(e)})})}).catch(r)});return d(r,e),r}function V(t){var e=this,n=new dt(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("DELETE FROM "+r.storeName,[],function(){t()},function(t,e){n(e)})})}).catch(n)});return d(n,t),n}function X(t){var e=this,n=new dt(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("SELECT COUNT(key) as c FROM "+r.storeName,[],function(e,n){var r=n.rows.item(0).c;t(r)},function(t,e){n(e)})})}).catch(n)});return d(n,t),n}function Y(t,e){var n=this,r=new dt(function(e,r){n.ready().then(function(){var o=n._dbInfo;o.db.transaction(function(n){n.executeSql("SELECT key FROM "+o.storeName+" WHERE id = ? LIMIT 1",[t+1],function(t,n){var r=n.rows.length?n.rows.item(0).key:null;e(r)},function(t,e){r(e)})})}).catch(r)});return d(r,e),r}function Q(t){var e=this,n=new dt(function(t,n){e.ready().then(function(){var r=e._dbInfo;r.db.transaction(function(e){e.executeSql("SELECT key FROM "+r.storeName,[],function(e,n){for(var r=[],o=0;o<n.rows.length;o++)r.push(n.rows.item(o).key);t(r)},function(t,e){n(e)})})}).catch(n)});return d(n,t),n}function H(t){var e=this,n={};if(t)for(var r in t)n[r]=t[r];return n.keyPrefix=n.name+"/",n.storeName!==e._defaultConfig.storeName&&(n.keyPrefix+=n.storeName+"/"),e._dbInfo=n,n.serializer=Nt,dt.resolve()}function K(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo.keyPrefix,n=localStorage.length-1;n>=0;n--){var r=localStorage.key(n);0===r.indexOf(t)&&localStorage.removeItem(r)}});return d(n,t),n}function Z(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=n.ready().then(function(){var e=n._dbInfo,r=localStorage.getItem(e.keyPrefix+t);return r&&(r=e.serializer.deserialize(r)),r});return d(r,e),r}function J(t,e){var n=this,r=n.ready().then(function(){for(var e=n._dbInfo,r=e.keyPrefix,o=r.length,i=localStorage.length,a=1,s=0;s<i;s++){var u=localStorage.key(s);if(0===u.indexOf(r)){var c=localStorage.getItem(u);if(c&&(c=e.serializer.deserialize(c)),c=t(c,u.substring(o),a++),void 0!==c)return c}}});return d(r,e),r}function $(t,e){var n=this,r=n.ready().then(function(){var e,r=n._dbInfo;try{e=localStorage.key(t)}catch(t){e=null}return e&&(e=e.substring(r.keyPrefix.length)),e});return d(r,e),r}function tt(t){var e=this,n=e.ready().then(function(){for(var t=e._dbInfo,n=localStorage.length,r=[],o=0;o<n;o++)0===localStorage.key(o).indexOf(t.keyPrefix)&&r.push(localStorage.key(o).substring(t.keyPrefix.length));return r});return d(n,t),n}function et(t){var e=this,n=e.keys().then(function(t){return t.length});return d(n,t),n}function nt(t,e){var n=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var r=n.ready().then(function(){var e=n._dbInfo;localStorage.removeItem(e.keyPrefix+t)});return d(r,e),r}function rt(t,e,n){var r=this;"string"!=typeof t&&(console.warn(t+" used as a key, but it is not a string."),t=String(t));var o=r.ready().then(function(){void 0===e&&(e=null);var n=e;return new dt(function(o,i){var a=r._dbInfo;a.serializer.serialize(e,function(e,r){if(r)i(r);else try{localStorage.setItem(a.keyPrefix+t,e),o(n)}catch(t){"QuotaExceededError"!==t.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==t.name||i(t),i(t)}})})});return d(o,n),o}function ot(t,e){t[e]=function(){var n=arguments;return t.ready().then(function(){return t[e].apply(t,n)})}}function it(){for(var t=1;t<arguments.length;t++){var e=arguments[t];if(e)for(var n in e)e.hasOwnProperty(n)&&(Ut(e[n])?arguments[0][n]=e[n].slice():arguments[0][n]=e[n])}return arguments[0]}function at(t){for(var e in Bt)if(Bt.hasOwnProperty(e)&&Bt[e]===t)return!0;return!1}var st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ut=a();"undefined"==typeof n&&t(3);var ct,lt,dt=n,ft="local-forage-detect-blob-support",ht=Object.prototype.toString,pt={_driver:"asyncStorage",_initStorage:T,iterate:L,getItem:M,setItem:C,removeItem:I,clear:O,length:A,key:N,keys:P},mt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",vt="~~local_forage_type~",gt=/^~~local_forage_type~([^~]+)~/,yt="__lfsc__:",bt=yt.length,wt="arbf",_t="blob",kt="si08",Et="ui08",St="uic8",xt="si16",Tt="si32",Mt="ur16",Lt="ui32",Ct="fl32",It="fl64",Ot=bt+wt.length,At=Object.prototype.toString,Nt={serialize:B,deserialize:F,stringToBuffer:D,bufferToString:R},Pt={_driver:"webSQLStorage",_initStorage:j,iterate:G,getItem:z,setItem:q,removeItem:W,clear:V,length:X,key:Y,keys:Q},Dt={_driver:"localStorageWrapper",_initStorage:H,iterate:J,getItem:Z,setItem:rt,removeItem:nt,clear:K,length:et,key:$,keys:tt},Rt={},Bt={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},Ft=[Bt.INDEXEDDB,Bt.WEBSQL,Bt.LOCALSTORAGE],jt=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],zt={description:"",driver:Ft.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},Gt={};Gt[Bt.INDEXEDDB]=s(),Gt[Bt.WEBSQL]=u(),Gt[Bt.LOCALSTORAGE]=c();var Ut=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},qt=function(){function t(e){i(this,t),this.INDEXEDDB=Bt.INDEXEDDB,this.LOCALSTORAGE=Bt.LOCALSTORAGE,this.WEBSQL=Bt.WEBSQL,this._defaultConfig=it({},zt),this._config=it({},this._defaultConfig,e),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return t.prototype.config=function(t){if("object"===("undefined"==typeof t?"undefined":st(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var e in t){if("storeName"===e&&(t[e]=t[e].replace(/\W/g,"_")),"version"===e&&"number"!=typeof t[e])return new Error("Database version must be a number.");this._config[e]=t[e]}return!("driver"in t&&t.driver)||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},t.prototype.defineDriver=function(t,e,n){var r=new dt(function(e,n){try{var r=t._driver,o=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),i=new Error("Custom driver name already in use: "+t._driver);if(!t._driver)return void n(o);if(at(t._driver))return void n(i);for(var a=jt.concat("_initStorage"),s=0;s<a.length;s++){var u=a[s];if(!u||!t[u]||"function"!=typeof t[u])return void n(o)}var c=dt.resolve(!0);"_support"in t&&(c=t._support&&"function"==typeof t._support?t._support():dt.resolve(!!t._support)),c.then(function(n){Gt[r]=n,Rt[r]=t,e()},n)}catch(t){n(t)}});return f(r,e,n),r},t.prototype.driver=function(){return this._driver||null},t.prototype.getDriver=function(t,e,n){var r=this,o=dt.resolve().then(function(){if(!at(t)){if(Rt[t])return Rt[t];throw new Error("Driver not found.")}switch(t){case r.INDEXEDDB:return pt;case r.LOCALSTORAGE:return Dt;case r.WEBSQL:return Pt}});return f(o,e,n),o},t.prototype.getSerializer=function(t){var e=dt.resolve(Nt);return f(e,t),e},t.prototype.ready=function(t){var e=this,n=e._driverSet.then(function(){return null===e._ready&&(e._ready=e._initDriver()),e._ready});return f(n,t,t),n},t.prototype.setDriver=function(t,e,n){function r(){a._config.driver=a.driver()}function o(t){return a._extend(t),r(),a._ready=a._initStorage(a._config),a._ready}function i(t){return function(){function e(){for(;n<t.length;){var i=t[n];return n++,a._dbInfo=null,a._ready=null,a.getDriver(i).then(o).catch(e)}r();var s=new Error("No available storage method found.");return a._driverSet=dt.reject(s),a._driverSet}var n=0;return e()}}var a=this;Ut(t)||(t=[t]);var s=this._getSupportedDrivers(t),u=null!==this._driverSet?this._driverSet.catch(function(){return dt.resolve()}):dt.resolve();return this._driverSet=u.then(function(){var t=s[0];return a._dbInfo=null,a._ready=null,a.getDriver(t).then(function(t){a._driver=t._driver,r(),a._wrapLibraryMethodsWithReady(),a._initDriver=i(s)})}).catch(function(){r();var t=new Error("No available storage method found.");return a._driverSet=dt.reject(t),a._driverSet}),f(this._driverSet,e,n),this._driverSet},t.prototype.supports=function(t){return!!Gt[t];
},t.prototype._extend=function(t){it(this,t)},t.prototype._getSupportedDrivers=function(t){for(var e=[],n=0,r=t.length;n<r;n++){var o=t[n];this.supports(o)&&e.push(o)}return e},t.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0;t<jt.length;t++)ot(this,jt[t])},t.prototype.createInstance=function(e){return new t(e)},t}(),Wt=new qt;e.exports=Wt},{3:3}]},{},[4])(4)})}).call(e,n(9),n(0),n(24))},function(t,e,n){"use strict";t.exports=n(74)},function(t,e,n){"use strict";function r(){for(var t="",e=0,n=document.styleSheets;e<n.length;e++){var r=n[e];console.log(r.cssText);var o=r.cssRules;if(o)for(var i=0,a=o;i<a.length;i++){var s=a[i];t+=s.cssText}else console.log(r)}return console.log("css text ready"),t}e.getStyleRulesAsText=r},function(t,e,n){"use strict";(function(t){function r(t,e){var n=document.createElement("a");n.href=e,n.download=t,n.click()}function o(t,e,n){i(e,n).then(function(e){return r(t,e)})}function i(t,e){return a(t).then(function(t){return t.toDataURL("image/"+e)})}function a(e){return new t(function(t,n){var r=u(e,!0);r.onload=function(e){var o=document.createElement("canvas");o.width=r.width,o.height=r.height;var i=o.getContext("2d");return i?(i.drawImage(r,0,0),void t(o)):n(new Error("2d context does not exist on canvas"))}})}function s(t){var e=i(t,"png"),n=document.createElement("img");return n.width=parseInt(t.getAttribute("width")||"")||parseInt(t.style.width||""),n.height=parseInt(t.getAttribute("height")||"")||parseInt(t.style.height||""),e.then(function(t){return n.src=t,n})}function u(t,e){void 0===e&&(e=!1),e&&(t=l(t));var n=document.createElement("img");return n.width=parseInt(t.getAttribute("width")||"")||parseInt(t.style.width||""),n.height=parseInt(t.getAttribute("height")||"")||parseInt(t.style.height||""),n.src=c(t),n}function c(t){return"data:image/svg+xml;base64,"+btoa((new XMLSerializer).serializeToString(t))}function l(t){for(var e=t.cloneNode(!0),n=e.querySelectorAll("[id^=dummy]"),r=0,o=n;r<o.length;r++){var i=o[r],a=i.parentNode;a&&a.removeChild(i)}e.style.left=e.style.top="";var s=e.querySelector("#station-plate");if(s){var u=s.parentNode;u&&u.removeChild(s)}var c=document.createElement("style");c.textContent=d.getStyleRulesAsText();var l=e.querySelector("defs");return l&&l.insertBefore(c,l.firstChild),e}var d=n(73);e.downloadSvgAsPicture=o,e.svgToPictureDataUrl=i,e.svgToCanvas=a,e.svgToPicture=s,e.svgToImg=u,e.svgToDataUrl=c}).call(e,n(0))},function(t,e,n){"use strict";t.exports=n(76)},function(t,e,n){"use strict";function r(t){for(var e=0,n=t;e<n.length;e++){var r=n[e].style;r&&r.transform&&(r.transform=r.transform.replace(a,s))}}var o=this&&this.__assign||Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o])}return t};Object.defineProperty(e,"__esModule",{value:!0});var i={interval:1e3,element:document.body,skipIf:void 0,log:!1,allBrowsers:!1},a=/(translate|scale)3d\s*\((.+?,\s*.+?),\s*.+?\s*\)/gi,s="$1($2)",u='[style*="translate3d"], [style*="scale3d"]',c=!1;e.default=function(t){if(void 0===t&&(t={}),c)throw new Error("unblur can be called only once!");c=!0;var e=o({},i,t),n=e.interval,a=e.element,s=e.skipIf,l=e.log,d=e.allBrowsers,f=navigator.userAgent,h=f.includes("AppleWebKit")&&!f.includes("Mobile");if(!d&&!h)return void(l&&console.log("not desktop webkit, do nothing"));l&&console.log("running unblur");var p=0===n?requestAnimationFrame:function(t){return setTimeout(t,n)};!function t(){if(s&&s())l&&console.log("cancelled");else{var e=a.querySelectorAll(u);e.length>0&&(l&&console.log("fixing translate3d:",e.length,"elements"),r(e))}p(t)}()}},function(t,e,n){var r=n(63);"string"==typeof r&&(r=[[t.i,r,""]]);n(5)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){var r=n(64);"string"==typeof r&&(r=[[t.i,r,""]]);n(5)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){var r=n(65);"string"==typeof r&&(r=[[t.i,r,""]]);n(5)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){var r=n(66);"string"==typeof r&&(r=[[t.i,r,""]]);n(5)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){var r=n(67);"string"==typeof r&&(r=[[t.i,r,""]]);n(5)(r,{});r.locals&&(t.exports=r.locals)},function(t,e,n){"use strict";t.exports=n(83)},function(t,e,n){"use strict";function r(t,e){var n=document.createElement("a");n.href=e,n.download=t,n.click()}function o(t,e){var n=URL.createObjectURL(e);r(t,n),URL.revokeObjectURL(n)}function i(t,e){o(t,new Blob([e],{type:"octet/stream"}))}e.downloadBlob=o,e.downloadText=i}]));
//# sourceMappingURL=0.cab396ab23b0d7b40f4c.js.map